<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Advanced R</title>
  <meta name="description" content="The book is designed primarily for R users who want to improve their programming skills and understanding of the language. It should also be useful for programmers coming to R from other languages, as it explains some of R’s quirks and shows how some parts that seem horrible do have a positive side.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Advanced R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://adv-r.hadley.nz/" />
  <meta property="og:image" content="https://adv-r.hadley.nz/cover.png" />
  <meta property="og:description" content="The book is designed primarily for R users who want to improve their programming skills and understanding of the language. It should also be useful for programmers coming to R from other languages, as it explains some of R’s quirks and shows how some parts that seem horrible do have a positive side." />
  <meta name="github-repo" content="hadley/adv-r" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Advanced R" />
  <meta name="twitter:site" content="@hadley" />
  <meta name="twitter:description" content="The book is designed primarily for R users who want to improve their programming skills and understanding of the language. It should also be useful for programmers coming to R from other languages, as it explains some of R’s quirks and shows how some parts that seem horrible do have a positive side." />
  <meta name="twitter:image" content="https://adv-r.hadley.nz/cover.png" />

<meta name="author" content="Hadley Wickham">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="r6.html">
<link rel="next" href="oo-tradeoffs.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="adv-r.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">Advanced R</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#other-books"><i class="fa fa-check"></i>Other books</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#why-r"><i class="fa fa-check"></i><b>1.1</b> Why R?</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#who-should-read"><i class="fa fa-check"></i><b>1.2</b> Who should read this book</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#what-you-will-get"><i class="fa fa-check"></i><b>1.3</b> What you will get out of this book</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#what-you-will-not-learn"><i class="fa fa-check"></i><b>1.4</b> What you will not learn</a></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#meta-techniques"><i class="fa fa-check"></i><b>1.5</b> Meta-techniques</a></li>
<li class="chapter" data-level="1.6" data-path="introduction.html"><a href="introduction.html#recommended-reading"><i class="fa fa-check"></i><b>1.6</b> Recommended reading</a></li>
<li class="chapter" data-level="1.7" data-path="introduction.html"><a href="introduction.html#getting-help"><i class="fa fa-check"></i><b>1.7</b> Getting help</a></li>
<li class="chapter" data-level="1.8" data-path="introduction.html"><a href="introduction.html#intro-ack"><i class="fa fa-check"></i><b>1.8</b> Acknowledgments</a></li>
<li class="chapter" data-level="1.9" data-path="introduction.html"><a href="introduction.html#conventions"><i class="fa fa-check"></i><b>1.9</b> Conventions</a></li>
<li class="chapter" data-level="1.10" data-path="introduction.html"><a href="introduction.html#colophon"><i class="fa fa-check"></i><b>1.10</b> Colophon</a></li>
</ul></li>
<li class="part"><span><b>I Foundations</b></span></li>
<li class="chapter" data-level="" data-path="foundations-intro.html"><a href="foundations-intro.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="2" data-path="names-values.html"><a href="names-values.html"><i class="fa fa-check"></i><b>2</b> Names and values</a><ul>
<li class="chapter" data-level="2.1" data-path="names-values.html"><a href="names-values.html#introduction-1"><i class="fa fa-check"></i><b>2.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#quiz"><i class="fa fa-check"></i>Quiz</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#outline"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#sources"><i class="fa fa-check"></i>Sources</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="names-values.html"><a href="names-values.html#binding-basics"><i class="fa fa-check"></i><b>2.2</b> Binding basics</a><ul>
<li class="chapter" data-level="2.2.1" data-path="names-values.html"><a href="names-values.html#non-syntactic"><i class="fa fa-check"></i><b>2.2.1</b> Non-syntactic names</a></li>
<li class="chapter" data-level="2.2.2" data-path="names-values.html"><a href="names-values.html#exercises"><i class="fa fa-check"></i><b>2.2.2</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="names-values.html"><a href="names-values.html#copy-on-modify"><i class="fa fa-check"></i><b>2.3</b> Copy-on-modify</a><ul>
<li class="chapter" data-level="2.3.1" data-path="names-values.html"><a href="names-values.html#tracemem"><i class="fa fa-check"></i><b>2.3.1</b> <code>tracemem()</code></a></li>
<li class="chapter" data-level="2.3.2" data-path="names-values.html"><a href="names-values.html#function-calls"><i class="fa fa-check"></i><b>2.3.2</b> Function calls</a></li>
<li class="chapter" data-level="2.3.3" data-path="names-values.html"><a href="names-values.html#list-references"><i class="fa fa-check"></i><b>2.3.3</b> Lists</a></li>
<li class="chapter" data-level="2.3.4" data-path="names-values.html"><a href="names-values.html#df-modify"><i class="fa fa-check"></i><b>2.3.4</b> Data frames</a></li>
<li class="chapter" data-level="2.3.5" data-path="names-values.html"><a href="names-values.html#character-vectors"><i class="fa fa-check"></i><b>2.3.5</b> Character vectors</a></li>
<li class="chapter" data-level="2.3.6" data-path="names-values.html"><a href="names-values.html#exercises-1"><i class="fa fa-check"></i><b>2.3.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="names-values.html"><a href="names-values.html#object-size"><i class="fa fa-check"></i><b>2.4</b> Object size</a><ul>
<li class="chapter" data-level="2.4.1" data-path="names-values.html"><a href="names-values.html#exercises-2"><i class="fa fa-check"></i><b>2.4.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="names-values.html"><a href="names-values.html#modify-in-place"><i class="fa fa-check"></i><b>2.5</b> Modify-in-place</a><ul>
<li class="chapter" data-level="2.5.1" data-path="names-values.html"><a href="names-values.html#single-binding"><i class="fa fa-check"></i><b>2.5.1</b> Objects with a single binding</a></li>
<li class="chapter" data-level="2.5.2" data-path="names-values.html"><a href="names-values.html#env-modify"><i class="fa fa-check"></i><b>2.5.2</b> Environments</a></li>
<li class="chapter" data-level="2.5.3" data-path="names-values.html"><a href="names-values.html#exercises-3"><i class="fa fa-check"></i><b>2.5.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="names-values.html"><a href="names-values.html#gc"><i class="fa fa-check"></i><b>2.6</b> Unbinding and the garbage collector</a></li>
<li class="chapter" data-level="2.7" data-path="names-values.html"><a href="names-values.html#names-values-answers"><i class="fa fa-check"></i><b>2.7</b> Answers</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="vectors-chap.html"><a href="vectors-chap.html"><i class="fa fa-check"></i><b>3</b> Vectors</a><ul>
<li class="chapter" data-level="3.1" data-path="vectors-chap.html"><a href="vectors-chap.html#introduction-2"><i class="fa fa-check"></i><b>3.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="vectors-chap.html"><a href="vectors-chap.html#quiz-1"><i class="fa fa-check"></i>Quiz</a></li>
<li class="chapter" data-level="" data-path="vectors-chap.html"><a href="vectors-chap.html#outline-1"><i class="fa fa-check"></i>Outline</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="vectors-chap.html"><a href="vectors-chap.html#atomic-vectors"><i class="fa fa-check"></i><b>3.2</b> Atomic vectors</a><ul>
<li class="chapter" data-level="3.2.1" data-path="vectors-chap.html"><a href="vectors-chap.html#scalars"><i class="fa fa-check"></i><b>3.2.1</b> Scalars</a></li>
<li class="chapter" data-level="3.2.2" data-path="vectors-chap.html"><a href="vectors-chap.html#atomic-constructing"><i class="fa fa-check"></i><b>3.2.2</b> Making longer vectors with <code>c()</code></a></li>
<li class="chapter" data-level="3.2.3" data-path="vectors-chap.html"><a href="vectors-chap.html#testing-and-coercing"><i class="fa fa-check"></i><b>3.2.3</b> Testing and coercing</a></li>
<li class="chapter" data-level="3.2.4" data-path="vectors-chap.html"><a href="vectors-chap.html#exercises-4"><i class="fa fa-check"></i><b>3.2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="vectors-chap.html"><a href="vectors-chap.html#attributes"><i class="fa fa-check"></i><b>3.3</b> Attributes</a><ul>
<li class="chapter" data-level="3.3.1" data-path="vectors-chap.html"><a href="vectors-chap.html#getting-and-setting"><i class="fa fa-check"></i><b>3.3.1</b> Getting and setting</a></li>
<li class="chapter" data-level="3.3.2" data-path="vectors-chap.html"><a href="vectors-chap.html#attr-names"><i class="fa fa-check"></i><b>3.3.2</b> Names</a></li>
<li class="chapter" data-level="3.3.3" data-path="vectors-chap.html"><a href="vectors-chap.html#attr-dims"><i class="fa fa-check"></i><b>3.3.3</b> Dimensions</a></li>
<li class="chapter" data-level="3.3.4" data-path="vectors-chap.html"><a href="vectors-chap.html#exercises-5"><i class="fa fa-check"></i><b>3.3.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="vectors-chap.html"><a href="vectors-chap.html#s3-atomic-vectors"><i class="fa fa-check"></i><b>3.4</b> S3 atomic vectors</a><ul>
<li class="chapter" data-level="3.4.1" data-path="vectors-chap.html"><a href="vectors-chap.html#factors"><i class="fa fa-check"></i><b>3.4.1</b> Factors</a></li>
<li class="chapter" data-level="3.4.2" data-path="vectors-chap.html"><a href="vectors-chap.html#dates"><i class="fa fa-check"></i><b>3.4.2</b> Dates</a></li>
<li class="chapter" data-level="3.4.3" data-path="vectors-chap.html"><a href="vectors-chap.html#date-times"><i class="fa fa-check"></i><b>3.4.3</b> Date-times</a></li>
<li class="chapter" data-level="3.4.4" data-path="vectors-chap.html"><a href="vectors-chap.html#exercises-6"><i class="fa fa-check"></i><b>3.4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="vectors-chap.html"><a href="vectors-chap.html#lists"><i class="fa fa-check"></i><b>3.5</b> Lists</a><ul>
<li class="chapter" data-level="3.5.1" data-path="vectors-chap.html"><a href="vectors-chap.html#list-creating"><i class="fa fa-check"></i><b>3.5.1</b> Creating</a></li>
<li class="chapter" data-level="3.5.2" data-path="vectors-chap.html"><a href="vectors-chap.html#list-types"><i class="fa fa-check"></i><b>3.5.2</b> Testing and coercing</a></li>
<li class="chapter" data-level="3.5.3" data-path="vectors-chap.html"><a href="vectors-chap.html#list-array"><i class="fa fa-check"></i><b>3.5.3</b> Matrices and arrays</a></li>
<li class="chapter" data-level="3.5.4" data-path="vectors-chap.html"><a href="vectors-chap.html#exercises-7"><i class="fa fa-check"></i><b>3.5.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="vectors-chap.html"><a href="vectors-chap.html#tibble"><i class="fa fa-check"></i><b>3.6</b> Data frames and tibbles</a><ul>
<li class="chapter" data-level="3.6.1" data-path="vectors-chap.html"><a href="vectors-chap.html#df-create"><i class="fa fa-check"></i><b>3.6.1</b> Creating</a></li>
<li class="chapter" data-level="3.6.2" data-path="vectors-chap.html"><a href="vectors-chap.html#rownames"><i class="fa fa-check"></i><b>3.6.2</b> Row names</a></li>
<li class="chapter" data-level="3.6.3" data-path="vectors-chap.html"><a href="vectors-chap.html#printing"><i class="fa fa-check"></i><b>3.6.3</b> Printing</a></li>
<li class="chapter" data-level="3.6.4" data-path="vectors-chap.html"><a href="vectors-chap.html#safe-subsetting"><i class="fa fa-check"></i><b>3.6.4</b> Subsetting</a></li>
<li class="chapter" data-level="3.6.5" data-path="vectors-chap.html"><a href="vectors-chap.html#df-test-coerce"><i class="fa fa-check"></i><b>3.6.5</b> Testing and coercing</a></li>
<li class="chapter" data-level="3.6.6" data-path="vectors-chap.html"><a href="vectors-chap.html#list-columns"><i class="fa fa-check"></i><b>3.6.6</b> List columns</a></li>
<li class="chapter" data-level="3.6.7" data-path="vectors-chap.html"><a href="vectors-chap.html#matrix-and-data-frame-columns"><i class="fa fa-check"></i><b>3.6.7</b> Matrix and data frame columns</a></li>
<li class="chapter" data-level="3.6.8" data-path="vectors-chap.html"><a href="vectors-chap.html#exercises-8"><i class="fa fa-check"></i><b>3.6.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="vectors-chap.html"><a href="vectors-chap.html#null"><i class="fa fa-check"></i><b>3.7</b> <code>NULL</code></a></li>
<li class="chapter" data-level="3.8" data-path="vectors-chap.html"><a href="vectors-chap.html#data-structure-answers"><i class="fa fa-check"></i><b>3.8</b> Answers</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="subsetting.html"><a href="subsetting.html"><i class="fa fa-check"></i><b>4</b> Subsetting</a><ul>
<li class="chapter" data-level="4.1" data-path="subsetting.html"><a href="subsetting.html#introduction-3"><i class="fa fa-check"></i><b>4.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="subsetting.html"><a href="subsetting.html#quiz-2"><i class="fa fa-check"></i>Quiz</a></li>
<li class="chapter" data-level="" data-path="subsetting.html"><a href="subsetting.html#outline-2"><i class="fa fa-check"></i>Outline</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="subsetting.html"><a href="subsetting.html#subset-multiple"><i class="fa fa-check"></i><b>4.2</b> Selecting multiple elements</a><ul>
<li class="chapter" data-level="4.2.1" data-path="subsetting.html"><a href="subsetting.html#atomic-vectors-1"><i class="fa fa-check"></i><b>4.2.1</b> Atomic vectors</a></li>
<li class="chapter" data-level="4.2.2" data-path="subsetting.html"><a href="subsetting.html#lists-1"><i class="fa fa-check"></i><b>4.2.2</b> Lists</a></li>
<li class="chapter" data-level="4.2.3" data-path="subsetting.html"><a href="subsetting.html#matrix-subsetting"><i class="fa fa-check"></i><b>4.2.3</b> Matrices and arrays</a></li>
<li class="chapter" data-level="4.2.4" data-path="subsetting.html"><a href="subsetting.html#df-subsetting"><i class="fa fa-check"></i><b>4.2.4</b> Data frames and tibbles</a></li>
<li class="chapter" data-level="4.2.5" data-path="subsetting.html"><a href="subsetting.html#simplify-preserve"><i class="fa fa-check"></i><b>4.2.5</b> Preserving dimensionality</a></li>
<li class="chapter" data-level="4.2.6" data-path="subsetting.html"><a href="subsetting.html#exercises-9"><i class="fa fa-check"></i><b>4.2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="subsetting.html"><a href="subsetting.html#subset-single"><i class="fa fa-check"></i><b>4.3</b> Selecting a single element</a><ul>
<li class="chapter" data-level="4.3.1" data-path="subsetting.html"><a href="subsetting.html#section"><i class="fa fa-check"></i><b>4.3.1</b> <code>[[</code></a></li>
<li class="chapter" data-level="4.3.2" data-path="subsetting.html"><a href="subsetting.html#section-1"><i class="fa fa-check"></i><b>4.3.2</b> <code>$</code></a></li>
<li class="chapter" data-level="4.3.3" data-path="subsetting.html"><a href="subsetting.html#missingout-of-bounds-indices"><i class="fa fa-check"></i><b>4.3.3</b> Missing/out of bounds indices</a></li>
<li class="chapter" data-level="4.3.4" data-path="subsetting.html"><a href="subsetting.html#and-slot"><i class="fa fa-check"></i><b>4.3.4</b> <code>@</code> and <code>slot()</code></a></li>
<li class="chapter" data-level="4.3.5" data-path="subsetting.html"><a href="subsetting.html#exercises-10"><i class="fa fa-check"></i><b>4.3.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="subsetting.html"><a href="subsetting.html#subassignment"><i class="fa fa-check"></i><b>4.4</b> Subsetting and assignment</a></li>
<li class="chapter" data-level="4.5" data-path="subsetting.html"><a href="subsetting.html#applications"><i class="fa fa-check"></i><b>4.5</b> Applications</a><ul>
<li class="chapter" data-level="4.5.1" data-path="subsetting.html"><a href="subsetting.html#lookup-tables"><i class="fa fa-check"></i><b>4.5.1</b> Lookup tables (character subsetting)</a></li>
<li class="chapter" data-level="4.5.2" data-path="subsetting.html"><a href="subsetting.html#matching-merging"><i class="fa fa-check"></i><b>4.5.2</b> Matching and merging by hand (integer subsetting)</a></li>
<li class="chapter" data-level="4.5.3" data-path="subsetting.html"><a href="subsetting.html#random-samplesbootstraps-integer-subsetting"><i class="fa fa-check"></i><b>4.5.3</b> Random samples/bootstraps (integer subsetting)</a></li>
<li class="chapter" data-level="4.5.4" data-path="subsetting.html"><a href="subsetting.html#ordering-integer-subsetting"><i class="fa fa-check"></i><b>4.5.4</b> Ordering (integer subsetting)</a></li>
<li class="chapter" data-level="4.5.5" data-path="subsetting.html"><a href="subsetting.html#expanding-aggregated-counts-integer-subsetting"><i class="fa fa-check"></i><b>4.5.5</b> Expanding aggregated counts (integer subsetting)</a></li>
<li class="chapter" data-level="4.5.6" data-path="subsetting.html"><a href="subsetting.html#removing-columns-from-data-frames-character-subsetting"><i class="fa fa-check"></i><b>4.5.6</b> Removing columns from data frames (character subsetting)</a></li>
<li class="chapter" data-level="4.5.7" data-path="subsetting.html"><a href="subsetting.html#selecting-rows-based-on-a-condition-logical-subsetting"><i class="fa fa-check"></i><b>4.5.7</b> Selecting rows based on a condition (logical subsetting)</a></li>
<li class="chapter" data-level="4.5.8" data-path="subsetting.html"><a href="subsetting.html#boolean-algebra-vs.sets-logical-integer-subsetting"><i class="fa fa-check"></i><b>4.5.8</b> Boolean algebra vs. sets (logical &amp; integer subsetting)</a></li>
<li class="chapter" data-level="4.5.9" data-path="subsetting.html"><a href="subsetting.html#exercises-11"><i class="fa fa-check"></i><b>4.5.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="subsetting.html"><a href="subsetting.html#subsetting-answers"><i class="fa fa-check"></i><b>4.6</b> Answers</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>5</b> Functions</a><ul>
<li class="chapter" data-level="5.1" data-path="functions.html"><a href="functions.html#introduction-4"><i class="fa fa-check"></i><b>5.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="functions.html"><a href="functions.html#quiz-3"><i class="fa fa-check"></i>Quiz</a></li>
<li class="chapter" data-level="" data-path="functions.html"><a href="functions.html#outline-3"><i class="fa fa-check"></i>Outline</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="functions.html"><a href="functions.html#function-fundamentals"><i class="fa fa-check"></i><b>5.2</b> Function fundamentals</a><ul>
<li class="chapter" data-level="5.2.1" data-path="functions.html"><a href="functions.html#first-class-functions"><i class="fa fa-check"></i><b>5.2.1</b> First-class functions</a></li>
<li class="chapter" data-level="5.2.2" data-path="functions.html"><a href="functions.html#function-components"><i class="fa fa-check"></i><b>5.2.2</b> Function components</a></li>
<li class="chapter" data-level="5.2.3" data-path="functions.html"><a href="functions.html#primitive-functions"><i class="fa fa-check"></i><b>5.2.3</b> Primitive functions</a></li>
<li class="chapter" data-level="5.2.4" data-path="functions.html"><a href="functions.html#exercises-12"><i class="fa fa-check"></i><b>5.2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="functions.html"><a href="functions.html#function-composition"><i class="fa fa-check"></i><b>5.3</b> Function composition</a></li>
<li class="chapter" data-level="5.4" data-path="functions.html"><a href="functions.html#lexical-scoping"><i class="fa fa-check"></i><b>5.4</b> Lexical scoping</a><ul>
<li class="chapter" data-level="5.4.1" data-path="functions.html"><a href="functions.html#name-masking"><i class="fa fa-check"></i><b>5.4.1</b> Name masking</a></li>
<li class="chapter" data-level="5.4.2" data-path="functions.html"><a href="functions.html#functions-vs.variables"><i class="fa fa-check"></i><b>5.4.2</b> Functions vs. variables</a></li>
<li class="chapter" data-level="5.4.3" data-path="functions.html"><a href="functions.html#fresh-start"><i class="fa fa-check"></i><b>5.4.3</b> A fresh start</a></li>
<li class="chapter" data-level="5.4.4" data-path="functions.html"><a href="functions.html#dynamic-lookup"><i class="fa fa-check"></i><b>5.4.4</b> Dynamic lookup</a></li>
<li class="chapter" data-level="5.4.5" data-path="functions.html"><a href="functions.html#exercises-13"><i class="fa fa-check"></i><b>5.4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="functions.html"><a href="functions.html#lazy-evaluation"><i class="fa fa-check"></i><b>5.5</b> Lazy evaluation</a><ul>
<li class="chapter" data-level="5.5.1" data-path="functions.html"><a href="functions.html#forcing-evaluation"><i class="fa fa-check"></i><b>5.5.1</b> Forcing evaluation</a></li>
<li class="chapter" data-level="5.5.2" data-path="functions.html"><a href="functions.html#promises"><i class="fa fa-check"></i><b>5.5.2</b> Promises</a></li>
<li class="chapter" data-level="5.5.3" data-path="functions.html"><a href="functions.html#default-arguments"><i class="fa fa-check"></i><b>5.5.3</b> Default arguments</a></li>
<li class="chapter" data-level="5.5.4" data-path="functions.html"><a href="functions.html#missing-arguments"><i class="fa fa-check"></i><b>5.5.4</b> Missing arguments</a></li>
<li class="chapter" data-level="5.5.5" data-path="functions.html"><a href="functions.html#exercises-14"><i class="fa fa-check"></i><b>5.5.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="functions.html"><a href="functions.html#fun-dot-dot-dot"><i class="fa fa-check"></i><b>5.6</b> <code>...</code> (dot-dot-dot)</a><ul>
<li class="chapter" data-level="5.6.1" data-path="functions.html"><a href="functions.html#exercises-15"><i class="fa fa-check"></i><b>5.6.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="functions.html"><a href="functions.html#exiting-a-function"><i class="fa fa-check"></i><b>5.7</b> Exiting a function</a><ul>
<li class="chapter" data-level="5.7.1" data-path="functions.html"><a href="functions.html#implicit-vs.explict-returns"><i class="fa fa-check"></i><b>5.7.1</b> Implicit vs. explict returns</a></li>
<li class="chapter" data-level="5.7.2" data-path="functions.html"><a href="functions.html#invisible-values"><i class="fa fa-check"></i><b>5.7.2</b> Invisible values</a></li>
<li class="chapter" data-level="5.7.3" data-path="functions.html"><a href="functions.html#errors"><i class="fa fa-check"></i><b>5.7.3</b> Errors</a></li>
<li class="chapter" data-level="5.7.4" data-path="functions.html"><a href="functions.html#on-exit"><i class="fa fa-check"></i><b>5.7.4</b> Exit handlers</a></li>
<li class="chapter" data-level="5.7.5" data-path="functions.html"><a href="functions.html#exercises-16"><i class="fa fa-check"></i><b>5.7.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="functions.html"><a href="functions.html#function-forms"><i class="fa fa-check"></i><b>5.8</b> Function forms</a><ul>
<li class="chapter" data-level="5.8.1" data-path="functions.html"><a href="functions.html#rewriting-to-prefix-form"><i class="fa fa-check"></i><b>5.8.1</b> Rewriting to prefix form</a></li>
<li class="chapter" data-level="5.8.2" data-path="functions.html"><a href="functions.html#prefix-form"><i class="fa fa-check"></i><b>5.8.2</b> Prefix form</a></li>
<li class="chapter" data-level="5.8.3" data-path="functions.html"><a href="functions.html#infix-functions"><i class="fa fa-check"></i><b>5.8.3</b> Infix functions</a></li>
<li class="chapter" data-level="5.8.4" data-path="functions.html"><a href="functions.html#replacement-functions"><i class="fa fa-check"></i><b>5.8.4</b> Replacement functions</a></li>
<li class="chapter" data-level="5.8.5" data-path="functions.html"><a href="functions.html#special-forms"><i class="fa fa-check"></i><b>5.8.5</b> Special forms</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="functions.html"><a href="functions.html#invoking-a-function"><i class="fa fa-check"></i><b>5.9</b> Invoking a function</a><ul>
<li class="chapter" data-level="5.9.1" data-path="functions.html"><a href="functions.html#exercises-17"><i class="fa fa-check"></i><b>5.9.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="functions.html"><a href="functions.html#function-answers"><i class="fa fa-check"></i><b>5.10</b> Quiz answers</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="environments.html"><a href="environments.html"><i class="fa fa-check"></i><b>6</b> Environments</a><ul>
<li class="chapter" data-level="6.1" data-path="environments.html"><a href="environments.html#introduction-5"><i class="fa fa-check"></i><b>6.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="environments.html"><a href="environments.html#quiz-4"><i class="fa fa-check"></i>Quiz</a></li>
<li class="chapter" data-level="" data-path="environments.html"><a href="environments.html#outline-4"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="environments.html"><a href="environments.html#prerequisites-1"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="environments.html"><a href="environments.html#env-basics"><i class="fa fa-check"></i><b>6.2</b> Environment basics</a><ul>
<li class="chapter" data-level="6.2.1" data-path="environments.html"><a href="environments.html#basics"><i class="fa fa-check"></i><b>6.2.1</b> Basics</a></li>
<li class="chapter" data-level="6.2.2" data-path="environments.html"><a href="environments.html#important-environments"><i class="fa fa-check"></i><b>6.2.2</b> Important environments</a></li>
<li class="chapter" data-level="6.2.3" data-path="environments.html"><a href="environments.html#parents"><i class="fa fa-check"></i><b>6.2.3</b> Parents</a></li>
<li class="chapter" data-level="6.2.4" data-path="environments.html"><a href="environments.html#super-assigment--"><i class="fa fa-check"></i><b>6.2.4</b> Super assigment, <code>&lt;&lt;-</code></a></li>
<li class="chapter" data-level="6.2.5" data-path="environments.html"><a href="environments.html#getting-and-setting-1"><i class="fa fa-check"></i><b>6.2.5</b> Getting and setting</a></li>
<li class="chapter" data-level="6.2.6" data-path="environments.html"><a href="environments.html#finalisers"><i class="fa fa-check"></i><b>6.2.6</b> Finalisers</a></li>
<li class="chapter" data-level="6.2.7" data-path="environments.html"><a href="environments.html#advanced-bindings"><i class="fa fa-check"></i><b>6.2.7</b> Advanced bindings</a></li>
<li class="chapter" data-level="6.2.8" data-path="environments.html"><a href="environments.html#exercises-18"><i class="fa fa-check"></i><b>6.2.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="environments.html"><a href="environments.html#env-recursion"><i class="fa fa-check"></i><b>6.3</b> Recursing over environments</a><ul>
<li class="chapter" data-level="6.3.1" data-path="environments.html"><a href="environments.html#exercises-19"><i class="fa fa-check"></i><b>6.3.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="environments.html"><a href="environments.html#function-envs"><i class="fa fa-check"></i><b>6.4</b> Special environments</a><ul>
<li class="chapter" data-level="6.4.1" data-path="environments.html"><a href="environments.html#package-environments-and-the-search-path"><i class="fa fa-check"></i><b>6.4.1</b> Package environments and the search path</a></li>
<li class="chapter" data-level="6.4.2" data-path="environments.html"><a href="environments.html#the-function-environment"><i class="fa fa-check"></i><b>6.4.2</b> The function environment</a></li>
<li class="chapter" data-level="6.4.3" data-path="environments.html"><a href="environments.html#namespaces"><i class="fa fa-check"></i><b>6.4.3</b> Namespaces</a></li>
<li class="chapter" data-level="6.4.4" data-path="environments.html"><a href="environments.html#execution-environments"><i class="fa fa-check"></i><b>6.4.4</b> Execution environments</a></li>
<li class="chapter" data-level="6.4.5" data-path="environments.html"><a href="environments.html#exercises-20"><i class="fa fa-check"></i><b>6.4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="environments.html"><a href="environments.html#call-stack"><i class="fa fa-check"></i><b>6.5</b> The call stack</a><ul>
<li class="chapter" data-level="6.5.1" data-path="environments.html"><a href="environments.html#simple-call-stacks"><i class="fa fa-check"></i><b>6.5.1</b> Simple call stacks</a></li>
<li class="chapter" data-level="6.5.2" data-path="environments.html"><a href="environments.html#lazy-evaluation-1"><i class="fa fa-check"></i><b>6.5.2</b> Lazy evaluation</a></li>
<li class="chapter" data-level="6.5.3" data-path="environments.html"><a href="environments.html#frames"><i class="fa fa-check"></i><b>6.5.3</b> Frames</a></li>
<li class="chapter" data-level="6.5.4" data-path="environments.html"><a href="environments.html#dynamic-scope"><i class="fa fa-check"></i><b>6.5.4</b> Dynamic scope</a></li>
<li class="chapter" data-level="6.5.5" data-path="environments.html"><a href="environments.html#exercises-21"><i class="fa fa-check"></i><b>6.5.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="environments.html"><a href="environments.html#explicit-envs"><i class="fa fa-check"></i><b>6.6</b> As data structures</a></li>
<li class="chapter" data-level="6.7" data-path="environments.html"><a href="environments.html#env-answers"><i class="fa fa-check"></i><b>6.7</b> Quiz answers</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="conditions.html"><a href="conditions.html"><i class="fa fa-check"></i><b>7</b> Conditions</a><ul>
<li class="chapter" data-level="7.1" data-path="conditions.html"><a href="conditions.html#introduction-6"><i class="fa fa-check"></i><b>7.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="conditions.html"><a href="conditions.html#quiz-5"><i class="fa fa-check"></i>Quiz</a></li>
<li class="chapter" data-level="" data-path="conditions.html"><a href="conditions.html#overview"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="7.1.1" data-path="conditions.html"><a href="conditions.html#prerequisites-2"><i class="fa fa-check"></i><b>7.1.1</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="conditions.html"><a href="conditions.html#signalling-conditions"><i class="fa fa-check"></i><b>7.2</b> Signalling conditions</a><ul>
<li class="chapter" data-level="7.2.1" data-path="conditions.html"><a href="conditions.html#errors-1"><i class="fa fa-check"></i><b>7.2.1</b> Errors</a></li>
<li class="chapter" data-level="7.2.2" data-path="conditions.html"><a href="conditions.html#warnings"><i class="fa fa-check"></i><b>7.2.2</b> Warnings</a></li>
<li class="chapter" data-level="7.2.3" data-path="conditions.html"><a href="conditions.html#messages"><i class="fa fa-check"></i><b>7.2.3</b> Messages</a></li>
<li class="chapter" data-level="7.2.4" data-path="conditions.html"><a href="conditions.html#exercises-22"><i class="fa fa-check"></i><b>7.2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="conditions.html"><a href="conditions.html#ignoring-conditions"><i class="fa fa-check"></i><b>7.3</b> Ignoring conditions</a></li>
<li class="chapter" data-level="7.4" data-path="conditions.html"><a href="conditions.html#handling-conditions"><i class="fa fa-check"></i><b>7.4</b> Handling conditions</a><ul>
<li class="chapter" data-level="7.4.1" data-path="conditions.html"><a href="conditions.html#condition-objects"><i class="fa fa-check"></i><b>7.4.1</b> Condition objects</a></li>
<li class="chapter" data-level="7.4.2" data-path="conditions.html"><a href="conditions.html#exiting-handlers"><i class="fa fa-check"></i><b>7.4.2</b> Exiting handlers</a></li>
<li class="chapter" data-level="7.4.3" data-path="conditions.html"><a href="conditions.html#calling-handlers"><i class="fa fa-check"></i><b>7.4.3</b> Calling handlers</a></li>
<li class="chapter" data-level="7.4.4" data-path="conditions.html"><a href="conditions.html#call-stacks"><i class="fa fa-check"></i><b>7.4.4</b> Call stacks</a></li>
<li class="chapter" data-level="7.4.5" data-path="conditions.html"><a href="conditions.html#exercises-23"><i class="fa fa-check"></i><b>7.4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="conditions.html"><a href="conditions.html#custom-conditions"><i class="fa fa-check"></i><b>7.5</b> Custom conditions</a><ul>
<li class="chapter" data-level="7.5.1" data-path="conditions.html"><a href="conditions.html#motivation"><i class="fa fa-check"></i><b>7.5.1</b> Motivation</a></li>
<li class="chapter" data-level="7.5.2" data-path="conditions.html"><a href="conditions.html#signalling"><i class="fa fa-check"></i><b>7.5.2</b> Signalling</a></li>
<li class="chapter" data-level="7.5.3" data-path="conditions.html"><a href="conditions.html#handling"><i class="fa fa-check"></i><b>7.5.3</b> Handling</a></li>
<li class="chapter" data-level="7.5.4" data-path="conditions.html"><a href="conditions.html#exercises-24"><i class="fa fa-check"></i><b>7.5.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="conditions.html"><a href="conditions.html#condition-applications"><i class="fa fa-check"></i><b>7.6</b> Applications</a><ul>
<li class="chapter" data-level="7.6.1" data-path="conditions.html"><a href="conditions.html#failure-value"><i class="fa fa-check"></i><b>7.6.1</b> Failure value</a></li>
<li class="chapter" data-level="7.6.2" data-path="conditions.html"><a href="conditions.html#try-success-failure"><i class="fa fa-check"></i><b>7.6.2</b> Success and failure values</a></li>
<li class="chapter" data-level="7.6.3" data-path="conditions.html"><a href="conditions.html#resignal"><i class="fa fa-check"></i><b>7.6.3</b> Resignal</a></li>
<li class="chapter" data-level="7.6.4" data-path="conditions.html"><a href="conditions.html#record"><i class="fa fa-check"></i><b>7.6.4</b> Record</a></li>
<li class="chapter" data-level="7.6.5" data-path="conditions.html"><a href="conditions.html#no-default-behaviour"><i class="fa fa-check"></i><b>7.6.5</b> No default behaviour</a></li>
<li class="chapter" data-level="7.6.6" data-path="conditions.html"><a href="conditions.html#exercises-25"><i class="fa fa-check"></i><b>7.6.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="conditions.html"><a href="conditions.html#conditions-answers"><i class="fa fa-check"></i><b>7.7</b> Quiz answers</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="connections.html"><a href="connections.html"><i class="fa fa-check"></i><b>8</b> Connections</a><ul>
<li class="chapter" data-level="8.1" data-path="connections.html"><a href="connections.html#basics-1"><i class="fa fa-check"></i><b>8.1</b> Basics</a></li>
<li class="chapter" data-level="8.2" data-path="connections.html"><a href="connections.html#reading-and-writing-binary-data"><i class="fa fa-check"></i><b>8.2</b> Reading and writing binary data</a></li>
<li class="chapter" data-level="8.3" data-path="connections.html"><a href="connections.html#reading-and-writing-text-data"><i class="fa fa-check"></i><b>8.3</b> Reading and writing text data</a></li>
</ul></li>
<li class="part"><span><b>II Functional programming</b></span></li>
<li class="chapter" data-level="" data-path="fp.html"><a href="fp.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="" data-path="fp.html"><a href="fp.html#functional-programming-languages"><i class="fa fa-check"></i>Functional programming languages</a></li>
<li class="chapter" data-level="" data-path="fp.html"><a href="fp.html#functional-style"><i class="fa fa-check"></i>Functional style</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="functionals.html"><a href="functionals.html"><i class="fa fa-check"></i><b>9</b> Functionals</a><ul>
<li class="chapter" data-level="9.1" data-path="functionals.html"><a href="functionals.html#introduction-7"><i class="fa fa-check"></i><b>9.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="functionals.html"><a href="functionals.html#outline-5"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="functionals.html"><a href="functionals.html#prerequisites-3"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="functionals.html"><a href="functionals.html#map"><i class="fa fa-check"></i><b>9.2</b> My first functional: <code>map()</code></a><ul>
<li class="chapter" data-level="9.2.1" data-path="functionals.html"><a href="functionals.html#producing-atomic-vectors"><i class="fa fa-check"></i><b>9.2.1</b> Producing atomic vectors</a></li>
<li class="chapter" data-level="9.2.2" data-path="functionals.html"><a href="functionals.html#anonymous-functions-and-helpers"><i class="fa fa-check"></i><b>9.2.2</b> Anonymous functions and helpers</a></li>
<li class="chapter" data-level="9.2.3" data-path="functionals.html"><a href="functionals.html#passing-arguments"><i class="fa fa-check"></i><b>9.2.3</b> Passing arguments with <code>...</code></a></li>
<li class="chapter" data-level="9.2.4" data-path="functionals.html"><a href="functionals.html#argument-names"><i class="fa fa-check"></i><b>9.2.4</b> Argument names</a></li>
<li class="chapter" data-level="9.2.5" data-path="functionals.html"><a href="functionals.html#change-argument"><i class="fa fa-check"></i><b>9.2.5</b> Varying another argument</a></li>
<li class="chapter" data-level="9.2.6" data-path="functionals.html"><a href="functionals.html#exercises-26"><i class="fa fa-check"></i><b>9.2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="functionals.html"><a href="functionals.html#purrr-style"><i class="fa fa-check"></i><b>9.3</b> Purrr style</a></li>
<li class="chapter" data-level="9.4" data-path="functionals.html"><a href="functionals.html#functionals-loop"><i class="fa fa-check"></i><b>9.4</b> Map variants</a><ul>
<li class="chapter" data-level="9.4.1" data-path="functionals.html"><a href="functionals.html#modify"><i class="fa fa-check"></i><b>9.4.1</b> Same type of output as input: <code>modify()</code></a></li>
<li class="chapter" data-level="9.4.2" data-path="functionals.html"><a href="functionals.html#map2"><i class="fa fa-check"></i><b>9.4.2</b> Two inputs: <code>map2()</code> and friends</a></li>
<li class="chapter" data-level="9.4.3" data-path="functionals.html"><a href="functionals.html#no-outputs-walk-and-friends"><i class="fa fa-check"></i><b>9.4.3</b> No outputs: <code>walk()</code> and friends</a></li>
<li class="chapter" data-level="9.4.4" data-path="functionals.html"><a href="functionals.html#iterating-over-values-and-indices"><i class="fa fa-check"></i><b>9.4.4</b> Iterating over values and indices</a></li>
<li class="chapter" data-level="9.4.5" data-path="functionals.html"><a href="functionals.html#pmap"><i class="fa fa-check"></i><b>9.4.5</b> Any number of inputs: <code>pmap()</code> and friends</a></li>
<li class="chapter" data-level="9.4.6" data-path="functionals.html"><a href="functionals.html#exercises-27"><i class="fa fa-check"></i><b>9.4.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="functionals.html"><a href="functionals.html#reduce"><i class="fa fa-check"></i><b>9.5</b> Reduce</a><ul>
<li class="chapter" data-level="9.5.1" data-path="functionals.html"><a href="functionals.html#basics-2"><i class="fa fa-check"></i><b>9.5.1</b> Basics</a></li>
<li class="chapter" data-level="9.5.2" data-path="functionals.html"><a href="functionals.html#accumulate"><i class="fa fa-check"></i><b>9.5.2</b> Accumulate</a></li>
<li class="chapter" data-level="9.5.3" data-path="functionals.html"><a href="functionals.html#output-types"><i class="fa fa-check"></i><b>9.5.3</b> Output types</a></li>
<li class="chapter" data-level="9.5.4" data-path="functionals.html"><a href="functionals.html#multiple-inputs"><i class="fa fa-check"></i><b>9.5.4</b> Multiple inputs</a></li>
<li class="chapter" data-level="9.5.5" data-path="functionals.html"><a href="functionals.html#map-reduce"><i class="fa fa-check"></i><b>9.5.5</b> Map-reduce</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="functionals.html"><a href="functionals.html#predicate-functionals"><i class="fa fa-check"></i><b>9.6</b> Predicate functionals</a><ul>
<li class="chapter" data-level="9.6.1" data-path="functionals.html"><a href="functionals.html#basics-3"><i class="fa fa-check"></i><b>9.6.1</b> Basics</a></li>
<li class="chapter" data-level="9.6.2" data-path="functionals.html"><a href="functionals.html#predicate-map"><i class="fa fa-check"></i><b>9.6.2</b> Map variants</a></li>
<li class="chapter" data-level="9.6.3" data-path="functionals.html"><a href="functionals.html#exercises-28"><i class="fa fa-check"></i><b>9.6.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="functionals.html"><a href="functionals.html#functionals-math"><i class="fa fa-check"></i><b>9.7</b> Base functionals</a><ul>
<li class="chapter" data-level="9.7.1" data-path="functionals.html"><a href="functionals.html#matrices-and-arrays"><i class="fa fa-check"></i><b>9.7.1</b> Matrices and arrays</a></li>
<li class="chapter" data-level="9.7.2" data-path="functionals.html"><a href="functionals.html#ragged-arrays"><i class="fa fa-check"></i><b>9.7.2</b> “Ragged” arrays</a></li>
<li class="chapter" data-level="9.7.3" data-path="functionals.html"><a href="functionals.html#mathematical"><i class="fa fa-check"></i><b>9.7.3</b> Mathematical</a></li>
<li class="chapter" data-level="9.7.4" data-path="functionals.html"><a href="functionals.html#exercises-29"><i class="fa fa-check"></i><b>9.7.4</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="function-factories.html"><a href="function-factories.html"><i class="fa fa-check"></i><b>10</b> Function factories</a><ul>
<li class="chapter" data-level="10.1" data-path="function-factories.html"><a href="function-factories.html#introduction-8"><i class="fa fa-check"></i><b>10.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="function-factories.html"><a href="function-factories.html#outline-6"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="function-factories.html"><a href="function-factories.html#prerequisites-4"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="function-factories.html"><a href="function-factories.html#factory-fundamentals"><i class="fa fa-check"></i><b>10.2</b> Factory fundamentals</a><ul>
<li class="chapter" data-level="10.2.1" data-path="function-factories.html"><a href="function-factories.html#environments-1"><i class="fa fa-check"></i><b>10.2.1</b> Environments</a></li>
<li class="chapter" data-level="10.2.2" data-path="function-factories.html"><a href="function-factories.html#diagram-conventions"><i class="fa fa-check"></i><b>10.2.2</b> Diagram conventions</a></li>
<li class="chapter" data-level="10.2.3" data-path="function-factories.html"><a href="function-factories.html#stateful-funs"><i class="fa fa-check"></i><b>10.2.3</b> Stateful functions</a></li>
<li class="chapter" data-level="10.2.4" data-path="function-factories.html"><a href="function-factories.html#factory-pitfalls"><i class="fa fa-check"></i><b>10.2.4</b> Potential pitfalls</a></li>
<li class="chapter" data-level="10.2.5" data-path="function-factories.html"><a href="function-factories.html#exercises-30"><i class="fa fa-check"></i><b>10.2.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="function-factories.html"><a href="function-factories.html#graph-fact"><i class="fa fa-check"></i><b>10.3</b> Graphical factories</a><ul>
<li class="chapter" data-level="10.3.1" data-path="function-factories.html"><a href="function-factories.html#labelling"><i class="fa fa-check"></i><b>10.3.1</b> Labelling</a></li>
<li class="chapter" data-level="10.3.2" data-path="function-factories.html"><a href="function-factories.html#histogram-bins"><i class="fa fa-check"></i><b>10.3.2</b> Histogram bins</a></li>
<li class="chapter" data-level="10.3.3" data-path="function-factories.html"><a href="function-factories.html#ggsave"><i class="fa fa-check"></i><b>10.3.3</b> ggsave</a></li>
<li class="chapter" data-level="10.3.4" data-path="function-factories.html"><a href="function-factories.html#exercises-31"><i class="fa fa-check"></i><b>10.3.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="function-factories.html"><a href="function-factories.html#stat-fact"><i class="fa fa-check"></i><b>10.4</b> Statistical factories</a><ul>
<li class="chapter" data-level="10.4.1" data-path="function-factories.html"><a href="function-factories.html#box-cox-transformation"><i class="fa fa-check"></i><b>10.4.1</b> Box-Cox transformation</a></li>
<li class="chapter" data-level="10.4.2" data-path="function-factories.html"><a href="function-factories.html#bootstrap-generators"><i class="fa fa-check"></i><b>10.4.2</b> Bootstrap generators</a></li>
<li class="chapter" data-level="10.4.3" data-path="function-factories.html"><a href="function-factories.html#MLE"><i class="fa fa-check"></i><b>10.4.3</b> Maximum likelihood estimation</a></li>
<li class="chapter" data-level="10.4.4" data-path="function-factories.html"><a href="function-factories.html#exercises-32"><i class="fa fa-check"></i><b>10.4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="function-factories.html"><a href="function-factories.html#functional-factories"><i class="fa fa-check"></i><b>10.5</b> Function factories + functionals</a><ul>
<li class="chapter" data-level="10.5.1" data-path="function-factories.html"><a href="function-factories.html#moving-a-list-to-the-global-environment"><i class="fa fa-check"></i><b>10.5.1</b> Moving a list to the global environment</a></li>
<li class="chapter" data-level="10.5.2" data-path="function-factories.html"><a href="function-factories.html#another-approach"><i class="fa fa-check"></i><b>10.5.2</b> Another approach</a></li>
<li class="chapter" data-level="10.5.3" data-path="function-factories.html"><a href="function-factories.html#exercises-33"><i class="fa fa-check"></i><b>10.5.3</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="function-operators.html"><a href="function-operators.html"><i class="fa fa-check"></i><b>11</b> Function operators</a><ul>
<li class="chapter" data-level="11.1" data-path="function-operators.html"><a href="function-operators.html#introduction-9"><i class="fa fa-check"></i><b>11.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="function-operators.html"><a href="function-operators.html#outline-7"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="function-operators.html"><a href="function-operators.html#prerequisites-5"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="function-operators.html"><a href="function-operators.html#existing-fos"><i class="fa fa-check"></i><b>11.2</b> Existing FOs</a><ul>
<li class="chapter" data-level="11.2.1" data-path="function-operators.html"><a href="function-operators.html#safely"><i class="fa fa-check"></i><b>11.2.1</b> Capturing errors with <code>purrr::safely()</code></a></li>
<li class="chapter" data-level="11.2.2" data-path="function-operators.html"><a href="function-operators.html#memoise"><i class="fa fa-check"></i><b>11.2.2</b> Caching computations with <code>memoise::memoise()</code></a></li>
<li class="chapter" data-level="11.2.3" data-path="function-operators.html"><a href="function-operators.html#exercises-34"><i class="fa fa-check"></i><b>11.2.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="function-operators.html"><a href="function-operators.html#fo-case-study"><i class="fa fa-check"></i><b>11.3</b> Case study: creating your own FOs</a><ul>
<li class="chapter" data-level="11.3.1" data-path="function-operators.html"><a href="function-operators.html#exercises-35"><i class="fa fa-check"></i><b>11.3.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Object oriented programming</b></span></li>
<li class="chapter" data-level="" data-path="oo.html"><a href="oo.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="" data-path="oo.html"><a href="oo.html#oop-systems"><i class="fa fa-check"></i>OOP systems</a></li>
<li class="chapter" data-level="" data-path="oo.html"><a href="oo.html#oop-in-r"><i class="fa fa-check"></i>OOP in R</a></li>
<li class="chapter" data-level="" data-path="oo.html"><a href="oo.html#sloop"><i class="fa fa-check"></i>Sloop</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="base-types.html"><a href="base-types.html"><i class="fa fa-check"></i><b>12</b> Base types</a><ul>
<li class="chapter" data-level="12.1" data-path="base-types.html"><a href="base-types.html#introduction-10"><i class="fa fa-check"></i><b>12.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="base-types.html"><a href="base-types.html#outline-8"><i class="fa fa-check"></i>Outline</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="base-types.html"><a href="base-types.html#base-vs-oo"><i class="fa fa-check"></i><b>12.2</b> Base vs OO objects</a></li>
<li class="chapter" data-level="12.3" data-path="base-types.html"><a href="base-types.html#base-types-2"><i class="fa fa-check"></i><b>12.3</b> Base types</a><ul>
<li class="chapter" data-level="12.3.1" data-path="base-types.html"><a href="base-types.html#numeric-type"><i class="fa fa-check"></i><b>12.3.1</b> Numeric type</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="s3.html"><a href="s3.html"><i class="fa fa-check"></i><b>13</b> S3</a><ul>
<li class="chapter" data-level="13.1" data-path="s3.html"><a href="s3.html#introduction-11"><i class="fa fa-check"></i><b>13.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="s3.html"><a href="s3.html#outline-9"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="s3.html"><a href="s3.html#prerequisites-6"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="s3.html"><a href="s3.html#s3-basics"><i class="fa fa-check"></i><b>13.2</b> Basics</a><ul>
<li class="chapter" data-level="13.2.1" data-path="s3.html"><a href="s3.html#exercises-36"><i class="fa fa-check"></i><b>13.2.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="s3.html"><a href="s3.html#s3-classes"><i class="fa fa-check"></i><b>13.3</b> Classes</a><ul>
<li class="chapter" data-level="13.3.1" data-path="s3.html"><a href="s3.html#s3-constrcutor"><i class="fa fa-check"></i><b>13.3.1</b> Constructors</a></li>
<li class="chapter" data-level="13.3.2" data-path="s3.html"><a href="s3.html#validators"><i class="fa fa-check"></i><b>13.3.2</b> Validators</a></li>
<li class="chapter" data-level="13.3.3" data-path="s3.html"><a href="s3.html#helpers"><i class="fa fa-check"></i><b>13.3.3</b> Helpers</a></li>
<li class="chapter" data-level="13.3.4" data-path="s3.html"><a href="s3.html#exercises-37"><i class="fa fa-check"></i><b>13.3.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="s3.html"><a href="s3.html#s3-methods"><i class="fa fa-check"></i><b>13.4</b> Generics and methods</a><ul>
<li class="chapter" data-level="13.4.1" data-path="s3.html"><a href="s3.html#method-dispatch"><i class="fa fa-check"></i><b>13.4.1</b> Method dispatch</a></li>
<li class="chapter" data-level="13.4.2" data-path="s3.html"><a href="s3.html#finding-methods"><i class="fa fa-check"></i><b>13.4.2</b> Finding methods</a></li>
<li class="chapter" data-level="13.4.3" data-path="s3.html"><a href="s3.html#s3-arguments"><i class="fa fa-check"></i><b>13.4.3</b> Creating methods</a></li>
<li class="chapter" data-level="13.4.4" data-path="s3.html"><a href="s3.html#exercises-38"><i class="fa fa-check"></i><b>13.4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="s3.html"><a href="s3.html#object-styles"><i class="fa fa-check"></i><b>13.5</b> Object styles</a><ul>
<li class="chapter" data-level="13.5.1" data-path="s3.html"><a href="s3.html#exercises-39"><i class="fa fa-check"></i><b>13.5.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="s3.html"><a href="s3.html#s3-inheritance"><i class="fa fa-check"></i><b>13.6</b> Inheritance</a><ul>
<li class="chapter" data-level="13.6.1" data-path="s3.html"><a href="s3.html#nextmethod"><i class="fa fa-check"></i><b>13.6.1</b> <code>NextMethod()</code></a></li>
<li class="chapter" data-level="13.6.2" data-path="s3.html"><a href="s3.html#allowing-subclassing"><i class="fa fa-check"></i><b>13.6.2</b> Allowing subclassing</a></li>
<li class="chapter" data-level="13.6.3" data-path="s3.html"><a href="s3.html#exercises-40"><i class="fa fa-check"></i><b>13.6.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="s3.html"><a href="s3.html#s3-dispatch"><i class="fa fa-check"></i><b>13.7</b> Dispatch details</a><ul>
<li class="chapter" data-level="13.7.1" data-path="s3.html"><a href="s3.html#implicit-class"><i class="fa fa-check"></i><b>13.7.1</b> S3 and base types</a></li>
<li class="chapter" data-level="13.7.2" data-path="s3.html"><a href="s3.html#internal-generics"><i class="fa fa-check"></i><b>13.7.2</b> Internal generics</a></li>
<li class="chapter" data-level="13.7.3" data-path="s3.html"><a href="s3.html#group-generics"><i class="fa fa-check"></i><b>13.7.3</b> Group generics</a></li>
<li class="chapter" data-level="13.7.4" data-path="s3.html"><a href="s3.html#double-dispatch"><i class="fa fa-check"></i><b>13.7.4</b> Double dispatch</a></li>
<li class="chapter" data-level="13.7.5" data-path="s3.html"><a href="s3.html#exercises-41"><i class="fa fa-check"></i><b>13.7.5</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="r6.html"><a href="r6.html"><i class="fa fa-check"></i><b>14</b> R6</a><ul>
<li class="chapter" data-level="14.1" data-path="r6.html"><a href="r6.html#introduction-12"><i class="fa fa-check"></i><b>14.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="r6.html"><a href="r6.html#outline-10"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="r6.html"><a href="r6.html#prerequisites-7"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="r6.html"><a href="r6.html#r6-classes"><i class="fa fa-check"></i><b>14.2</b> Classes and methods</a><ul>
<li class="chapter" data-level="14.2.1" data-path="r6.html"><a href="r6.html#method-chaining"><i class="fa fa-check"></i><b>14.2.1</b> Method chaining</a></li>
<li class="chapter" data-level="14.2.2" data-path="r6.html"><a href="r6.html#important-methods"><i class="fa fa-check"></i><b>14.2.2</b> Important methods</a></li>
<li class="chapter" data-level="14.2.3" data-path="r6.html"><a href="r6.html#adding-methods-after-creation"><i class="fa fa-check"></i><b>14.2.3</b> Adding methods after creation</a></li>
<li class="chapter" data-level="14.2.4" data-path="r6.html"><a href="r6.html#inheritance"><i class="fa fa-check"></i><b>14.2.4</b> Inheritance</a></li>
<li class="chapter" data-level="14.2.5" data-path="r6.html"><a href="r6.html#introspection"><i class="fa fa-check"></i><b>14.2.5</b> Introspection</a></li>
<li class="chapter" data-level="14.2.6" data-path="r6.html"><a href="r6.html#exercises-42"><i class="fa fa-check"></i><b>14.2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="r6.html"><a href="r6.html#r6-access"><i class="fa fa-check"></i><b>14.3</b> Controlling access</a><ul>
<li class="chapter" data-level="14.3.1" data-path="r6.html"><a href="r6.html#privacy"><i class="fa fa-check"></i><b>14.3.1</b> Privacy</a></li>
<li class="chapter" data-level="14.3.2" data-path="r6.html"><a href="r6.html#active-fields"><i class="fa fa-check"></i><b>14.3.2</b> Active fields</a></li>
<li class="chapter" data-level="14.3.3" data-path="r6.html"><a href="r6.html#exercises-43"><i class="fa fa-check"></i><b>14.3.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="r6.html"><a href="r6.html#r6-semantics"><i class="fa fa-check"></i><b>14.4</b> Reference semantics</a><ul>
<li class="chapter" data-level="14.4.1" data-path="r6.html"><a href="r6.html#reasoning"><i class="fa fa-check"></i><b>14.4.1</b> Reasoning</a></li>
<li class="chapter" data-level="14.4.2" data-path="r6.html"><a href="r6.html#finalizer"><i class="fa fa-check"></i><b>14.4.2</b> Finalizer</a></li>
<li class="chapter" data-level="14.4.3" data-path="r6.html"><a href="r6.html#r6-fields"><i class="fa fa-check"></i><b>14.4.3</b> R6 fields</a></li>
<li class="chapter" data-level="14.4.4" data-path="r6.html"><a href="r6.html#exercises-44"><i class="fa fa-check"></i><b>14.4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="r6.html"><a href="r6.html#why-r6"><i class="fa fa-check"></i><b>14.5</b> Why R6?</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="s4.html"><a href="s4.html"><i class="fa fa-check"></i><b>15</b> S4</a><ul>
<li class="chapter" data-level="15.1" data-path="s4.html"><a href="s4.html#introduction-13"><i class="fa fa-check"></i><b>15.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="s4.html"><a href="s4.html#learning-more"><i class="fa fa-check"></i>Learning more</a></li>
<li class="chapter" data-level="" data-path="s4.html"><a href="s4.html#outline-11"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="s4.html"><a href="s4.html#prerequisites-8"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="s4.html"><a href="s4.html#s4-basics"><i class="fa fa-check"></i><b>15.2</b> Basics</a><ul>
<li class="chapter" data-level="15.2.1" data-path="s4.html"><a href="s4.html#exercises-45"><i class="fa fa-check"></i><b>15.2.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="s4.html"><a href="s4.html#s4-classes"><i class="fa fa-check"></i><b>15.3</b> Classes</a><ul>
<li class="chapter" data-level="15.3.1" data-path="s4.html"><a href="s4.html#inheritance-1"><i class="fa fa-check"></i><b>15.3.1</b> Inheritance</a></li>
<li class="chapter" data-level="15.3.2" data-path="s4.html"><a href="s4.html#redefinition"><i class="fa fa-check"></i><b>15.3.2</b> Redefinition</a></li>
<li class="chapter" data-level="15.3.3" data-path="s4.html"><a href="s4.html#helper"><i class="fa fa-check"></i><b>15.3.3</b> Helper</a></li>
<li class="chapter" data-level="15.3.4" data-path="s4.html"><a href="s4.html#validator"><i class="fa fa-check"></i><b>15.3.4</b> Validator</a></li>
<li class="chapter" data-level="15.3.5" data-path="s4.html"><a href="s4.html#introspection-1"><i class="fa fa-check"></i><b>15.3.5</b> Introspection</a></li>
<li class="chapter" data-level="15.3.6" data-path="s4.html"><a href="s4.html#exercises-46"><i class="fa fa-check"></i><b>15.3.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="s4.html"><a href="s4.html#s4-generics"><i class="fa fa-check"></i><b>15.4</b> Generics and methods</a><ul>
<li class="chapter" data-level="15.4.1" data-path="s4.html"><a href="s4.html#signature"><i class="fa fa-check"></i><b>15.4.1</b> Signature</a></li>
<li class="chapter" data-level="15.4.2" data-path="s4.html"><a href="s4.html#methods"><i class="fa fa-check"></i><b>15.4.2</b> Methods</a></li>
<li class="chapter" data-level="15.4.3" data-path="s4.html"><a href="s4.html#show-method"><i class="fa fa-check"></i><b>15.4.3</b> Show method</a></li>
<li class="chapter" data-level="15.4.4" data-path="s4.html"><a href="s4.html#accessors"><i class="fa fa-check"></i><b>15.4.4</b> Accessors</a></li>
<li class="chapter" data-level="15.4.5" data-path="s4.html"><a href="s4.html#introspection-2"><i class="fa fa-check"></i><b>15.4.5</b> Introspection</a></li>
<li class="chapter" data-level="15.4.6" data-path="s4.html"><a href="s4.html#exercises-47"><i class="fa fa-check"></i><b>15.4.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="s4.html"><a href="s4.html#s4-dispatch"><i class="fa fa-check"></i><b>15.5</b> Method dispatch</a><ul>
<li class="chapter" data-level="15.5.1" data-path="s4.html"><a href="s4.html#single-dispatch"><i class="fa fa-check"></i><b>15.5.1</b> Single dispatch</a></li>
<li class="chapter" data-level="15.5.2" data-path="s4.html"><a href="s4.html#multiple-inheritance"><i class="fa fa-check"></i><b>15.5.2</b> Multiple inheritance</a></li>
<li class="chapter" data-level="15.5.3" data-path="s4.html"><a href="s4.html#multiple-dispatch"><i class="fa fa-check"></i><b>15.5.3</b> Multiple dispatch</a></li>
<li class="chapter" data-level="15.5.4" data-path="s4.html"><a href="s4.html#multiple-dispatch-and-multiple-inheritance"><i class="fa fa-check"></i><b>15.5.4</b> Multiple dispatch and multiple inheritance</a></li>
<li class="chapter" data-level="15.5.5" data-path="s4.html"><a href="s4.html#exercises-48"><i class="fa fa-check"></i><b>15.5.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="s4.html"><a href="s4.html#s4-s3"><i class="fa fa-check"></i><b>15.6</b> S4 and S3</a><ul>
<li class="chapter" data-level="15.6.1" data-path="s4.html"><a href="s4.html#classes"><i class="fa fa-check"></i><b>15.6.1</b> Classes</a></li>
<li class="chapter" data-level="15.6.2" data-path="s4.html"><a href="s4.html#generics"><i class="fa fa-check"></i><b>15.6.2</b> Generics</a></li>
<li class="chapter" data-level="15.6.3" data-path="s4.html"><a href="s4.html#exercises-49"><i class="fa fa-check"></i><b>15.6.3</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html"><i class="fa fa-check"></i><b>16</b> Trade-offs</a><ul>
<li class="chapter" data-level="16.1" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html#introduction-14"><i class="fa fa-check"></i><b>16.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html#outline-12"><i class="fa fa-check"></i>Outline</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html#s3-s4"><i class="fa fa-check"></i><b>16.2</b> S4 vs S3</a></li>
<li class="chapter" data-level="16.3" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html#s3-r6"><i class="fa fa-check"></i><b>16.3</b> R6 vs S3</a><ul>
<li class="chapter" data-level="16.3.1" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html#namespacing"><i class="fa fa-check"></i><b>16.3.1</b> Namespacing</a></li>
<li class="chapter" data-level="16.3.2" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html#threading-state"><i class="fa fa-check"></i><b>16.3.2</b> Threading state</a></li>
<li class="chapter" data-level="16.3.3" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html#tradeoffs-pipe"><i class="fa fa-check"></i><b>16.3.3</b> Method chaining</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Metaprogramming</b></span></li>
<li class="chapter" data-level="" data-path="meta.html"><a href="meta.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="" data-path="meta.html"><a href="meta.html#trading-precision-for-concision"><i class="fa fa-check"></i>Trading precision for concision</a></li>
<li class="chapter" data-level="" data-path="meta.html"><a href="meta.html#domain-specific-languages"><i class="fa fa-check"></i>Domain specific languages</a></li>
<li class="chapter" data-level="" data-path="meta.html"><a href="meta.html#overview-1"><i class="fa fa-check"></i>Overview</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="expressions.html"><a href="expressions.html"><i class="fa fa-check"></i><b>17</b> Expressions</a><ul>
<li class="chapter" data-level="17.1" data-path="expressions.html"><a href="expressions.html#introduction-15"><i class="fa fa-check"></i><b>17.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="expressions.html"><a href="expressions.html#outline-13"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="expressions.html"><a href="expressions.html#prerequisites-9"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="expressions.html"><a href="expressions.html#abstract-syntax-trees"><i class="fa fa-check"></i><b>17.2</b> Abstract syntax trees</a><ul>
<li class="chapter" data-level="17.2.1" data-path="expressions.html"><a href="expressions.html#infix-vs.prefix-calls"><i class="fa fa-check"></i><b>17.2.1</b> Infix vs. prefix calls</a></li>
<li class="chapter" data-level="17.2.2" data-path="expressions.html"><a href="expressions.html#special-forms-1"><i class="fa fa-check"></i><b>17.2.2</b> Special forms</a></li>
<li class="chapter" data-level="17.2.3" data-path="expressions.html"><a href="expressions.html#function-factories-1"><i class="fa fa-check"></i><b>17.2.3</b> Function factories</a></li>
<li class="chapter" data-level="17.2.4" data-path="expressions.html"><a href="expressions.html#argument-names-1"><i class="fa fa-check"></i><b>17.2.4</b> Argument names</a></li>
<li class="chapter" data-level="17.2.5" data-path="expressions.html"><a href="expressions.html#exercises-50"><i class="fa fa-check"></i><b>17.2.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="expressions.html"><a href="expressions.html#rs-grammar"><i class="fa fa-check"></i><b>17.3</b> R’s grammar</a><ul>
<li class="chapter" data-level="17.3.1" data-path="expressions.html"><a href="expressions.html#operator-precedence"><i class="fa fa-check"></i><b>17.3.1</b> Operator precedence</a></li>
<li class="chapter" data-level="17.3.2" data-path="expressions.html"><a href="expressions.html#associativity"><i class="fa fa-check"></i><b>17.3.2</b> Associativity</a></li>
<li class="chapter" data-level="17.3.3" data-path="expressions.html"><a href="expressions.html#whitespace"><i class="fa fa-check"></i><b>17.3.3</b> Whitespace</a></li>
<li class="chapter" data-level="17.3.4" data-path="expressions.html"><a href="expressions.html#exercises-51"><i class="fa fa-check"></i><b>17.3.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="expressions.html"><a href="expressions.html#data-structures"><i class="fa fa-check"></i><b>17.4</b> Data structures</a><ul>
<li class="chapter" data-level="17.4.1" data-path="expressions.html"><a href="expressions.html#naming-conventions"><i class="fa fa-check"></i><b>17.4.1</b> Naming conventions</a></li>
<li class="chapter" data-level="17.4.2" data-path="expressions.html"><a href="expressions.html#constants"><i class="fa fa-check"></i><b>17.4.2</b> Constants</a></li>
<li class="chapter" data-level="17.4.3" data-path="expressions.html"><a href="expressions.html#symbols"><i class="fa fa-check"></i><b>17.4.3</b> Symbols</a></li>
<li class="chapter" data-level="17.4.4" data-path="expressions.html"><a href="expressions.html#calls"><i class="fa fa-check"></i><b>17.4.4</b> Calls</a></li>
<li class="chapter" data-level="17.4.5" data-path="expressions.html"><a href="expressions.html#pairlists"><i class="fa fa-check"></i><b>17.4.5</b> Pairlists</a></li>
<li class="chapter" data-level="17.4.6" data-path="expressions.html"><a href="expressions.html#expression-objects"><i class="fa fa-check"></i><b>17.4.6</b> Expression objects</a></li>
<li class="chapter" data-level="17.4.7" data-path="expressions.html"><a href="expressions.html#exercises-52"><i class="fa fa-check"></i><b>17.4.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="expressions.html"><a href="expressions.html#parsing-and-deparsing"><i class="fa fa-check"></i><b>17.5</b> Parsing and deparsing</a><ul>
<li class="chapter" data-level="17.5.1" data-path="expressions.html"><a href="expressions.html#exercises-53"><i class="fa fa-check"></i><b>17.5.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="17.6" data-path="expressions.html"><a href="expressions.html#ast-funs"><i class="fa fa-check"></i><b>17.6</b> Case study: Walking the AST with recursive functions</a><ul>
<li class="chapter" data-level="17.6.1" data-path="expressions.html"><a href="expressions.html#finding-f-and-t"><i class="fa fa-check"></i><b>17.6.1</b> Finding F and T</a></li>
<li class="chapter" data-level="17.6.2" data-path="expressions.html"><a href="expressions.html#finding-all-variables-created-by-assignment"><i class="fa fa-check"></i><b>17.6.2</b> Finding all variables created by assignment</a></li>
<li class="chapter" data-level="17.6.3" data-path="expressions.html"><a href="expressions.html#exercises-54"><i class="fa fa-check"></i><b>17.6.3</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="quasiquotation.html"><a href="quasiquotation.html"><i class="fa fa-check"></i><b>18</b> Quasiquotation</a><ul>
<li class="chapter" data-level="18.1" data-path="quasiquotation.html"><a href="quasiquotation.html#introduction-16"><i class="fa fa-check"></i><b>18.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="quasiquotation.html"><a href="quasiquotation.html#outline-14"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="quasiquotation.html"><a href="quasiquotation.html#prerequisites-10"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="quasiquotation.html"><a href="quasiquotation.html#motivation-1"><i class="fa fa-check"></i><b>18.2</b> Motivation</a><ul>
<li class="chapter" data-level="18.2.1" data-path="quasiquotation.html"><a href="quasiquotation.html#vocabulary"><i class="fa fa-check"></i><b>18.2.1</b> Vocabulary</a></li>
<li class="chapter" data-level="18.2.2" data-path="quasiquotation.html"><a href="quasiquotation.html#theory"><i class="fa fa-check"></i><b>18.2.2</b> Theory</a></li>
<li class="chapter" data-level="18.2.3" data-path="quasiquotation.html"><a href="quasiquotation.html#exercises-55"><i class="fa fa-check"></i><b>18.2.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="quasiquotation.html"><a href="quasiquotation.html#quotation"><i class="fa fa-check"></i><b>18.3</b> Quotation</a><ul>
<li class="chapter" data-level="18.3.1" data-path="quasiquotation.html"><a href="quasiquotation.html#with-rlang"><i class="fa fa-check"></i><b>18.3.1</b> With rlang</a></li>
<li class="chapter" data-level="18.3.2" data-path="quasiquotation.html"><a href="quasiquotation.html#with-base-r"><i class="fa fa-check"></i><b>18.3.2</b> With base R</a></li>
<li class="chapter" data-level="18.3.3" data-path="quasiquotation.html"><a href="quasiquotation.html#exercises-56"><i class="fa fa-check"></i><b>18.3.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="quasiquotation.html"><a href="quasiquotation.html#eval-basics"><i class="fa fa-check"></i><b>18.4</b> Evaluation</a></li>
<li class="chapter" data-level="18.5" data-path="quasiquotation.html"><a href="quasiquotation.html#unquotation"><i class="fa fa-check"></i><b>18.5</b> Unquotation</a><ul>
<li class="chapter" data-level="18.5.1" data-path="quasiquotation.html"><a href="quasiquotation.html#with-rlang-1"><i class="fa fa-check"></i><b>18.5.1</b> With rlang</a></li>
<li class="chapter" data-level="18.5.2" data-path="quasiquotation.html"><a href="quasiquotation.html#the-polite-fiction-of"><i class="fa fa-check"></i><b>18.5.2</b> The polite fiction of <code>!!</code></a></li>
<li class="chapter" data-level="18.5.3" data-path="quasiquotation.html"><a href="quasiquotation.html#unquote-base"><i class="fa fa-check"></i><b>18.5.3</b> With base R</a></li>
<li class="chapter" data-level="18.5.4" data-path="quasiquotation.html"><a href="quasiquotation.html#non-standard-asts"><i class="fa fa-check"></i><b>18.5.4</b> Non-standard ASTs</a></li>
<li class="chapter" data-level="18.5.5" data-path="quasiquotation.html"><a href="quasiquotation.html#missing-arguments-1"><i class="fa fa-check"></i><b>18.5.5</b> Missing arguments</a></li>
<li class="chapter" data-level="18.5.6" data-path="quasiquotation.html"><a href="quasiquotation.html#exercises-57"><i class="fa fa-check"></i><b>18.5.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="quasiquotation.html"><a href="quasiquotation.html#quasi-case-studies"><i class="fa fa-check"></i><b>18.6</b> Case studies</a><ul>
<li class="chapter" data-level="18.6.1" data-path="quasiquotation.html"><a href="quasiquotation.html#map-reduce-to-generate-code"><i class="fa fa-check"></i><b>18.6.1</b> Map-reduce to generate code</a></li>
<li class="chapter" data-level="18.6.2" data-path="quasiquotation.html"><a href="quasiquotation.html#partition"><i class="fa fa-check"></i><b>18.6.2</b> Partition</a></li>
<li class="chapter" data-level="18.6.3" data-path="quasiquotation.html"><a href="quasiquotation.html#slicing-an-array"><i class="fa fa-check"></i><b>18.6.3</b> Slicing an array</a></li>
<li class="chapter" data-level="18.6.4" data-path="quasiquotation.html"><a href="quasiquotation.html#quasi-function"><i class="fa fa-check"></i><b>18.6.4</b> Creating functions</a></li>
<li class="chapter" data-level="18.6.5" data-path="quasiquotation.html"><a href="quasiquotation.html#exercises-58"><i class="fa fa-check"></i><b>18.6.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="18.7" data-path="quasiquotation.html"><a href="quasiquotation.html#dot-dot-dot-..."><i class="fa fa-check"></i><b>18.7</b> Dot-dot-dot (<code>...</code>)</a><ul>
<li class="chapter" data-level="18.7.1" data-path="quasiquotation.html"><a href="quasiquotation.html#do.call"><i class="fa fa-check"></i><b>18.7.1</b> <code>do.call()</code></a></li>
<li class="chapter" data-level="18.7.2" data-path="quasiquotation.html"><a href="quasiquotation.html#the-tidyverse-approach"><i class="fa fa-check"></i><b>18.7.2</b> The tidyverse approach</a></li>
<li class="chapter" data-level="18.7.3" data-path="quasiquotation.html"><a href="quasiquotation.html#list2"><i class="fa fa-check"></i><b>18.7.3</b> <code>list2()</code></a></li>
<li class="chapter" data-level="18.7.4" data-path="quasiquotation.html"><a href="quasiquotation.html#application-invoke-and-lang"><i class="fa fa-check"></i><b>18.7.4</b> Application: <code>invoke()</code> and <code>lang()</code></a></li>
<li class="chapter" data-level="18.7.5" data-path="quasiquotation.html"><a href="quasiquotation.html#other-approaches"><i class="fa fa-check"></i><b>18.7.5</b> Other approaches</a></li>
<li class="chapter" data-level="18.7.6" data-path="quasiquotation.html"><a href="quasiquotation.html#exercises-59"><i class="fa fa-check"></i><b>18.7.6</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="evaluation.html"><a href="evaluation.html"><i class="fa fa-check"></i><b>19</b> Evaluation</a><ul>
<li class="chapter" data-level="19.1" data-path="evaluation.html"><a href="evaluation.html#introduction-17"><i class="fa fa-check"></i><b>19.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="evaluation.html"><a href="evaluation.html#outline-15"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="evaluation.html"><a href="evaluation.html#prerequisites-11"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="evaluation.html"><a href="evaluation.html#evaluation-basics"><i class="fa fa-check"></i><b>19.2</b> Evaluation basics</a><ul>
<li class="chapter" data-level="19.2.1" data-path="evaluation.html"><a href="evaluation.html#application-local"><i class="fa fa-check"></i><b>19.2.1</b> Application: <code>local()</code></a></li>
<li class="chapter" data-level="19.2.2" data-path="evaluation.html"><a href="evaluation.html#application-source"><i class="fa fa-check"></i><b>19.2.2</b> Application: <code>source()</code></a></li>
<li class="chapter" data-level="19.2.3" data-path="evaluation.html"><a href="evaluation.html#gotcha-function"><i class="fa fa-check"></i><b>19.2.3</b> Gotcha: <code>function()</code></a></li>
<li class="chapter" data-level="19.2.4" data-path="evaluation.html"><a href="evaluation.html#eval-frame"><i class="fa fa-check"></i><b>19.2.4</b> Advanced: environments vs. frames</a></li>
<li class="chapter" data-level="19.2.5" data-path="evaluation.html"><a href="evaluation.html#base-r"><i class="fa fa-check"></i><b>19.2.5</b> Base R</a></li>
<li class="chapter" data-level="19.2.6" data-path="evaluation.html"><a href="evaluation.html#exercises-60"><i class="fa fa-check"></i><b>19.2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="evaluation.html"><a href="evaluation.html#quosures"><i class="fa fa-check"></i><b>19.3</b> Quosures</a><ul>
<li class="chapter" data-level="19.3.1" data-path="evaluation.html"><a href="evaluation.html#motivation-2"><i class="fa fa-check"></i><b>19.3.1</b> Motivation</a></li>
<li class="chapter" data-level="19.3.2" data-path="evaluation.html"><a href="evaluation.html#creating-and-manipulating"><i class="fa fa-check"></i><b>19.3.2</b> Creating and manipulating</a></li>
<li class="chapter" data-level="19.3.3" data-path="evaluation.html"><a href="evaluation.html#evaluating"><i class="fa fa-check"></i><b>19.3.3</b> Evaluating</a></li>
<li class="chapter" data-level="19.3.4" data-path="evaluation.html"><a href="evaluation.html#implementation"><i class="fa fa-check"></i><b>19.3.4</b> Implementation</a></li>
<li class="chapter" data-level="19.3.5" data-path="evaluation.html"><a href="evaluation.html#when-not-to-use-quosures"><i class="fa fa-check"></i><b>19.3.5</b> When not to use quosures</a></li>
<li class="chapter" data-level="19.3.6" data-path="evaluation.html"><a href="evaluation.html#exercises-61"><i class="fa fa-check"></i><b>19.3.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="evaluation.html"><a href="evaluation.html#tidy-evaluation"><i class="fa fa-check"></i><b>19.4</b> Tidy evaluation</a><ul>
<li class="chapter" data-level="19.4.1" data-path="evaluation.html"><a href="evaluation.html#data-masks"><i class="fa fa-check"></i><b>19.4.1</b> Data masks</a></li>
<li class="chapter" data-level="19.4.2" data-path="evaluation.html"><a href="evaluation.html#subset"><i class="fa fa-check"></i><b>19.4.2</b> Application: <code>subset()</code></a></li>
<li class="chapter" data-level="19.4.3" data-path="evaluation.html"><a href="evaluation.html#application-arrange"><i class="fa fa-check"></i><b>19.4.3</b> Application: <code>arrange()</code></a></li>
<li class="chapter" data-level="19.4.4" data-path="evaluation.html"><a href="evaluation.html#ambiguity-and-pronouns"><i class="fa fa-check"></i><b>19.4.4</b> Ambiguity and pronouns</a></li>
<li class="chapter" data-level="19.4.5" data-path="evaluation.html"><a href="evaluation.html#base-subset"><i class="fa fa-check"></i><b>19.4.5</b> Base <code>subset()</code></a></li>
<li class="chapter" data-level="19.4.6" data-path="evaluation.html"><a href="evaluation.html#tidy-eval-performance"><i class="fa fa-check"></i><b>19.4.6</b> Performance</a></li>
<li class="chapter" data-level="19.4.7" data-path="evaluation.html"><a href="evaluation.html#exercises-62"><i class="fa fa-check"></i><b>19.4.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="evaluation.html"><a href="evaluation.html#wrapping-quoting-functions"><i class="fa fa-check"></i><b>19.5</b> Wrapping quoting functions</a><ul>
<li class="chapter" data-level="19.5.1" data-path="evaluation.html"><a href="evaluation.html#tidy-evaluation-1"><i class="fa fa-check"></i><b>19.5.1</b> Tidy evaluation</a></li>
<li class="chapter" data-level="19.5.2" data-path="evaluation.html"><a href="evaluation.html#base-r-1"><i class="fa fa-check"></i><b>19.5.2</b> Base R</a></li>
<li class="chapter" data-level="19.5.3" data-path="evaluation.html"><a href="evaluation.html#the-evaluation-environment"><i class="fa fa-check"></i><b>19.5.3</b> The evaluation environment</a></li>
<li class="chapter" data-level="19.5.4" data-path="evaluation.html"><a href="evaluation.html#making-formulas"><i class="fa fa-check"></i><b>19.5.4</b> Making formulas</a></li>
<li class="chapter" data-level="19.5.5" data-path="evaluation.html"><a href="evaluation.html#exercises-63"><i class="fa fa-check"></i><b>19.5.5</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="translation.html"><a href="translation.html"><i class="fa fa-check"></i><b>20</b> Translating R code</a><ul>
<li class="chapter" data-level="20.1" data-path="translation.html"><a href="translation.html#introduction-18"><i class="fa fa-check"></i><b>20.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="translation.html"><a href="translation.html#outline-16"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="translation.html"><a href="translation.html#prequisites"><i class="fa fa-check"></i>Prequisites</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="translation.html"><a href="translation.html#html"><i class="fa fa-check"></i><b>20.2</b> HTML</a><ul>
<li class="chapter" data-level="20.2.1" data-path="translation.html"><a href="translation.html#goal"><i class="fa fa-check"></i><b>20.2.1</b> Goal</a></li>
<li class="chapter" data-level="20.2.2" data-path="translation.html"><a href="translation.html#escaping"><i class="fa fa-check"></i><b>20.2.2</b> Escaping</a></li>
<li class="chapter" data-level="20.2.3" data-path="translation.html"><a href="translation.html#basic-tag-functions"><i class="fa fa-check"></i><b>20.2.3</b> Basic tag functions</a></li>
<li class="chapter" data-level="20.2.4" data-path="translation.html"><a href="translation.html#tag-functions"><i class="fa fa-check"></i><b>20.2.4</b> Tag functions</a></li>
<li class="chapter" data-level="20.2.5" data-path="translation.html"><a href="translation.html#processing-all-tags"><i class="fa fa-check"></i><b>20.2.5</b> Processing all tags</a></li>
<li class="chapter" data-level="20.2.6" data-path="translation.html"><a href="translation.html#exercises-64"><i class="fa fa-check"></i><b>20.2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="translation.html"><a href="translation.html#latex"><i class="fa fa-check"></i><b>20.3</b> LaTeX</a><ul>
<li class="chapter" data-level="20.3.1" data-path="translation.html"><a href="translation.html#latex-mathematics"><i class="fa fa-check"></i><b>20.3.1</b> LaTeX mathematics</a></li>
<li class="chapter" data-level="20.3.2" data-path="translation.html"><a href="translation.html#goal-1"><i class="fa fa-check"></i><b>20.3.2</b> Goal</a></li>
<li class="chapter" data-level="20.3.3" data-path="translation.html"><a href="translation.html#to_math"><i class="fa fa-check"></i><b>20.3.3</b> <code>to_math</code></a></li>
<li class="chapter" data-level="20.3.4" data-path="translation.html"><a href="translation.html#known-symbols"><i class="fa fa-check"></i><b>20.3.4</b> Known symbols</a></li>
<li class="chapter" data-level="20.3.5" data-path="translation.html"><a href="translation.html#unknown-symbols"><i class="fa fa-check"></i><b>20.3.5</b> Unknown symbols</a></li>
<li class="chapter" data-level="20.3.6" data-path="translation.html"><a href="translation.html#known-functions"><i class="fa fa-check"></i><b>20.3.6</b> Known functions</a></li>
<li class="chapter" data-level="20.3.7" data-path="translation.html"><a href="translation.html#unknown-functions"><i class="fa fa-check"></i><b>20.3.7</b> Unknown functions</a></li>
<li class="chapter" data-level="20.3.8" data-path="translation.html"><a href="translation.html#exercises-65"><i class="fa fa-check"></i><b>20.3.8</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>V Techniques</b></span></li>
<li class="chapter" data-level="21" data-path="debugging.html"><a href="debugging.html"><i class="fa fa-check"></i><b>21</b> Debugging</a><ul>
<li class="chapter" data-level="21.1" data-path="debugging.html"><a href="debugging.html#introduction-19"><i class="fa fa-check"></i><b>21.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="debugging.html"><a href="debugging.html#outline-17"><i class="fa fa-check"></i>Outline</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="debugging.html"><a href="debugging.html#debugging-techniques"><i class="fa fa-check"></i><b>21.2</b> Techniques</a></li>
<li class="chapter" data-level="21.3" data-path="debugging.html"><a href="debugging.html#debugging-tools"><i class="fa fa-check"></i><b>21.3</b> Tools</a><ul>
<li class="chapter" data-level="21.3.1" data-path="debugging.html"><a href="debugging.html#determining-the-sequence-of-calls"><i class="fa fa-check"></i><b>21.3.1</b> Determining the sequence of calls</a></li>
<li class="chapter" data-level="21.3.2" data-path="debugging.html"><a href="debugging.html#browsing-on-error"><i class="fa fa-check"></i><b>21.3.2</b> Browsing on error</a></li>
<li class="chapter" data-level="21.3.3" data-path="debugging.html"><a href="debugging.html#browsing-arbitrary-code"><i class="fa fa-check"></i><b>21.3.3</b> Browsing arbitrary code</a></li>
<li class="chapter" data-level="21.3.4" data-path="debugging.html"><a href="debugging.html#the-call-stack-traceback-where-and-recover"><i class="fa fa-check"></i><b>21.3.4</b> The call stack: <code>traceback()</code>, <code>where</code>, and <code>recover()</code></a></li>
<li class="chapter" data-level="21.3.5" data-path="debugging.html"><a href="debugging.html#other-types-of-failure"><i class="fa fa-check"></i><b>21.3.5</b> Other types of failure</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="performance.html"><a href="performance.html"><i class="fa fa-check"></i><b>22</b> Performance</a><ul>
<li class="chapter" data-level="22.1" data-path="performance.html"><a href="performance.html#why-is-r-slow"><i class="fa fa-check"></i><b>22.1</b> Why is R slow?</a></li>
<li class="chapter" data-level="22.2" data-path="performance.html"><a href="performance.html#microbenchmarking"><i class="fa fa-check"></i><b>22.2</b> Microbenchmarking</a><ul>
<li class="chapter" data-level="22.2.1" data-path="performance.html"><a href="performance.html#exercises-66"><i class="fa fa-check"></i><b>22.2.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="performance.html"><a href="performance.html#language-performance"><i class="fa fa-check"></i><b>22.3</b> Language performance</a><ul>
<li class="chapter" data-level="22.3.1" data-path="performance.html"><a href="performance.html#extreme-dynamism"><i class="fa fa-check"></i><b>22.3.1</b> Extreme dynamism</a></li>
<li class="chapter" data-level="22.3.2" data-path="performance.html"><a href="performance.html#name-lookup-with-mutable-environments"><i class="fa fa-check"></i><b>22.3.2</b> Name lookup with mutable environments</a></li>
<li class="chapter" data-level="22.3.3" data-path="performance.html"><a href="performance.html#lazy-evaluation-overhead"><i class="fa fa-check"></i><b>22.3.3</b> Lazy evaluation overhead</a></li>
<li class="chapter" data-level="22.3.4" data-path="performance.html"><a href="performance.html#exercises-67"><i class="fa fa-check"></i><b>22.3.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="performance.html"><a href="performance.html#implementation-performance"><i class="fa fa-check"></i><b>22.4</b> Implementation performance</a><ul>
<li class="chapter" data-level="22.4.1" data-path="performance.html"><a href="performance.html#extracting-a-single-value-from-a-data-frame"><i class="fa fa-check"></i><b>22.4.1</b> Extracting a single value from a data frame</a></li>
<li class="chapter" data-level="22.4.2" data-path="performance.html"><a href="performance.html#ifelse-pmin-and-pmax"><i class="fa fa-check"></i><b>22.4.2</b> <code>ifelse()</code>, <code>pmin()</code>, and <code>pmax()</code></a></li>
<li class="chapter" data-level="22.4.3" data-path="performance.html"><a href="performance.html#exercises-68"><i class="fa fa-check"></i><b>22.4.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="performance.html"><a href="performance.html#faster-r"><i class="fa fa-check"></i><b>22.5</b> Alternative R implementations</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="profiling.html"><a href="profiling.html"><i class="fa fa-check"></i><b>23</b> Optimising code</a><ul>
<li class="chapter" data-level="23.1" data-path="profiling.html"><a href="profiling.html#introduction-20"><i class="fa fa-check"></i><b>23.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="profiling.html"><a href="profiling.html#outline-18"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="profiling.html"><a href="profiling.html#prerequisites-12"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="23.2" data-path="profiling.html"><a href="profiling.html#measure-perf"><i class="fa fa-check"></i><b>23.2</b> Measuring performance</a><ul>
<li class="chapter" data-level="23.2.1" data-path="profiling.html"><a href="profiling.html#limitations"><i class="fa fa-check"></i><b>23.2.1</b> Limitations</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="profiling.html"><a href="profiling.html#memory-profiling"><i class="fa fa-check"></i><b>23.3</b> Memory profiling with lineprof</a><ul>
<li class="chapter" data-level="23.3.1" data-path="profiling.html"><a href="profiling.html#exercises-69"><i class="fa fa-check"></i><b>23.3.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="profiling.html"><a href="profiling.html#improve-perf"><i class="fa fa-check"></i><b>23.4</b> Improving performance</a></li>
<li class="chapter" data-level="23.5" data-path="profiling.html"><a href="profiling.html#code-organisation"><i class="fa fa-check"></i><b>23.5</b> Code organisation</a></li>
<li class="chapter" data-level="23.6" data-path="profiling.html"><a href="profiling.html#already-solved"><i class="fa fa-check"></i><b>23.6</b> Has someone already solved the problem?</a><ul>
<li class="chapter" data-level="23.6.1" data-path="profiling.html"><a href="profiling.html#exercises-70"><i class="fa fa-check"></i><b>23.6.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="23.7" data-path="profiling.html"><a href="profiling.html#be-lazy"><i class="fa fa-check"></i><b>23.7</b> Do as little as possible</a><ul>
<li class="chapter" data-level="23.7.1" data-path="profiling.html"><a href="profiling.html#exercises-71"><i class="fa fa-check"></i><b>23.7.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="23.8" data-path="profiling.html"><a href="profiling.html#vectorise"><i class="fa fa-check"></i><b>23.8</b> Vectorise</a><ul>
<li class="chapter" data-level="23.8.1" data-path="profiling.html"><a href="profiling.html#exercises-72"><i class="fa fa-check"></i><b>23.8.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="23.9" data-path="profiling.html"><a href="profiling.html#avoid-copies"><i class="fa fa-check"></i><b>23.9</b> Avoid copies</a></li>
<li class="chapter" data-level="23.10" data-path="profiling.html"><a href="profiling.html#byte-code"><i class="fa fa-check"></i><b>23.10</b> Byte code compilation</a></li>
<li class="chapter" data-level="23.11" data-path="profiling.html"><a href="profiling.html#t-test"><i class="fa fa-check"></i><b>23.11</b> Case study: t-test</a></li>
<li class="chapter" data-level="23.12" data-path="profiling.html"><a href="profiling.html#parallelise"><i class="fa fa-check"></i><b>23.12</b> Parallelise</a></li>
<li class="chapter" data-level="23.13" data-path="profiling.html"><a href="profiling.html#more-techniques"><i class="fa fa-check"></i><b>23.13</b> Other techniques</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="rcpp.html"><a href="rcpp.html"><i class="fa fa-check"></i><b>24</b> Rewriting R code in C++</a><ul>
<li class="chapter" data-level="24.1" data-path="rcpp.html"><a href="rcpp.html#introduction-21"><i class="fa fa-check"></i><b>24.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="rcpp.html"><a href="rcpp.html#outline-19"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="rcpp.html"><a href="rcpp.html#prerequistes"><i class="fa fa-check"></i>Prerequistes</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="rcpp.html"><a href="rcpp.html#rcpp-intro"><i class="fa fa-check"></i><b>24.2</b> Getting started with C++</a><ul>
<li class="chapter" data-level="24.2.1" data-path="rcpp.html"><a href="rcpp.html#no-inputs-scalar-output"><i class="fa fa-check"></i><b>24.2.1</b> No inputs, scalar output</a></li>
<li class="chapter" data-level="24.2.2" data-path="rcpp.html"><a href="rcpp.html#scalar-input-scalar-output"><i class="fa fa-check"></i><b>24.2.2</b> Scalar input, scalar output</a></li>
<li class="chapter" data-level="24.2.3" data-path="rcpp.html"><a href="rcpp.html#vector-input-scalar-output"><i class="fa fa-check"></i><b>24.2.3</b> Vector input, scalar output</a></li>
<li class="chapter" data-level="24.2.4" data-path="rcpp.html"><a href="rcpp.html#vector-input-vector-output"><i class="fa fa-check"></i><b>24.2.4</b> Vector input, vector output</a></li>
<li class="chapter" data-level="24.2.5" data-path="rcpp.html"><a href="rcpp.html#matrix-input-vector-output"><i class="fa fa-check"></i><b>24.2.5</b> Matrix input, vector output</a></li>
<li class="chapter" data-level="24.2.6" data-path="rcpp.html"><a href="rcpp.html#sourceCpp"><i class="fa fa-check"></i><b>24.2.6</b> Using sourceCpp</a></li>
<li class="chapter" data-level="24.2.7" data-path="rcpp.html"><a href="rcpp.html#exercises-73"><i class="fa fa-check"></i><b>24.2.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="24.3" data-path="rcpp.html"><a href="rcpp.html#rcpp-classes"><i class="fa fa-check"></i><b>24.3</b> Attributes and other classes</a><ul>
<li class="chapter" data-level="24.3.1" data-path="rcpp.html"><a href="rcpp.html#lists-and-data-frames"><i class="fa fa-check"></i><b>24.3.1</b> Lists and data frames</a></li>
<li class="chapter" data-level="24.3.2" data-path="rcpp.html"><a href="rcpp.html#functions-rcpp"><i class="fa fa-check"></i><b>24.3.2</b> Functions</a></li>
<li class="chapter" data-level="24.3.3" data-path="rcpp.html"><a href="rcpp.html#other-types"><i class="fa fa-check"></i><b>24.3.3</b> Other types</a></li>
</ul></li>
<li class="chapter" data-level="24.4" data-path="rcpp.html"><a href="rcpp.html#rcpp-na"><i class="fa fa-check"></i><b>24.4</b> Missing values</a><ul>
<li class="chapter" data-level="24.4.1" data-path="rcpp.html"><a href="rcpp.html#scalars-1"><i class="fa fa-check"></i><b>24.4.1</b> Scalars</a></li>
<li class="chapter" data-level="24.4.2" data-path="rcpp.html"><a href="rcpp.html#strings"><i class="fa fa-check"></i><b>24.4.2</b> Strings</a></li>
<li class="chapter" data-level="24.4.3" data-path="rcpp.html"><a href="rcpp.html#boolean"><i class="fa fa-check"></i><b>24.4.3</b> Boolean</a></li>
<li class="chapter" data-level="24.4.4" data-path="rcpp.html"><a href="rcpp.html#vectors-rcpp"><i class="fa fa-check"></i><b>24.4.4</b> Vectors</a></li>
<li class="chapter" data-level="24.4.5" data-path="rcpp.html"><a href="rcpp.html#exercises-74"><i class="fa fa-check"></i><b>24.4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="24.5" data-path="rcpp.html"><a href="rcpp.html#rcpp-sugar"><i class="fa fa-check"></i><b>24.5</b> Rcpp sugar</a><ul>
<li class="chapter" data-level="24.5.1" data-path="rcpp.html"><a href="rcpp.html#arithmetic-and-logical-operators"><i class="fa fa-check"></i><b>24.5.1</b> Arithmetic and logical operators</a></li>
<li class="chapter" data-level="24.5.2" data-path="rcpp.html"><a href="rcpp.html#logical-summary-functions"><i class="fa fa-check"></i><b>24.5.2</b> Logical summary functions</a></li>
<li class="chapter" data-level="24.5.3" data-path="rcpp.html"><a href="rcpp.html#vector-views"><i class="fa fa-check"></i><b>24.5.3</b> Vector views</a></li>
<li class="chapter" data-level="24.5.4" data-path="rcpp.html"><a href="rcpp.html#other-useful-functions"><i class="fa fa-check"></i><b>24.5.4</b> Other useful functions</a></li>
</ul></li>
<li class="chapter" data-level="24.6" data-path="rcpp.html"><a href="rcpp.html#stl"><i class="fa fa-check"></i><b>24.6</b> The STL</a><ul>
<li class="chapter" data-level="24.6.1" data-path="rcpp.html"><a href="rcpp.html#using-iterators"><i class="fa fa-check"></i><b>24.6.1</b> Using iterators</a></li>
<li class="chapter" data-level="24.6.2" data-path="rcpp.html"><a href="rcpp.html#algorithms"><i class="fa fa-check"></i><b>24.6.2</b> Algorithms</a></li>
<li class="chapter" data-level="24.6.3" data-path="rcpp.html"><a href="rcpp.html#data-structures-rcpp"><i class="fa fa-check"></i><b>24.6.3</b> Data structures</a></li>
<li class="chapter" data-level="24.6.4" data-path="rcpp.html"><a href="rcpp.html#vectors-stl"><i class="fa fa-check"></i><b>24.6.4</b> Vectors</a></li>
<li class="chapter" data-level="24.6.5" data-path="rcpp.html"><a href="rcpp.html#sets"><i class="fa fa-check"></i><b>24.6.5</b> Sets</a></li>
<li class="chapter" data-level="24.6.6" data-path="rcpp.html"><a href="rcpp.html#map-1"><i class="fa fa-check"></i><b>24.6.6</b> Map</a></li>
<li class="chapter" data-level="24.6.7" data-path="rcpp.html"><a href="rcpp.html#exercises-75"><i class="fa fa-check"></i><b>24.6.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="24.7" data-path="rcpp.html"><a href="rcpp.html#rcpp-case-studies"><i class="fa fa-check"></i><b>24.7</b> Case studies</a><ul>
<li class="chapter" data-level="24.7.1" data-path="rcpp.html"><a href="rcpp.html#gibbs-sampler"><i class="fa fa-check"></i><b>24.7.1</b> Gibbs sampler</a></li>
<li class="chapter" data-level="24.7.2" data-path="rcpp.html"><a href="rcpp.html#r-vectorisation-vs.c-vectorisation"><i class="fa fa-check"></i><b>24.7.2</b> R vectorisation vs. C++ vectorisation</a></li>
</ul></li>
<li class="chapter" data-level="24.8" data-path="rcpp.html"><a href="rcpp.html#rcpp-package"><i class="fa fa-check"></i><b>24.8</b> Using Rcpp in a package</a></li>
<li class="chapter" data-level="24.9" data-path="rcpp.html"><a href="rcpp.html#rcpp-more"><i class="fa fa-check"></i><b>24.9</b> Learning more</a></li>
<li class="chapter" data-level="24.10" data-path="rcpp.html"><a href="rcpp.html#acknowledgments"><i class="fa fa-check"></i><b>24.10</b> Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown">
Proudly published with bookdown</a></li>
<li><a href="https://github.com/hadley/adv-r">Forked from Hadley</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Advanced R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="s4" class="section level1">
<h1><span class="header-section-number">15</span> S4</h1>
<div id="introduction-13" class="section level2">
<h2><span class="header-section-number">15.1</span> Introduction</h2>
<p>S4 provides a formal approach to functional OOP. The underlying ideas are similar to S3 (the topic of Chapter <a href="s3.html#s3">13</a>), but implementation is much stricter and makes use of specialised functions for creating classes (<code>setClass()</code>), generics (<code>setGeneric()</code>), and methods (<code>setMethod()</code>). Additionally, S4 provides both multiple inheritance (i.e. a class can have multiple parents) and multiple dispatch (i.e. method dispatch can use the class of multiple arguments).</p>
<p>An important new component in S4 the <strong>slot</strong>, a named component of the object that is accessed using the specialised subsetting operator <code>@</code> (pronounced at). The set of slots, and their classes, forms an important part of the definition of an S4 class.</p>
<p>Like the other OO chapters, the focus here will be on S4 works, not how to deploy it most effectively.</p>
<div id="learning-more" class="section level3 unnumbered">
<h3>Learning more</h3>
<p>There are two main challenges when learning S4:</p>
<ul>
<li><p>There is no one single S4 reference that will answer all your questions.</p></li>
<li><p>The built-in documentation sometimes clashes with community best practices.</p></li>
</ul>
<p>As you move towards more advanced usage, you will need to piece together needed information by carefully reading the documentation, asking questions on StackOverflow, and performing experiments. Some good places to start are:</p>
<ul>
<li><p>The Bioconductor community is a long-term user and have produced much of
best material about effect use of S4. Start with <a href="https://bioconductor.org/help/course-materials/2017/Zurich/S4-classes-and-methods.html">S4 classes and
methods</a> (2017) taught by Martin Morgan and Hervé Pagès,
checking for newer editions at <a href="https://bioconductor.org/help/course-materials/">Bioconductor course materials</a>.</p>
<p>Martin Morgan, an R-core and Bioconductor-core developer, and a world
expert in practical use of S4. I strongly recommend reading the questions
about S4 that he has answered on <a href="http://stackoverflow.com/search?tab=votes&amp;q=user%3a547331%20%5bs4%5d%20is%3aanswe">stackoverflow</a>.</p></li>
<li><p>John Chambers is the author of the S4 system, and provides an overview<br />
of its motivation and historical context in “Object-oriented programming,
functional programming and R” <span class="citation">(Chambers <a href="#ref-chambers-2014">2014</a>)</span>. For a fuller exploration
of S4, see his book “Software for Data Analysis” <span class="citation">(Chambers <a href="#ref-s4da">2008</a>)</span>.</p></li>
</ul>
</div>
<div id="outline-11" class="section level3 unnumbered">
<h3>Outline</h3>
<ul>
<li><p>Section <a href="s4.html#s4-basics">15.2</a> gives a rapid tour of the main components of S4:
classes, generics, and methods.</p></li>
<li><p>Section <a href="s4.html#s4-classes">15.3</a> dives into the details of S4 classes. You’ll
learn about the important helper function that should accompany most
S4 classes, and how to set up a validator where needed.</p></li>
<li><p>Section <a href="s4.html#s4-generics">15.4</a> shows you how to create new S4 generics, and
how to supply those generics with methods. You’ll also learn about
accessor functions which are designed to allow users to safely get and set
object slots.</p></li>
<li><p>Section <a href="s4.html#s4-dispatch">15.5</a> dives into the full details of method dispatch
in S4. This gets quite complicated with the combination of multiple
inheritance and multiple dispatch.</p></li>
<li><p>Section <a href="s4.html#s4-s3">15.6</a> discusses the interaction between S4 and S3, showing
you how to use them together.</p></li>
</ul>
</div>
<div id="prerequisites-8" class="section level3 unnumbered">
<h3>Prerequisites</h3>
<p>All functions related to S4 live in the methods package. This package is always available when you’re running R interactively, but may not be available when running R in batch mode (i.e. from <code>Rrcript</code>). For this reason, it’s a good idea to call <code>library(methods)</code> whenever you use S4. This also signals to the reader that you’ll be using the S4 object system.</p>
<div class="sourceCode" id="cb589"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb589-1" data-line-number="1"><span class="kw">library</span>(methods)</a></code></pre></div>
</div>
</div>
<div id="s4-basics" class="section level2">
<h2><span class="header-section-number">15.2</span> Basics</h2>
<p>We’ll start with a quick overview of the main components of S4 and then dive into the details below. You define a S4 class by calling <code>setClass()</code> with the class name and a definition of its slots, the names and classes of the class data.</p>
<div class="sourceCode" id="cb590"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb590-1" data-line-number="1"><span class="kw">setClass</span>(<span class="st">&quot;Person&quot;</span>, </a>
<a class="sourceLine" id="cb590-2" data-line-number="2">  <span class="dt">slots =</span> <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb590-3" data-line-number="3">    <span class="dt">name =</span> <span class="st">&quot;character&quot;</span>, </a>
<a class="sourceLine" id="cb590-4" data-line-number="4">    <span class="dt">age =</span> <span class="st">&quot;numeric&quot;</span></a>
<a class="sourceLine" id="cb590-5" data-line-number="5">  )</a>
<a class="sourceLine" id="cb590-6" data-line-number="6">)</a></code></pre></div>
<p>Can construct new objects from a class by calling <code>new()</code> and providing values for the slots:</p>
<div class="sourceCode" id="cb591"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb591-1" data-line-number="1">john &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">&quot;Person&quot;</span>, <span class="dt">name =</span> <span class="st">&quot;John Smith&quot;</span>, <span class="dt">age =</span> <span class="ot">NA_real_</span>)</a></code></pre></div>
<p>Access the slot values with <code>@</code> (equivalent to <code>$</code>) or <code>slot()</code> (equivalent to <code>[[</code>):</p>
<div class="sourceCode" id="cb592"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb592-1" data-line-number="1">john<span class="op">@</span>name</a>
<a class="sourceLine" id="cb592-2" data-line-number="2"><span class="co">#&gt; [1] &quot;John Smith&quot;</span></a>
<a class="sourceLine" id="cb592-3" data-line-number="3"><span class="kw">slot</span>(john, <span class="st">&quot;age&quot;</span>)</a>
<a class="sourceLine" id="cb592-4" data-line-number="4"><span class="co">#&gt; [1] NA</span></a></code></pre></div>
<p>Generally, you should only use <code>@</code> in methods. If you’re working for with someone elses class, look for <strong>accessor</strong> functions that allow you to safely set and get slot values. As the developer of a class, you should also provide your own accessor functions. Accessors are typically S4 generics allowing multiple classes to have the same external interface.</p>
<p>Here we’ll create a set and getter for the <code>age</code> slot by firsting creating generics with <code>setGeneric()</code>:</p>
<div class="sourceCode" id="cb593"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb593-1" data-line-number="1"><span class="kw">setGeneric</span>(<span class="st">&quot;age&quot;</span>, <span class="cf">function</span>(x) <span class="kw">standardGeneric</span>(<span class="st">&quot;age&quot;</span>))</a>
<a class="sourceLine" id="cb593-2" data-line-number="2"><span class="kw">setGeneric</span>(<span class="st">&quot;age&lt;-&quot;</span>, <span class="cf">function</span>(x, value) <span class="kw">standardGeneric</span>(<span class="st">&quot;age&lt;-&quot;</span>))</a></code></pre></div>
<p>And then defining methods with <code>setMethod()</code>:</p>
<div class="sourceCode" id="cb594"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb594-1" data-line-number="1"><span class="kw">setMethod</span>(<span class="st">&quot;age&quot;</span>, <span class="st">&quot;Person&quot;</span>, <span class="cf">function</span>(x) x<span class="op">@</span>age)</a>
<a class="sourceLine" id="cb594-2" data-line-number="2"><span class="kw">setMethod</span>(<span class="st">&quot;age&lt;-&quot;</span>, <span class="st">&quot;Person&quot;</span>, <span class="cf">function</span>(x, value) {</a>
<a class="sourceLine" id="cb594-3" data-line-number="3">  <span class="kw">stop</span>(<span class="st">&quot;`@age` is readonly&quot;</span>, <span class="dt">call. =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb594-4" data-line-number="4">})</a></code></pre></div>
<div class="sourceCode" id="cb595"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb595-1" data-line-number="1"><span class="kw">age</span>(john)</a>
<a class="sourceLine" id="cb595-2" data-line-number="2"><span class="co">#&gt; [1] NA</span></a>
<a class="sourceLine" id="cb595-3" data-line-number="3"><span class="kw">age</span>(john) &lt;-<span class="st"> </span><span class="dv">50</span></a>
<a class="sourceLine" id="cb595-4" data-line-number="4"><span class="co">#&gt; Error: `@age` is readonly</span></a></code></pre></div>
<p>If you’re using an S4 class defined in a package, you can get help on it with <code>class?Person</code>. To get help for a method, put <code>?</code> in front of a call: <code>?age(john)</code>. <code>?</code> will use the class of the arguments to figure out which help file you need.</p>
<p>Use sloop functions to identify S4 objects and generics found in the wild:</p>
<div class="sourceCode" id="cb596"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb596-1" data-line-number="1">sloop<span class="op">::</span><span class="kw">otype</span>(john)</a>
<a class="sourceLine" id="cb596-2" data-line-number="2"><span class="co">#&gt; [1] &quot;S4&quot;</span></a>
<a class="sourceLine" id="cb596-3" data-line-number="3">sloop<span class="op">::</span><span class="kw">ftype</span>(age)</a>
<a class="sourceLine" id="cb596-4" data-line-number="4"><span class="co">#&gt; [1] &quot;S4&quot;      &quot;generic&quot;</span></a></code></pre></div>
<div id="exercises-45" class="section level3">
<h3><span class="header-section-number">15.2.1</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li><p><code>lubridate::period()</code> returns an S4 class. What slots does it have?
What class is each slot? What accessors does it provide?</p></li>
<li><p>What other ways can you find help for a method? Read <code>?&quot;?&quot;</code> and
summarise the details.</p></li>
</ol>
</div>
</div>
<div id="s4-classes" class="section level2">
<h2><span class="header-section-number">15.3</span> Classes</h2>
<p></p>
<p>To define an S4 class, call <code>setClass()</code> with three arguments:</p>
<ul>
<li><p>The class <strong>name</strong>. By convention, S4 class names use UpperCamelCase.</p></li>
<li><p>A named character vector that describes the names and classes of the
<strong>slots</strong> (fields). For example, a person might be represented by a character
name and a numeric age: <code>c(name = &quot;character&quot;, age = &quot;numeric&quot;)</code>. The
pseudo-class “ANY” allows a slot to accept objects of any type.</p></li>
<li><p>A <strong>prototype</strong>, a list of default values for each slot. Technically,
the prototype is optional[^prototype-docs], but it’s strongly recommended as
it makes use of the class much easier.</p></li>
</ul>
<p>The code below illustrates the three arguments by creating a <code>Person</code> class with character <code>name</code> and numeric <code>age</code> slots.</p>
<div class="sourceCode" id="cb597"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb597-1" data-line-number="1"><span class="kw">setClass</span>(<span class="st">&quot;Person&quot;</span>, </a>
<a class="sourceLine" id="cb597-2" data-line-number="2">  <span class="dt">slots =</span> <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb597-3" data-line-number="3">    <span class="dt">name =</span> <span class="st">&quot;character&quot;</span>, </a>
<a class="sourceLine" id="cb597-4" data-line-number="4">    <span class="dt">age =</span> <span class="st">&quot;numeric&quot;</span></a>
<a class="sourceLine" id="cb597-5" data-line-number="5">  ), </a>
<a class="sourceLine" id="cb597-6" data-line-number="6">  <span class="dt">prototype =</span> <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb597-7" data-line-number="7">    <span class="dt">name =</span> <span class="ot">NA_character_</span>,</a>
<a class="sourceLine" id="cb597-8" data-line-number="8">    <span class="dt">age =</span> <span class="ot">NA_real_</span></a>
<a class="sourceLine" id="cb597-9" data-line-number="9">  )</a>
<a class="sourceLine" id="cb597-10" data-line-number="10">)</a>
<a class="sourceLine" id="cb597-11" data-line-number="11"></a>
<a class="sourceLine" id="cb597-12" data-line-number="12">me &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">&quot;Person&quot;</span>, <span class="dt">name =</span> <span class="st">&quot;Hadley&quot;</span>)</a>
<a class="sourceLine" id="cb597-13" data-line-number="13">me</a>
<a class="sourceLine" id="cb597-14" data-line-number="14"><span class="co">#&gt; An object of class &quot;Person&quot;</span></a>
<a class="sourceLine" id="cb597-15" data-line-number="15"><span class="co">#&gt; Slot &quot;name&quot;:</span></a>
<a class="sourceLine" id="cb597-16" data-line-number="16"><span class="co">#&gt; [1] &quot;Hadley&quot;</span></a>
<a class="sourceLine" id="cb597-17" data-line-number="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb597-18" data-line-number="18"><span class="co">#&gt; Slot &quot;age&quot;:</span></a>
<a class="sourceLine" id="cb597-19" data-line-number="19"><span class="co">#&gt; [1] NA</span></a></code></pre></div>
<div id="inheritance-1" class="section level3">
<h3><span class="header-section-number">15.3.1</span> Inheritance</h3>
<p>There is one other important argument to <code>setClass()</code>: <code>contains</code>. This defines a class (or classes) to inherit behaviour from. For example, we can create an <code>Employee</code> class that inherits slots and behaviour from the <code>Person</code> class, but additionally contains a slot that desribes their boss.</p>
<div class="sourceCode" id="cb598"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb598-1" data-line-number="1"><span class="kw">setClass</span>(<span class="st">&quot;Employee&quot;</span>, </a>
<a class="sourceLine" id="cb598-2" data-line-number="2">  <span class="dt">contains =</span> <span class="st">&quot;Person&quot;</span>, </a>
<a class="sourceLine" id="cb598-3" data-line-number="3">  <span class="dt">slots =</span> <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb598-4" data-line-number="4">    <span class="dt">boss =</span> <span class="st">&quot;Person&quot;</span></a>
<a class="sourceLine" id="cb598-5" data-line-number="5">  ),</a>
<a class="sourceLine" id="cb598-6" data-line-number="6">  <span class="dt">prototype =</span> <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb598-7" data-line-number="7">    <span class="dt">boss =</span> <span class="kw">new</span>(<span class="st">&quot;Person&quot;</span>)</a>
<a class="sourceLine" id="cb598-8" data-line-number="8">  )</a>
<a class="sourceLine" id="cb598-9" data-line-number="9">)</a>
<a class="sourceLine" id="cb598-10" data-line-number="10"></a>
<a class="sourceLine" id="cb598-11" data-line-number="11"><span class="kw">new</span>(<span class="st">&quot;Employee&quot;</span>)</a>
<a class="sourceLine" id="cb598-12" data-line-number="12"><span class="co">#&gt; An object of class &quot;Employee&quot;</span></a>
<a class="sourceLine" id="cb598-13" data-line-number="13"><span class="co">#&gt; Slot &quot;boss&quot;:</span></a>
<a class="sourceLine" id="cb598-14" data-line-number="14"><span class="co">#&gt; An object of class &quot;Person&quot;</span></a>
<a class="sourceLine" id="cb598-15" data-line-number="15"><span class="co">#&gt; Slot &quot;name&quot;:</span></a>
<a class="sourceLine" id="cb598-16" data-line-number="16"><span class="co">#&gt; [1] NA</span></a>
<a class="sourceLine" id="cb598-17" data-line-number="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb598-18" data-line-number="18"><span class="co">#&gt; Slot &quot;age&quot;:</span></a>
<a class="sourceLine" id="cb598-19" data-line-number="19"><span class="co">#&gt; [1] NA</span></a>
<a class="sourceLine" id="cb598-20" data-line-number="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb598-21" data-line-number="21"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb598-22" data-line-number="22"><span class="co">#&gt; Slot &quot;name&quot;:</span></a>
<a class="sourceLine" id="cb598-23" data-line-number="23"><span class="co">#&gt; [1] NA</span></a>
<a class="sourceLine" id="cb598-24" data-line-number="24"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb598-25" data-line-number="25"><span class="co">#&gt; Slot &quot;age&quot;:</span></a>
<a class="sourceLine" id="cb598-26" data-line-number="26"><span class="co">#&gt; [1] NA</span></a></code></pre></div>
<p><code>setClass()</code> has 9 other arguments but they are either deprecated or not recommended. If you have existing S4 code that uses them, I’d recommend carefully reading the documentation and upgrading to modern practice.</p>
</div>
<div id="redefinition" class="section level3">
<h3><span class="header-section-number">15.3.2</span> Redefinition</h3>
<p>In most programming languages, class definition occurs at compile-time and object construction occurs later, at run-time. In R, however, both definition and construction occur at run time. When you call <code>setClass()</code>, you are registering a class definition in a (hidden) global variable. As with all state-modifying functions you need to use <code>setClass()</code> with care. It’s possible to create invalid objects if you redefine a class after already having instantiated an object:</p>
<div class="sourceCode" id="cb599"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb599-1" data-line-number="1"><span class="kw">setClass</span>(<span class="st">&quot;A&quot;</span>, <span class="dt">slots =</span> <span class="kw">c</span>(<span class="dt">x =</span> <span class="st">&quot;numeric&quot;</span>))</a>
<a class="sourceLine" id="cb599-2" data-line-number="2">a &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">&quot;A&quot;</span>, <span class="dt">x =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb599-3" data-line-number="3"></a>
<a class="sourceLine" id="cb599-4" data-line-number="4"><span class="kw">setClass</span>(<span class="st">&quot;A&quot;</span>, <span class="dt">slots =</span> <span class="kw">c</span>(<span class="dt">a_different_slot =</span> <span class="st">&quot;numeric&quot;</span>))</a>
<a class="sourceLine" id="cb599-5" data-line-number="5">a</a>
<a class="sourceLine" id="cb599-6" data-line-number="6"><span class="co">#&gt; An object of class &quot;A&quot;</span></a>
<a class="sourceLine" id="cb599-7" data-line-number="7"><span class="co">#&gt; Slot &quot;a_different_slot&quot;:</span></a>
<a class="sourceLine" id="cb599-8" data-line-number="8"><span class="co">#&gt; Error in slot(object, what):</span></a>
<a class="sourceLine" id="cb599-9" data-line-number="9"><span class="co">#&gt;   no slot of name &quot;a_different_slot&quot; for this object of class &quot;A&quot;</span></a></code></pre></div>
<p>This can cause confusion during interactive creation of new classes.</p>
</div>
<div id="helper" class="section level3">
<h3><span class="header-section-number">15.3.3</span> Helper</h3>
<p><code>new()</code> is a low-level constructor suitable for use by you, the developer. User-facing classes should always be paired with a user-friendly helper. A helper should always:</p>
<ul>
<li><p>Have the same name as the class, e.g. <code>myclass()</code>.</p></li>
<li><p>Have a thoughtfully crafted user interface with carefully chosen default
values and useful conversions.</p></li>
<li><p>Create carefully crafted error messages tailored towards an end-user.</p></li>
<li><p>Finish by calling by calling <code>methods::new()</code></p></li>
</ul>
<p>The <code>Person</code> class is so simple so a helper is almost superfluous, but we can use it to clearly define the contract: <code>age</code> is optional but <code>name</code> is required.</p>
<div class="sourceCode" id="cb600"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb600-1" data-line-number="1">Person &lt;-<span class="st"> </span><span class="cf">function</span>(name, <span class="dt">age =</span> <span class="ot">NA</span>) {</a>
<a class="sourceLine" id="cb600-2" data-line-number="2">  age &lt;-<span class="st"> </span><span class="kw">as.double</span>(age)</a>
<a class="sourceLine" id="cb600-3" data-line-number="3">  </a>
<a class="sourceLine" id="cb600-4" data-line-number="4">  <span class="kw">new</span>(<span class="st">&quot;Person&quot;</span>, <span class="dt">name =</span> name, <span class="dt">age =</span> age)</a>
<a class="sourceLine" id="cb600-5" data-line-number="5">}</a>
<a class="sourceLine" id="cb600-6" data-line-number="6"></a>
<a class="sourceLine" id="cb600-7" data-line-number="7"><span class="kw">Person</span>(<span class="st">&quot;Hadley&quot;</span>)</a>
<a class="sourceLine" id="cb600-8" data-line-number="8"><span class="co">#&gt; An object of class &quot;Person&quot;</span></a>
<a class="sourceLine" id="cb600-9" data-line-number="9"><span class="co">#&gt; Slot &quot;name&quot;:</span></a>
<a class="sourceLine" id="cb600-10" data-line-number="10"><span class="co">#&gt; [1] &quot;Hadley&quot;</span></a>
<a class="sourceLine" id="cb600-11" data-line-number="11"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb600-12" data-line-number="12"><span class="co">#&gt; Slot &quot;age&quot;:</span></a>
<a class="sourceLine" id="cb600-13" data-line-number="13"><span class="co">#&gt; [1] NA</span></a></code></pre></div>
</div>
<div id="validator" class="section level3">
<h3><span class="header-section-number">15.3.4</span> Validator</h3>
<p>The constructor automatically checks that the slots have correct classes:</p>
<div class="sourceCode" id="cb601"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb601-1" data-line-number="1"><span class="kw">Person</span>(mtcars)</a>
<a class="sourceLine" id="cb601-2" data-line-number="2"><span class="co">#&gt; Error in validObject(.Object):</span></a>
<a class="sourceLine" id="cb601-3" data-line-number="3"><span class="co">#&gt;   Error in validObject(.Object): invalid class &quot;Person&quot; object: invalid</span></a>
<a class="sourceLine" id="cb601-4" data-line-number="4"><span class="co">#&gt;   object for slot &quot;name&quot; in class &quot;Person&quot;: got class &quot;data.frame&quot;, should</span></a>
<a class="sourceLine" id="cb601-5" data-line-number="5"><span class="co">#&gt;   be or extend class &quot;character&quot;</span></a></code></pre></div>
<p>But you will need to implement more complicated checks (i.e. checks that involve lengths, or multiple slots) yourself. For example, we might want to make it clear that the Person class is a vector class, and can store data about multiple people. That’s not currently clear because <code>@name</code> and <code>@age</code> can be different lengths:</p>
<div class="sourceCode" id="cb602"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb602-1" data-line-number="1"><span class="kw">Person</span>(<span class="st">&quot;Hadley&quot;</span>, <span class="dt">age =</span> <span class="kw">c</span>(<span class="dv">30</span>, <span class="dv">37</span>))</a>
<a class="sourceLine" id="cb602-2" data-line-number="2"><span class="co">#&gt; An object of class &quot;Person&quot;</span></a>
<a class="sourceLine" id="cb602-3" data-line-number="3"><span class="co">#&gt; Slot &quot;name&quot;:</span></a>
<a class="sourceLine" id="cb602-4" data-line-number="4"><span class="co">#&gt; [1] &quot;Hadley&quot;</span></a>
<a class="sourceLine" id="cb602-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb602-6" data-line-number="6"><span class="co">#&gt; Slot &quot;age&quot;:</span></a>
<a class="sourceLine" id="cb602-7" data-line-number="7"><span class="co">#&gt; [1] 30 37</span></a></code></pre></div>
<p>To enforce these additional constraints we write a validator with <code>setValidity()</code>. It takes class and a function that returns <code>TRUE</code> if the input is valid, and otherwise returns a character vector describing the problem(s):</p>
<div class="sourceCode" id="cb603"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb603-1" data-line-number="1"><span class="kw">setValidity</span>(<span class="st">&quot;Person&quot;</span>, <span class="cf">function</span>(object) {</a>
<a class="sourceLine" id="cb603-2" data-line-number="2">  <span class="cf">if</span> (<span class="kw">length</span>(object<span class="op">@</span>name) <span class="op">!=</span><span class="st"> </span><span class="kw">length</span>(object<span class="op">@</span>age)) {</a>
<a class="sourceLine" id="cb603-3" data-line-number="3">    <span class="st">&quot;@name and @age must be same length&quot;</span></a>
<a class="sourceLine" id="cb603-4" data-line-number="4">  } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb603-5" data-line-number="5">    <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb603-6" data-line-number="6">  }</a>
<a class="sourceLine" id="cb603-7" data-line-number="7">})</a></code></pre></div>
<p>Now we can no longer create an invalid object:</p>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb604-1" data-line-number="1"><span class="kw">Person</span>(<span class="st">&quot;Hadley&quot;</span>, <span class="dt">age =</span> <span class="kw">c</span>(<span class="dv">30</span>, <span class="dv">37</span>))</a>
<a class="sourceLine" id="cb604-2" data-line-number="2"><span class="co">#&gt; Error in validObject(.Object):</span></a>
<a class="sourceLine" id="cb604-3" data-line-number="3"><span class="co">#&gt;   invalid class &quot;Person&quot; object: @name and @age must be same length</span></a></code></pre></div>
<p>Note that the validity method is only called automatically by <code>new()</code>, so you can still create an invalid object by modifying it:</p>
<div class="sourceCode" id="cb605"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb605-1" data-line-number="1">john &lt;-<span class="st"> </span><span class="kw">Person</span>(<span class="st">&quot;John&quot;</span>, <span class="dt">age =</span> <span class="dv">30</span>)</a>
<a class="sourceLine" id="cb605-2" data-line-number="2">john<span class="op">@</span>age &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span></a></code></pre></div>
<p>You can explicitly check the validity yourself by calling <code>validObject()</code>:</p>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb606-1" data-line-number="1"><span class="kw">validObject</span>(john)</a>
<a class="sourceLine" id="cb606-2" data-line-number="2"><span class="co">#&gt; Error in validObject(john):</span></a>
<a class="sourceLine" id="cb606-3" data-line-number="3"><span class="co">#&gt;   invalid class &quot;Person&quot; object: @name and @age must be same length</span></a></code></pre></div>
<p>In Section <a href="s4.html#accessors">15.4.4</a>, we’ll use <code>validObject()</code> to create accessor functions that always return valid objects.</p>
</div>
<div id="introspection-1" class="section level3">
<h3><span class="header-section-number">15.3.5</span> Introspection</h3>
<p>To determine what classes an object inherits from, use <code>is()</code>:</p>
<div class="sourceCode" id="cb607"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb607-1" data-line-number="1"><span class="kw">is</span>(john)</a>
<a class="sourceLine" id="cb607-2" data-line-number="2"><span class="co">#&gt; [1] &quot;Person&quot;</span></a></code></pre></div>
<p>To test if an object inherits from a specific class, use the second argument of <code>is()</code>:</p>
<div class="sourceCode" id="cb608"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb608-1" data-line-number="1"><span class="kw">is</span>(john, <span class="st">&quot;person&quot;</span>)</a>
<a class="sourceLine" id="cb608-2" data-line-number="2"><span class="co">#&gt; [1] FALSE</span></a></code></pre></div>
</div>
<div id="exercises-46" class="section level3">
<h3><span class="header-section-number">15.3.6</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li><p>Extend the Person class with fields to match <code>utils::person()</code>.
Think about what slots you will need, and what you’ll need to check in
your validity method.</p></li>
<li><p>What happens if you define a new S4 class that doesn’t have any slots?
(Hint: read about virtual classes in <code>?setClass</code>.)</p></li>
<li><p>Imagine you were going to reimplement factors, dates, and, data frames in
S4. Sketch out the <code>setClass()</code> calls that you would use to define the
classes. Think about appropriate <code>slots</code> and <code>prototype</code>.</p></li>
</ol>
</div>
</div>
<div id="s4-generics" class="section level2">
<h2><span class="header-section-number">15.4</span> Generics and methods</h2>
<p>




</p>
<p>The job of a generic is to perform method dispatch, i.e. find the method designed to handle the combination of classes passed to the generic. Here you’ll learn how to define S4 generics and methods, then in the next section we’ll explore precisely how S4 method dispatch works.</p>
<p>S4 generics have a similar structure to S3 generics, but are a little more formal. To create a new S4 generic, you call <code>setGeneric()</code> with a function that calls <code>standardGeneric()</code>.</p>
<div class="sourceCode" id="cb609"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb609-1" data-line-number="1"><span class="kw">setGeneric</span>(<span class="st">&quot;myGeneric&quot;</span>, <span class="cf">function</span>(x) <span class="kw">standardGeneric</span>(<span class="st">&quot;myGeneric&quot;</span>))</a></code></pre></div>
<p>It is bad practice to use <code>{}</code> in the generic as it triggers a special case that is more expensive, and generally best avoided.</p>
<div class="sourceCode" id="cb610"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb610-1" data-line-number="1"><span class="co"># Don&#39;t do this!</span></a>
<a class="sourceLine" id="cb610-2" data-line-number="2"><span class="kw">setGeneric</span>(<span class="st">&quot;myGeneric&quot;</span>, <span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb610-3" data-line-number="3">  <span class="kw">standardGeneric</span>(<span class="st">&quot;myGeneric&quot;</span>)</a>
<a class="sourceLine" id="cb610-4" data-line-number="4">})</a></code></pre></div>
<div id="signature" class="section level3">
<h3><span class="header-section-number">15.4.1</span> Signature</h3>
<p>Like <code>setClass()</code>, <code>setGeneric()</code> has many other arguments. There is only one that you need to know about: <code>signature</code>. This allows you to control the arguments that are used for method dispatch. If <code>signature</code> is not supplied, all arguments (apart from <code>...</code>) are used. It is occassionally useful to remove arguments from dispatch. This allows you to require that methods provide arguments like <code>verbose = TRUE</code> or <code>quiet = FALSE</code>, but they don’t take part in dispatch.</p>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb611-1" data-line-number="1"><span class="kw">setGeneric</span>(<span class="st">&quot;myGeneric&quot;</span>, </a>
<a class="sourceLine" id="cb611-2" data-line-number="2">  <span class="cf">function</span>(x, ..., <span class="dt">verbose =</span> <span class="ot">TRUE</span>) <span class="kw">standardGeneric</span>(<span class="st">&quot;myGeneric&quot;</span>),</a>
<a class="sourceLine" id="cb611-3" data-line-number="3">  <span class="dt">signature =</span> <span class="st">&quot;x&quot;</span></a>
<a class="sourceLine" id="cb611-4" data-line-number="4">)</a></code></pre></div>
</div>
<div id="methods" class="section level3">
<h3><span class="header-section-number">15.4.2</span> Methods</h3>

<p>A generic isn’t useful without some methods, and in S4 you add methods with <code>setMethod()</code>. There are three important arguments: the name of the generic, the name of the class, and the method itself.</p>
<div class="sourceCode" id="cb612"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb612-1" data-line-number="1"><span class="kw">setMethod</span>(<span class="st">&quot;myGeneric&quot;</span>, <span class="st">&quot;Person&quot;</span>, <span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb612-2" data-line-number="2">  <span class="co"># method implementation</span></a>
<a class="sourceLine" id="cb612-3" data-line-number="3">})</a></code></pre></div>
<p>More formally, the second argument to <code>setMethod()</code> is called the <strong>signature</strong>. In S4, unlike S3, the signature can include multiple arguments. This makes method dispatch in S4 substantially more complicated, but avoids having to implement double-dispatch as a special case. We’ll talk more about multiple dispatch in the next section.</p>
<p><code>setMethod()</code> has other arguments, but you should never use them, just like <code>setClass()</code> and <code>setGeneric()</code>.</p>
</div>
<div id="show-method" class="section level3">
<h3><span class="header-section-number">15.4.3</span> Show method</h3>
<p>As with S3, the most commonly defined S4 method controls printing, but in S4 we use a different generic: <code>show()</code>. When defining a method for an existing generic, you need to first determine the arguments. You can get those from the documentation or by looking at the <code>args()</code> of the generic:</p>
<div class="sourceCode" id="cb613"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb613-1" data-line-number="1"><span class="kw">args</span>(<span class="kw">getGeneric</span>(<span class="st">&quot;show&quot;</span>))</a>
<a class="sourceLine" id="cb613-2" data-line-number="2"><span class="co">#&gt; function (object) </span></a>
<a class="sourceLine" id="cb613-3" data-line-number="3"><span class="co">#&gt; NULL</span></a></code></pre></div>
<p>Our show method needs to have a single argument <code>object</code>:</p>
<div class="sourceCode" id="cb614"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb614-1" data-line-number="1"><span class="kw">setMethod</span>(<span class="st">&quot;show&quot;</span>, <span class="st">&quot;Person&quot;</span>, <span class="cf">function</span>(object) {</a>
<a class="sourceLine" id="cb614-2" data-line-number="2">  <span class="kw">cat</span>(<span class="kw">is</span>(object)[[<span class="dv">1</span>]], <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,</a>
<a class="sourceLine" id="cb614-3" data-line-number="3">      <span class="st">&quot;  Name: &quot;</span>, object<span class="op">@</span>name, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,</a>
<a class="sourceLine" id="cb614-4" data-line-number="4">      <span class="st">&quot;  Age:  &quot;</span>, object<span class="op">@</span>age, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>,</a>
<a class="sourceLine" id="cb614-5" data-line-number="5">      <span class="dt">sep =</span> <span class="st">&quot;&quot;</span></a>
<a class="sourceLine" id="cb614-6" data-line-number="6">  )</a>
<a class="sourceLine" id="cb614-7" data-line-number="7">})</a>
<a class="sourceLine" id="cb614-8" data-line-number="8">john</a>
<a class="sourceLine" id="cb614-9" data-line-number="9"><span class="co">#&gt; Person</span></a>
<a class="sourceLine" id="cb614-10" data-line-number="10"><span class="co">#&gt;   Name: John</span></a>
<a class="sourceLine" id="cb614-11" data-line-number="11"><span class="co">#&gt;   Age:  12345678910</span></a></code></pre></div>
</div>
<div id="accessors" class="section level3">
<h3><span class="header-section-number">15.4.4</span> Accessors</h3>
<p>Slots are generally considered to be an internal implementation detail: they can change without warning and user code should avoid accessing them directly. Instead, all user-accessible slots should get an <strong>accessor</strong>. If the slot is unique to the class, this can just be a function:</p>
<div class="sourceCode" id="cb615"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb615-1" data-line-number="1">person_name &lt;-<span class="st"> </span><span class="cf">function</span>(x) x<span class="op">@</span>name</a></code></pre></div>
<p>Typically, however, you’ll define a generic so that multiple classes can use the same interface:</p>
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb616-1" data-line-number="1"><span class="kw">setGeneric</span>(<span class="st">&quot;name&quot;</span>, <span class="cf">function</span>(x) <span class="kw">standardGeneric</span>(<span class="st">&quot;name&quot;</span>))</a>
<a class="sourceLine" id="cb616-2" data-line-number="2"><span class="kw">setMethod</span>(<span class="st">&quot;name&quot;</span>, <span class="st">&quot;Person&quot;</span>, <span class="cf">function</span>(x) x<span class="op">@</span>name)</a>
<a class="sourceLine" id="cb616-3" data-line-number="3"></a>
<a class="sourceLine" id="cb616-4" data-line-number="4"><span class="kw">name</span>(john)</a>
<a class="sourceLine" id="cb616-5" data-line-number="5"><span class="co">#&gt; [1] &quot;John&quot;</span></a></code></pre></div>
<p>If the slot is also writeable, you should provide a setter function. This will be slightly more complicated than the getter because you should always call <code>validObject()</code> to check that the new object is still valid.</p>
<div class="sourceCode" id="cb617"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb617-1" data-line-number="1"><span class="kw">setGeneric</span>(<span class="st">&quot;name&lt;-&quot;</span>, <span class="cf">function</span>(x, value) <span class="kw">standardGeneric</span>(<span class="st">&quot;name&lt;-&quot;</span>))</a>
<a class="sourceLine" id="cb617-2" data-line-number="2"><span class="kw">setMethod</span>(<span class="st">&quot;name&lt;-&quot;</span>, <span class="st">&quot;Person&quot;</span>, <span class="cf">function</span>(x, value) {</a>
<a class="sourceLine" id="cb617-3" data-line-number="3">  x<span class="op">@</span>name &lt;-<span class="st"> </span>value</a>
<a class="sourceLine" id="cb617-4" data-line-number="4">  <span class="kw">validObject</span>(x)</a>
<a class="sourceLine" id="cb617-5" data-line-number="5">  x</a>
<a class="sourceLine" id="cb617-6" data-line-number="6">})</a>
<a class="sourceLine" id="cb617-7" data-line-number="7">  </a>
<a class="sourceLine" id="cb617-8" data-line-number="8"><span class="kw">name</span>(hadley) &lt;-<span class="st"> &quot;Johnathan Smythe&quot;</span></a>
<a class="sourceLine" id="cb617-9" data-line-number="9"><span class="co">#&gt; Error in name(hadley) &lt;- &quot;Johnathan Smythe&quot;:</span></a>
<a class="sourceLine" id="cb617-10" data-line-number="10"><span class="co">#&gt;   object &#39;hadley&#39; not found</span></a>
<a class="sourceLine" id="cb617-11" data-line-number="11"><span class="kw">name</span>(hadley)</a>
<a class="sourceLine" id="cb617-12" data-line-number="12"><span class="co">#&gt; Error in name(hadley):</span></a>
<a class="sourceLine" id="cb617-13" data-line-number="13"><span class="co">#&gt;   object &#39;hadley&#39; not found</span></a></code></pre></div>
<p>(If the <code>name&lt;-</code> notation is unfamiliar, check out Section <a href="functions.html#function-forms">5.8</a>.)</p>
</div>
<div id="introspection-2" class="section level3">
<h3><span class="header-section-number">15.4.5</span> Introspection</h3>
<p>To list all the methods that belong to a generic, or that are associated with a class, use <code>.S4methods()</code>:</p>
<div class="sourceCode" id="cb618"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb618-1" data-line-number="1"><span class="kw">.S4methods</span>(<span class="st">&quot;initialize&quot;</span>)</a>
<a class="sourceLine" id="cb618-2" data-line-number="2"><span class="co">#&gt;  [1] initialize,mts-method              </span></a>
<a class="sourceLine" id="cb618-3" data-line-number="3"><span class="co">#&gt;  [2] initialize,array-method            </span></a>
<a class="sourceLine" id="cb618-4" data-line-number="4"><span class="co">#&gt;  [3] initialize,environment-method      </span></a>
<a class="sourceLine" id="cb618-5" data-line-number="5"><span class="co">#&gt;  [4] initialize,traceable-method        </span></a>
<a class="sourceLine" id="cb618-6" data-line-number="6"><span class="co">#&gt;  [5] initialize,matrix-method           </span></a>
<a class="sourceLine" id="cb618-7" data-line-number="7"><span class="co">#&gt;  [6] initialize,externalRefMethod-method</span></a>
<a class="sourceLine" id="cb618-8" data-line-number="8"><span class="co">#&gt;  [7] initialize,envRefClass-method      </span></a>
<a class="sourceLine" id="cb618-9" data-line-number="9"><span class="co">#&gt;  [8] initialize,MethodsList-method      </span></a>
<a class="sourceLine" id="cb618-10" data-line-number="10"><span class="co">#&gt;  [9] initialize,.environment-method     </span></a>
<a class="sourceLine" id="cb618-11" data-line-number="11"><span class="co">#&gt; [10] initialize,Module-method           </span></a>
<a class="sourceLine" id="cb618-12" data-line-number="12"><span class="co">#&gt; [11] initialize,signature-method        </span></a>
<a class="sourceLine" id="cb618-13" data-line-number="13"><span class="co">#&gt; [12] initialize,ANY-method              </span></a>
<a class="sourceLine" id="cb618-14" data-line-number="14"><span class="co">#&gt; [13] initialize,ts-method               </span></a>
<a class="sourceLine" id="cb618-15" data-line-number="15"><span class="co">#&gt; [14] initialize,oldClass-method         </span></a>
<a class="sourceLine" id="cb618-16" data-line-number="16"><span class="co">#&gt; see &#39;?methods&#39; for accessing help and source code</span></a>
<a class="sourceLine" id="cb618-17" data-line-number="17"><span class="kw">.S4methods</span>(<span class="dt">class =</span> <span class="st">&quot;Person&quot;</span>)</a>
<a class="sourceLine" id="cb618-18" data-line-number="18"><span class="co">#&gt; [1] age       age&lt;-     myGeneric name      name&lt;-    show     </span></a>
<a class="sourceLine" id="cb618-19" data-line-number="19"><span class="co">#&gt; see &#39;?methods&#39; for accessing help and source code</span></a></code></pre></div>
<p>If you’re looking for the implementation of a specific method, you can use <code>selectMethod()</code>. You give it the name of the generic and the class (or classes) that it’s called with:</p>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb619-1" data-line-number="1"><span class="kw">selectMethod</span>(<span class="st">&quot;show&quot;</span>, <span class="st">&quot;Person&quot;</span>)</a>
<a class="sourceLine" id="cb619-2" data-line-number="2"><span class="co">#&gt; Method Definition:</span></a>
<a class="sourceLine" id="cb619-3" data-line-number="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb619-4" data-line-number="4"><span class="co">#&gt; function (object) </span></a>
<a class="sourceLine" id="cb619-5" data-line-number="5"><span class="co">#&gt; {</span></a>
<a class="sourceLine" id="cb619-6" data-line-number="6"><span class="co">#&gt;     cat(is(object)[[1]], &quot;\n&quot;, &quot;  Name: &quot;, object@name, &quot;\n&quot;, </span></a>
<a class="sourceLine" id="cb619-7" data-line-number="7"><span class="co">#&gt;         &quot;  Age:  &quot;, object@age, &quot;\n&quot;, sep = &quot;&quot;)</span></a>
<a class="sourceLine" id="cb619-8" data-line-number="8"><span class="co">#&gt; }</span></a>
<a class="sourceLine" id="cb619-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb619-10" data-line-number="10"><span class="co">#&gt; Signatures:</span></a>
<a class="sourceLine" id="cb619-11" data-line-number="11"><span class="co">#&gt;         object  </span></a>
<a class="sourceLine" id="cb619-12" data-line-number="12"><span class="co">#&gt; target  &quot;Person&quot;</span></a>
<a class="sourceLine" id="cb619-13" data-line-number="13"><span class="co">#&gt; defined &quot;Person&quot;</span></a></code></pre></div>
</div>
<div id="exercises-47" class="section level3">
<h3><span class="header-section-number">15.4.6</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li><p>Add <code>age()</code> accessors for the <code>Person</code> class.</p></li>
<li><p>In the definition of the generic, why is it necessary to repeat the
name of the generic twice?</p></li>
<li><p>What’s the difference between the generics generated by these two calls?</p>
<div class="sourceCode" id="cb620"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb620-1" data-line-number="1"><span class="kw">setGeneric</span>(<span class="st">&quot;myGeneric&quot;</span>, <span class="cf">function</span>(x) <span class="kw">standardGeneric</span>(<span class="st">&quot;myGeneric&quot;</span>))</a>
<a class="sourceLine" id="cb620-2" data-line-number="2"><span class="kw">setGeneric</span>(<span class="st">&quot;myGeneric&quot;</span>, <span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb620-3" data-line-number="3">  <span class="kw">standardGeneric</span>(<span class="st">&quot;myGeneric&quot;</span>)</a>
<a class="sourceLine" id="cb620-4" data-line-number="4">})</a></code></pre></div></li>
<li><p>What happens if you define a method with different argument names to
the generic?</p></li>
</ol>
</div>
</div>
<div id="s4-dispatch" class="section level2">
<h2><span class="header-section-number">15.5</span> Method dispatch</h2>
<p>S4 dispatch is complicated because S4 has two important features:</p>
<ul>
<li>Multiple inheritance, i.e. a class can have multiple parents,</li>
<li>Multiple dispatch, i.e. a generic can use multiple arguments to pick a method.</li>
</ul>
<p>These features make S4 very powerful, but can also make it hard to understand which method will get selected for a given combination of inputs. In practice, you should keep method dispatch as simple as possible by avoiding multiple inheritance, and reserving multiple dispatch for only where it is absolutely necessary.</p>
<p>But it’s important to describe the full details, so here we’ll start simple with single inheritance and single dispatch, and work our way up to the more complicated cases. To illustrate the ideas without getting bogged down in the details, we’ll use an imaginary <strong>class graph</strong> based on emoji:</p>
<p><img src="diagrams/s4/emoji.png" width="226" style="display: block; margin: auto;" /></p>
<p>Emoji give us very compact class names that evoke the relationships between the classes. It should be straightforward to remember that 😜 inherits from 😉 which inherits from 😶, and that 😎 inherits from both 🕶 and 🙂.</p>
<div id="single-dispatch" class="section level3">
<h3><span class="header-section-number">15.5.1</span> Single dispatch</h3>
<p>Let’s start with the simplest case: a generic function that dispatches on a single class with a single parent. The method dispatch here is simple so it’s a good place to define the graphical conventions we’ll use for the more complex cases.</p>
<p><img src="diagrams/s4/single.png" width="189" style="display: block; margin: auto;" /></p>
<p>There are two parts to this diagram:</p>
<ul>
<li><p>The top part, <code>f(...)</code>, defines the scope of the diagram. Here we have a
generic with one argument, that has a class hierarchy that is three levels
deep.</p></li>
<li><p>The bottom part is the <strong>method graph</strong> and displays all the possible methods
that could be defined. Methods that have been defined
(i.e. with <code>setMethod()</code>) have a grey background.</p></li>
</ul>
<p>To find the method that gets called, you start with the class of the actual arguments, then follow the arrows until you find a method that exists. For example, if you called the function with an object of class 😉 you would follow the arrow right to find the method defined for the more general 😶 class. If no method is found, method dispatch has failed and you get an error. In practice this means that you should alway define methods defined for the terminal nodes, i.e. those on the far right.</p>
<p>There are two <strong>pseudo-classes</strong> that you can define methods for. These are called pseudo-classes because they don’t actually exist, but allow you to define useful behaviours. The first pseudo-class is “ANY”. This matches any class, and plays the same role as the <code>default</code> pseudo-class in S3. For technical reasons that we’ll get to later, the link to the “ANY” method is longer than the links between the other classes:</p>
<p><img src="diagrams/s4/single-any.png" width="269" style="display: block; margin: auto;" /></p>
<p>The second pseudo-class is “MISSING”. If you define a method for this “class”, it will match whenever the argument is missing. It’snot useful for single dispatch, but is important for functions like <code>+</code> and <code>-</code> that use double dispatch and behave differently depending on whether they have one or two arguments.</p>
</div>
<div id="multiple-inheritance" class="section level3">
<h3><span class="header-section-number">15.5.2</span> Multiple inheritance</h3>
<p>Things get more complicated when the class has multiple parents.</p>
<p><img src="diagrams/s4/multiple.png" width="179" style="display: block; margin: auto;" /></p>
<p>The basic process remains the same: you start from the actual class supplied to the generic, then follow the arrows until you find a defined method. The wrinkle is that now there are multiple arrows to follow, so you might find multiple methods. If that happens, you pick the method that is closest, i.e. requires travelling the fewest arrows.</p>
<p>(The method graph is a powerful metaphor that helps you understand how method dispatch works. However, implementing method dispatch in this way would be rather inefficient so the actual approach that S4 uses is somewhat different. You can read the details in <code>?Methods_Details</code>)</p>
<p>What happens if methods are the same distance? For example, imagine we’ve defined methods for 🕶 and 🙂, and we call the generic with 😎. Note that there’s no implementation for the 😶 class, as indicated by the red double outline.</p>
<p><img src="diagrams/s4/multiple-ambig.png" width="165" style="display: block; margin: auto;" /></p>
<p>This is called an <strong>ambiguous</strong> method, and in diagrams I’ll illustrate it with a thick dotted border. When this happens in R, you’ll get a warning, and one of the two methods is basically picked at random (it uses the method that comes first in the alphabet). When you discover ambiguity you should always resolve it by providing a more precise method:</p>
<p><img src="diagrams/s4/multiple-ambig-2.png" width="165" style="display: block; margin: auto;" /></p>
<p>The fallback “ANY” method still exists but the rules are little more complex. As indicated by the wavy dotted lines, the “ANY” method is always considered further away than a method for a real class. This means that it will never contribute to ambiguity.</p>
<p><img src="diagrams/s4/multiple-any.png" width="241" style="display: block; margin: auto;" /></p>
<p>It is hard to simultaneously prevent ambiguity, ensure that every terminal method has an implementation, and minimise the number of defined methods (in order to benefit from OOP). For example, of the six ways to define only two methods for this call, only one is free from problems. For this reason, I recommend using multiple inheritance with extreme care: you will need to carefully think about the method graph and plan accordingly.</p>
<p><img src="diagrams/s4/multiple-all.png" width="520" style="display: block; margin: auto;" /></p>
</div>
<div id="multiple-dispatch" class="section level3">
<h3><span class="header-section-number">15.5.3</span> Multiple dispatch</h3>
<p>Once you understand multiple inheritance, understanding multiple dispatch is straightforward. You follow multiple arrows in the same way as previously, but now each method is specified by two classes (separated by a comma).</p>
<p><img src="diagrams/s4/single-single.png" width="392" style="display: block; margin: auto;" /></p>
<p>I’m not going to show examples of dispatching on more than two arguments, but you can follow the basic principles to generate your own method graphs.</p>
<p>The main difference between multiple inheritance and multiple dispatch is that there are many more arrows to follow. The following diagram shows four defined methods which produce two ambiguous cases:</p>
<p><img src="diagrams/s4/single-single-ambig.png" width="392" style="display: block; margin: auto;" /></p>
<p>Multiple dispatch tends to be less tricky to work with than multiple inheritance because there are usually fewer terminal class combinations. In this example, there’s only one. That means, at a minimum, you can define a single method and have default behaviour for all inputs.</p>
</div>
<div id="multiple-dispatch-and-multiple-inheritance" class="section level3">
<h3><span class="header-section-number">15.5.4</span> Multiple dispatch and multiple inheritance</h3>
<p>Of course you can combine multiple dispatch with multiple inheritance:</p>
<p><img src="diagrams/s4/single-multiple.png" width="397" style="display: block; margin: auto;" /></p>
<p>A still more complicated case dispatches on two classes, both of which have multiple inheritance:</p>
<p><img src="diagrams/s4/multiple-multiple.png" width="316" style="display: block; margin: auto;" /></p>
<p>However, as the method graph gets more and more complicated it gets harder and harder to predict which actual method will get called given a combination of inputs, and it gets harder and harder to make sure that you haven’t introduced ambiguity. If you have to draw diagrams to figure out what method is actually going to be called, it’s a strong sign you should go back simplify your design.</p>
</div>
<div id="exercises-48" class="section level3">
<h3><span class="header-section-number">15.5.5</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li><p>Draw the method graph for
<code>f(😅, 😽)</code></p></li>
<li><p>Draw the method graph for
<code>f(😃, 😉, 😙)</code></p></li>
<li><p>Take the last example which shows multiple dispatch over two classes that
use multiple inheritance. What happens if you define a method for all
terminal classes? Why does method dispatch not save us much work here?</p></li>
</ol>
</div>
</div>
<div id="s4-s3" class="section level2">
<h2><span class="header-section-number">15.6</span> S4 and S3</h2>
<p>Even when writing new S4 code, you’ll still need to interact with existing S3 classes and functions, including existing S3 generics. This section describes how S4 classes, methods, and generics interact with existing code.</p>
<div id="classes" class="section level3">
<h3><span class="header-section-number">15.6.1</span> Classes</h3>
<p>In <code>slots</code> and <code>contains</code> you can use S4 classes, S3 classes, or the implicit class of a base type. To use an S3 class, you must first register it with <code>setOldClass()</code>. You call this function once for each S3 class, giving it the class attribute. For example, the following definitions are already provided by base R:</p>
<div class="sourceCode" id="cb621"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb621-1" data-line-number="1"><span class="kw">setOldClass</span>(<span class="st">&quot;data.frame&quot;</span>)</a>
<a class="sourceLine" id="cb621-2" data-line-number="2"><span class="kw">setOldClass</span>(<span class="kw">c</span>(<span class="st">&quot;ordered&quot;</span>, <span class="st">&quot;factor&quot;</span>))</a>
<a class="sourceLine" id="cb621-3" data-line-number="3"><span class="kw">setOldClass</span>(<span class="kw">c</span>(<span class="st">&quot;glm&quot;</span>, <span class="st">&quot;lm&quot;</span>))</a></code></pre></div>
<p>However, it’s generally better to be a little more specific and provide a full S4 definition with <code>slots</code> and a <code>prototype</code>:</p>
<div class="sourceCode" id="cb622"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb622-1" data-line-number="1"><span class="kw">setClass</span>(<span class="st">&quot;factor&quot;</span>,</a>
<a class="sourceLine" id="cb622-2" data-line-number="2">  <span class="dt">contains =</span> <span class="st">&quot;integer&quot;</span>,</a>
<a class="sourceLine" id="cb622-3" data-line-number="3">  <span class="dt">slots =</span> <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb622-4" data-line-number="4">    <span class="dt">levels =</span> <span class="st">&quot;character&quot;</span></a>
<a class="sourceLine" id="cb622-5" data-line-number="5">  ),</a>
<a class="sourceLine" id="cb622-6" data-line-number="6">  <span class="dt">prototype =</span> <span class="kw">structure</span>(</a>
<a class="sourceLine" id="cb622-7" data-line-number="7">    <span class="kw">integer</span>(),</a>
<a class="sourceLine" id="cb622-8" data-line-number="8">    <span class="dt">levels =</span> <span class="kw">character</span>()</a>
<a class="sourceLine" id="cb622-9" data-line-number="9">  )</a>
<a class="sourceLine" id="cb622-10" data-line-number="10">)</a>
<a class="sourceLine" id="cb622-11" data-line-number="11"><span class="kw">setOldClass</span>(<span class="st">&quot;factor&quot;</span>, <span class="dt">S4Class =</span> <span class="st">&quot;factor&quot;</span>)</a></code></pre></div>
<p>Generally, these definitions should be provided by the creator of the S3 class. If you’re trying to build an S4 class on top of an S3 class provided by a package, it is better to request that the package maintainer add this call to the package, rather than running it yourself.</p>
<p>If an S4 object inherits from an S3 class or a base type, it will have a special virtual slot called <code>.Data</code>. This contains the underlying base type or S3 object: </p>
<div class="sourceCode" id="cb623"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb623-1" data-line-number="1">RangedNumeric &lt;-<span class="st"> </span><span class="kw">setClass</span>(</a>
<a class="sourceLine" id="cb623-2" data-line-number="2">  <span class="st">&quot;RangedNumeric&quot;</span>,</a>
<a class="sourceLine" id="cb623-3" data-line-number="3">  <span class="dt">contains =</span> <span class="st">&quot;numeric&quot;</span>,</a>
<a class="sourceLine" id="cb623-4" data-line-number="4">  <span class="dt">slots =</span> <span class="kw">c</span>(<span class="dt">min =</span> <span class="st">&quot;numeric&quot;</span>, <span class="dt">max =</span> <span class="st">&quot;numeric&quot;</span>),</a>
<a class="sourceLine" id="cb623-5" data-line-number="5">  <span class="dt">prototype =</span> <span class="kw">structure</span>(<span class="kw">numeric</span>(), <span class="dt">min =</span> <span class="ot">NA_real_</span>, <span class="dt">max =</span> <span class="ot">NA_real_</span>)</a>
<a class="sourceLine" id="cb623-6" data-line-number="6">)</a>
<a class="sourceLine" id="cb623-7" data-line-number="7">rn &lt;-<span class="st"> </span><span class="kw">RangedNumeric</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">min =</span> <span class="dv">1</span>, <span class="dt">max =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb623-8" data-line-number="8">rn<span class="op">@</span>min</a>
<a class="sourceLine" id="cb623-9" data-line-number="9"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb623-10" data-line-number="10">rn<span class="op">@</span>.Data</a>
<a class="sourceLine" id="cb623-11" data-line-number="11"><span class="co">#&gt;  [1]  1  2  3  4  5  6  7  8  9 10</span></a></code></pre></div>
<p>It is possible to define S3 methods for S4 generics, and S4 methods for S3 generics (provided you’ve called <code>setOldClass()</code>). However, it’s more complicated than it might appear at first glance, so make sure you thoroughly read <code>?Methods_for_S3</code>.</p>
</div>
<div id="generics" class="section level3">
<h3><span class="header-section-number">15.6.2</span> Generics</h3>
<p>As well as creating a new generic from scratch, it’s also possible to convert an existing S3 generic to an S4 generic:</p>
<div class="sourceCode" id="cb624"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb624-1" data-line-number="1"><span class="kw">setGeneric</span>(<span class="st">&quot;mean&quot;</span>)</a></code></pre></div>
<p>In this case, the existing function becomes the default (“ANY”) method:</p>
<div class="sourceCode" id="cb625"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb625-1" data-line-number="1"><span class="kw">selectMethod</span>(<span class="st">&quot;mean&quot;</span>, <span class="st">&quot;ANY&quot;</span>)</a>
<a class="sourceLine" id="cb625-2" data-line-number="2"><span class="co">#&gt; Method Definition (Class &quot;derivedDefaultMethod&quot;):</span></a>
<a class="sourceLine" id="cb625-3" data-line-number="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb625-4" data-line-number="4"><span class="co">#&gt; function (x, ...) </span></a>
<a class="sourceLine" id="cb625-5" data-line-number="5"><span class="co">#&gt; UseMethod(&quot;mean&quot;)</span></a>
<a class="sourceLine" id="cb625-6" data-line-number="6"><span class="co">#&gt; &lt;bytecode: 0x48f3ce0&gt;</span></a>
<a class="sourceLine" id="cb625-7" data-line-number="7"><span class="co">#&gt; &lt;environment: namespace:base&gt;</span></a>
<a class="sourceLine" id="cb625-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb625-9" data-line-number="9"><span class="co">#&gt; Signatures:</span></a>
<a class="sourceLine" id="cb625-10" data-line-number="10"><span class="co">#&gt;         x    </span></a>
<a class="sourceLine" id="cb625-11" data-line-number="11"><span class="co">#&gt; target  &quot;ANY&quot;</span></a>
<a class="sourceLine" id="cb625-12" data-line-number="12"><span class="co">#&gt; defined &quot;ANY&quot;</span></a></code></pre></div>
<p>Note that <code>setMethod()</code> will automatically call <code>setGeneric()</code> if the first argument isn’t already a generic, enabling you to turn any existing function into an S4 generic. It is ok to convert an existing S3 generic to S4, but you should avoid converting regular functions to S4 generics because it makes code harder to use and requires carefuk coordination if done by multiple packages.</p>
</div>
<div id="exercises-49" class="section level3">
<h3><span class="header-section-number">15.6.3</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li><p>What would a full <code>setOldClass()</code> definition look like for an ordered
factor? (i.e. add <code>slots</code> and <code>prototype</code> the definition above)</p></li>
<li><p>Define a <code>length</code> method for the <code>Person</code> class.</p></li>
</ol>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-chambers-2014">
<p>Chambers, John M. 2014. “Object-Oriented Programming, Functional Programming and R.” <em>Statistical Science</em> 29 (2). Institute of Mathematical Statistics: 167–80. <a href="https://projecteuclid.org/download/pdfview_1/euclid.ss/1408368569" class="uri">https://projecteuclid.org/download/pdfview_1/euclid.ss/1408368569</a>.</p>
</div>
<div id="ref-s4da">
<p>Chambers, John M. 2008. <em>Software for Data Analysis: Programming with R</em>. Springer.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="r6.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="oo-tradeoffs.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": true,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/hadley/adv-r/edit/master/S4.Rmd",
"text": "Edit"
},
"download": [["https://github.com/BruceZhaoR/adv-r/raw/gh-pages/_main.pdf", "PDF"], ["https://github.com/BruceZhaoR/adv-r/raw/gh-pages/_main.epub", "EPUB3"]],
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
