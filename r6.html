<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Advanced R</title>
  <meta name="description" content="The book is designed primarily for R users who want to improve their programming skills and understanding of the language. It should also be useful for programmers coming to R from other languages, as it explains some of R’s quirks and shows how some parts that seem horrible do have a positive side.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Advanced R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://adv-r.hadley.nz/" />
  <meta property="og:image" content="https://adv-r.hadley.nz/cover.png" />
  <meta property="og:description" content="The book is designed primarily for R users who want to improve their programming skills and understanding of the language. It should also be useful for programmers coming to R from other languages, as it explains some of R’s quirks and shows how some parts that seem horrible do have a positive side." />
  <meta name="github-repo" content="hadley/adv-r" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Advanced R" />
  <meta name="twitter:site" content="@hadley" />
  <meta name="twitter:description" content="The book is designed primarily for R users who want to improve their programming skills and understanding of the language. It should also be useful for programmers coming to R from other languages, as it explains some of R’s quirks and shows how some parts that seem horrible do have a positive side." />
  <meta name="twitter:image" content="https://adv-r.hadley.nz/cover.png" />

<meta name="author" content="Hadley Wickham">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="s3.html">
<link rel="next" href="s4.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="adv-r.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">Advanced R</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#other-books"><i class="fa fa-check"></i>Other books</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#why-r"><i class="fa fa-check"></i><b>1.1</b> Why R?</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#who-should-read"><i class="fa fa-check"></i><b>1.2</b> Who should read this book</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#what-you-will-get"><i class="fa fa-check"></i><b>1.3</b> What you will get out of this book</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#what-you-will-not-learn"><i class="fa fa-check"></i><b>1.4</b> What you will not learn</a></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#meta-techniques"><i class="fa fa-check"></i><b>1.5</b> Meta-techniques</a></li>
<li class="chapter" data-level="1.6" data-path="introduction.html"><a href="introduction.html#recommended-reading"><i class="fa fa-check"></i><b>1.6</b> Recommended reading</a></li>
<li class="chapter" data-level="1.7" data-path="introduction.html"><a href="introduction.html#getting-help"><i class="fa fa-check"></i><b>1.7</b> Getting help</a></li>
<li class="chapter" data-level="1.8" data-path="introduction.html"><a href="introduction.html#intro-ack"><i class="fa fa-check"></i><b>1.8</b> Acknowledgments</a></li>
<li class="chapter" data-level="1.9" data-path="introduction.html"><a href="introduction.html#conventions"><i class="fa fa-check"></i><b>1.9</b> Conventions</a></li>
<li class="chapter" data-level="1.10" data-path="introduction.html"><a href="introduction.html#colophon"><i class="fa fa-check"></i><b>1.10</b> Colophon</a></li>
</ul></li>
<li class="part"><span><b>I Foundations</b></span></li>
<li class="chapter" data-level="" data-path="foundations-intro.html"><a href="foundations-intro.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="2" data-path="names-values.html"><a href="names-values.html"><i class="fa fa-check"></i><b>2</b> Names and values</a><ul>
<li class="chapter" data-level="2.1" data-path="names-values.html"><a href="names-values.html#introduction-1"><i class="fa fa-check"></i><b>2.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#quiz"><i class="fa fa-check"></i>Quiz</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#outline"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#sources"><i class="fa fa-check"></i>Sources</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="names-values.html"><a href="names-values.html#binding-basics"><i class="fa fa-check"></i><b>2.2</b> Binding basics</a><ul>
<li class="chapter" data-level="2.2.1" data-path="names-values.html"><a href="names-values.html#non-syntactic"><i class="fa fa-check"></i><b>2.2.1</b> Non-syntactic names</a></li>
<li class="chapter" data-level="2.2.2" data-path="names-values.html"><a href="names-values.html#exercises"><i class="fa fa-check"></i><b>2.2.2</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="names-values.html"><a href="names-values.html#copy-on-modify"><i class="fa fa-check"></i><b>2.3</b> Copy-on-modify</a><ul>
<li class="chapter" data-level="2.3.1" data-path="names-values.html"><a href="names-values.html#tracemem"><i class="fa fa-check"></i><b>2.3.1</b> <code>tracemem()</code></a></li>
<li class="chapter" data-level="2.3.2" data-path="names-values.html"><a href="names-values.html#function-calls"><i class="fa fa-check"></i><b>2.3.2</b> Function calls</a></li>
<li class="chapter" data-level="2.3.3" data-path="names-values.html"><a href="names-values.html#list-references"><i class="fa fa-check"></i><b>2.3.3</b> Lists</a></li>
<li class="chapter" data-level="2.3.4" data-path="names-values.html"><a href="names-values.html#df-modify"><i class="fa fa-check"></i><b>2.3.4</b> Data frames</a></li>
<li class="chapter" data-level="2.3.5" data-path="names-values.html"><a href="names-values.html#character-vectors"><i class="fa fa-check"></i><b>2.3.5</b> Character vectors</a></li>
<li class="chapter" data-level="2.3.6" data-path="names-values.html"><a href="names-values.html#exercises-1"><i class="fa fa-check"></i><b>2.3.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="names-values.html"><a href="names-values.html#object-size"><i class="fa fa-check"></i><b>2.4</b> Object size</a><ul>
<li class="chapter" data-level="2.4.1" data-path="names-values.html"><a href="names-values.html#exercises-2"><i class="fa fa-check"></i><b>2.4.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="names-values.html"><a href="names-values.html#modify-in-place"><i class="fa fa-check"></i><b>2.5</b> Modify-in-place</a><ul>
<li class="chapter" data-level="2.5.1" data-path="names-values.html"><a href="names-values.html#single-binding"><i class="fa fa-check"></i><b>2.5.1</b> Objects with a single binding</a></li>
<li class="chapter" data-level="2.5.2" data-path="names-values.html"><a href="names-values.html#env-modify"><i class="fa fa-check"></i><b>2.5.2</b> Environments</a></li>
<li class="chapter" data-level="2.5.3" data-path="names-values.html"><a href="names-values.html#exercises-3"><i class="fa fa-check"></i><b>2.5.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="names-values.html"><a href="names-values.html#gc"><i class="fa fa-check"></i><b>2.6</b> Unbinding and the garbage collector</a></li>
<li class="chapter" data-level="2.7" data-path="names-values.html"><a href="names-values.html#names-values-answers"><i class="fa fa-check"></i><b>2.7</b> Answers</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="vectors-chap.html"><a href="vectors-chap.html"><i class="fa fa-check"></i><b>3</b> Vectors</a><ul>
<li class="chapter" data-level="3.1" data-path="vectors-chap.html"><a href="vectors-chap.html#introduction-2"><i class="fa fa-check"></i><b>3.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="vectors-chap.html"><a href="vectors-chap.html#quiz-1"><i class="fa fa-check"></i>Quiz</a></li>
<li class="chapter" data-level="" data-path="vectors-chap.html"><a href="vectors-chap.html#outline-1"><i class="fa fa-check"></i>Outline</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="vectors-chap.html"><a href="vectors-chap.html#atomic-vectors"><i class="fa fa-check"></i><b>3.2</b> Atomic vectors</a><ul>
<li class="chapter" data-level="3.2.1" data-path="vectors-chap.html"><a href="vectors-chap.html#scalars"><i class="fa fa-check"></i><b>3.2.1</b> Scalars</a></li>
<li class="chapter" data-level="3.2.2" data-path="vectors-chap.html"><a href="vectors-chap.html#atomic-constructing"><i class="fa fa-check"></i><b>3.2.2</b> Making longer vectors with <code>c()</code></a></li>
<li class="chapter" data-level="3.2.3" data-path="vectors-chap.html"><a href="vectors-chap.html#testing-and-coercing"><i class="fa fa-check"></i><b>3.2.3</b> Testing and coercing</a></li>
<li class="chapter" data-level="3.2.4" data-path="vectors-chap.html"><a href="vectors-chap.html#exercises-4"><i class="fa fa-check"></i><b>3.2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="vectors-chap.html"><a href="vectors-chap.html#attributes"><i class="fa fa-check"></i><b>3.3</b> Attributes</a><ul>
<li class="chapter" data-level="3.3.1" data-path="vectors-chap.html"><a href="vectors-chap.html#getting-and-setting"><i class="fa fa-check"></i><b>3.3.1</b> Getting and setting</a></li>
<li class="chapter" data-level="3.3.2" data-path="vectors-chap.html"><a href="vectors-chap.html#attr-names"><i class="fa fa-check"></i><b>3.3.2</b> Names</a></li>
<li class="chapter" data-level="3.3.3" data-path="vectors-chap.html"><a href="vectors-chap.html#attr-dims"><i class="fa fa-check"></i><b>3.3.3</b> Dimensions</a></li>
<li class="chapter" data-level="3.3.4" data-path="vectors-chap.html"><a href="vectors-chap.html#exercises-5"><i class="fa fa-check"></i><b>3.3.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="vectors-chap.html"><a href="vectors-chap.html#s3-atomic-vectors"><i class="fa fa-check"></i><b>3.4</b> S3 atomic vectors</a><ul>
<li class="chapter" data-level="3.4.1" data-path="vectors-chap.html"><a href="vectors-chap.html#factors"><i class="fa fa-check"></i><b>3.4.1</b> Factors</a></li>
<li class="chapter" data-level="3.4.2" data-path="vectors-chap.html"><a href="vectors-chap.html#dates"><i class="fa fa-check"></i><b>3.4.2</b> Dates</a></li>
<li class="chapter" data-level="3.4.3" data-path="vectors-chap.html"><a href="vectors-chap.html#date-times"><i class="fa fa-check"></i><b>3.4.3</b> Date-times</a></li>
<li class="chapter" data-level="3.4.4" data-path="vectors-chap.html"><a href="vectors-chap.html#exercises-6"><i class="fa fa-check"></i><b>3.4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="vectors-chap.html"><a href="vectors-chap.html#lists"><i class="fa fa-check"></i><b>3.5</b> Lists</a><ul>
<li class="chapter" data-level="3.5.1" data-path="vectors-chap.html"><a href="vectors-chap.html#list-creating"><i class="fa fa-check"></i><b>3.5.1</b> Creating</a></li>
<li class="chapter" data-level="3.5.2" data-path="vectors-chap.html"><a href="vectors-chap.html#list-types"><i class="fa fa-check"></i><b>3.5.2</b> Testing and coercing</a></li>
<li class="chapter" data-level="3.5.3" data-path="vectors-chap.html"><a href="vectors-chap.html#list-array"><i class="fa fa-check"></i><b>3.5.3</b> Matrices and arrays</a></li>
<li class="chapter" data-level="3.5.4" data-path="vectors-chap.html"><a href="vectors-chap.html#exercises-7"><i class="fa fa-check"></i><b>3.5.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="vectors-chap.html"><a href="vectors-chap.html#tibble"><i class="fa fa-check"></i><b>3.6</b> Data frames and tibbles</a><ul>
<li class="chapter" data-level="3.6.1" data-path="vectors-chap.html"><a href="vectors-chap.html#df-create"><i class="fa fa-check"></i><b>3.6.1</b> Creating</a></li>
<li class="chapter" data-level="3.6.2" data-path="vectors-chap.html"><a href="vectors-chap.html#rownames"><i class="fa fa-check"></i><b>3.6.2</b> Row names</a></li>
<li class="chapter" data-level="3.6.3" data-path="vectors-chap.html"><a href="vectors-chap.html#printing"><i class="fa fa-check"></i><b>3.6.3</b> Printing</a></li>
<li class="chapter" data-level="3.6.4" data-path="vectors-chap.html"><a href="vectors-chap.html#safe-subsetting"><i class="fa fa-check"></i><b>3.6.4</b> Subsetting</a></li>
<li class="chapter" data-level="3.6.5" data-path="vectors-chap.html"><a href="vectors-chap.html#df-test-coerce"><i class="fa fa-check"></i><b>3.6.5</b> Testing and coercing</a></li>
<li class="chapter" data-level="3.6.6" data-path="vectors-chap.html"><a href="vectors-chap.html#list-columns"><i class="fa fa-check"></i><b>3.6.6</b> List columns</a></li>
<li class="chapter" data-level="3.6.7" data-path="vectors-chap.html"><a href="vectors-chap.html#matrix-and-data-frame-columns"><i class="fa fa-check"></i><b>3.6.7</b> Matrix and data frame columns</a></li>
<li class="chapter" data-level="3.6.8" data-path="vectors-chap.html"><a href="vectors-chap.html#exercises-8"><i class="fa fa-check"></i><b>3.6.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="vectors-chap.html"><a href="vectors-chap.html#null"><i class="fa fa-check"></i><b>3.7</b> <code>NULL</code></a></li>
<li class="chapter" data-level="3.8" data-path="vectors-chap.html"><a href="vectors-chap.html#data-structure-answers"><i class="fa fa-check"></i><b>3.8</b> Answers</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="subsetting.html"><a href="subsetting.html"><i class="fa fa-check"></i><b>4</b> Subsetting</a><ul>
<li class="chapter" data-level="4.1" data-path="subsetting.html"><a href="subsetting.html#introduction-3"><i class="fa fa-check"></i><b>4.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="subsetting.html"><a href="subsetting.html#quiz-2"><i class="fa fa-check"></i>Quiz</a></li>
<li class="chapter" data-level="" data-path="subsetting.html"><a href="subsetting.html#outline-2"><i class="fa fa-check"></i>Outline</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="subsetting.html"><a href="subsetting.html#subset-multiple"><i class="fa fa-check"></i><b>4.2</b> Selecting multiple elements</a><ul>
<li class="chapter" data-level="4.2.1" data-path="subsetting.html"><a href="subsetting.html#atomic-vectors-1"><i class="fa fa-check"></i><b>4.2.1</b> Atomic vectors</a></li>
<li class="chapter" data-level="4.2.2" data-path="subsetting.html"><a href="subsetting.html#lists-1"><i class="fa fa-check"></i><b>4.2.2</b> Lists</a></li>
<li class="chapter" data-level="4.2.3" data-path="subsetting.html"><a href="subsetting.html#matrix-subsetting"><i class="fa fa-check"></i><b>4.2.3</b> Matrices and arrays</a></li>
<li class="chapter" data-level="4.2.4" data-path="subsetting.html"><a href="subsetting.html#df-subsetting"><i class="fa fa-check"></i><b>4.2.4</b> Data frames and tibbles</a></li>
<li class="chapter" data-level="4.2.5" data-path="subsetting.html"><a href="subsetting.html#simplify-preserve"><i class="fa fa-check"></i><b>4.2.5</b> Preserving dimensionality</a></li>
<li class="chapter" data-level="4.2.6" data-path="subsetting.html"><a href="subsetting.html#exercises-9"><i class="fa fa-check"></i><b>4.2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="subsetting.html"><a href="subsetting.html#subset-single"><i class="fa fa-check"></i><b>4.3</b> Selecting a single element</a><ul>
<li class="chapter" data-level="4.3.1" data-path="subsetting.html"><a href="subsetting.html#section"><i class="fa fa-check"></i><b>4.3.1</b> <code>[[</code></a></li>
<li class="chapter" data-level="4.3.2" data-path="subsetting.html"><a href="subsetting.html#section-1"><i class="fa fa-check"></i><b>4.3.2</b> <code>$</code></a></li>
<li class="chapter" data-level="4.3.3" data-path="subsetting.html"><a href="subsetting.html#missingout-of-bounds-indices"><i class="fa fa-check"></i><b>4.3.3</b> Missing/out of bounds indices</a></li>
<li class="chapter" data-level="4.3.4" data-path="subsetting.html"><a href="subsetting.html#and-slot"><i class="fa fa-check"></i><b>4.3.4</b> <code>@</code> and <code>slot()</code></a></li>
<li class="chapter" data-level="4.3.5" data-path="subsetting.html"><a href="subsetting.html#exercises-10"><i class="fa fa-check"></i><b>4.3.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="subsetting.html"><a href="subsetting.html#subassignment"><i class="fa fa-check"></i><b>4.4</b> Subsetting and assignment</a></li>
<li class="chapter" data-level="4.5" data-path="subsetting.html"><a href="subsetting.html#applications"><i class="fa fa-check"></i><b>4.5</b> Applications</a><ul>
<li class="chapter" data-level="4.5.1" data-path="subsetting.html"><a href="subsetting.html#lookup-tables"><i class="fa fa-check"></i><b>4.5.1</b> Lookup tables (character subsetting)</a></li>
<li class="chapter" data-level="4.5.2" data-path="subsetting.html"><a href="subsetting.html#matching-merging"><i class="fa fa-check"></i><b>4.5.2</b> Matching and merging by hand (integer subsetting)</a></li>
<li class="chapter" data-level="4.5.3" data-path="subsetting.html"><a href="subsetting.html#random-samplesbootstraps-integer-subsetting"><i class="fa fa-check"></i><b>4.5.3</b> Random samples/bootstraps (integer subsetting)</a></li>
<li class="chapter" data-level="4.5.4" data-path="subsetting.html"><a href="subsetting.html#ordering-integer-subsetting"><i class="fa fa-check"></i><b>4.5.4</b> Ordering (integer subsetting)</a></li>
<li class="chapter" data-level="4.5.5" data-path="subsetting.html"><a href="subsetting.html#expanding-aggregated-counts-integer-subsetting"><i class="fa fa-check"></i><b>4.5.5</b> Expanding aggregated counts (integer subsetting)</a></li>
<li class="chapter" data-level="4.5.6" data-path="subsetting.html"><a href="subsetting.html#removing-columns-from-data-frames-character-subsetting"><i class="fa fa-check"></i><b>4.5.6</b> Removing columns from data frames (character subsetting)</a></li>
<li class="chapter" data-level="4.5.7" data-path="subsetting.html"><a href="subsetting.html#selecting-rows-based-on-a-condition-logical-subsetting"><i class="fa fa-check"></i><b>4.5.7</b> Selecting rows based on a condition (logical subsetting)</a></li>
<li class="chapter" data-level="4.5.8" data-path="subsetting.html"><a href="subsetting.html#boolean-algebra-vs.sets-logical-integer-subsetting"><i class="fa fa-check"></i><b>4.5.8</b> Boolean algebra vs. sets (logical &amp; integer subsetting)</a></li>
<li class="chapter" data-level="4.5.9" data-path="subsetting.html"><a href="subsetting.html#exercises-11"><i class="fa fa-check"></i><b>4.5.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="subsetting.html"><a href="subsetting.html#subsetting-answers"><i class="fa fa-check"></i><b>4.6</b> Answers</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>5</b> Functions</a><ul>
<li class="chapter" data-level="5.1" data-path="functions.html"><a href="functions.html#introduction-4"><i class="fa fa-check"></i><b>5.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="functions.html"><a href="functions.html#quiz-3"><i class="fa fa-check"></i>Quiz</a></li>
<li class="chapter" data-level="" data-path="functions.html"><a href="functions.html#outline-3"><i class="fa fa-check"></i>Outline</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="functions.html"><a href="functions.html#function-fundamentals"><i class="fa fa-check"></i><b>5.2</b> Function fundamentals</a><ul>
<li class="chapter" data-level="5.2.1" data-path="functions.html"><a href="functions.html#first-class-functions"><i class="fa fa-check"></i><b>5.2.1</b> First-class functions</a></li>
<li class="chapter" data-level="5.2.2" data-path="functions.html"><a href="functions.html#function-components"><i class="fa fa-check"></i><b>5.2.2</b> Function components</a></li>
<li class="chapter" data-level="5.2.3" data-path="functions.html"><a href="functions.html#primitive-functions"><i class="fa fa-check"></i><b>5.2.3</b> Primitive functions</a></li>
<li class="chapter" data-level="5.2.4" data-path="functions.html"><a href="functions.html#exercises-12"><i class="fa fa-check"></i><b>5.2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="functions.html"><a href="functions.html#function-composition"><i class="fa fa-check"></i><b>5.3</b> Function composition</a></li>
<li class="chapter" data-level="5.4" data-path="functions.html"><a href="functions.html#lexical-scoping"><i class="fa fa-check"></i><b>5.4</b> Lexical scoping</a><ul>
<li class="chapter" data-level="5.4.1" data-path="functions.html"><a href="functions.html#name-masking"><i class="fa fa-check"></i><b>5.4.1</b> Name masking</a></li>
<li class="chapter" data-level="5.4.2" data-path="functions.html"><a href="functions.html#functions-vs.variables"><i class="fa fa-check"></i><b>5.4.2</b> Functions vs. variables</a></li>
<li class="chapter" data-level="5.4.3" data-path="functions.html"><a href="functions.html#fresh-start"><i class="fa fa-check"></i><b>5.4.3</b> A fresh start</a></li>
<li class="chapter" data-level="5.4.4" data-path="functions.html"><a href="functions.html#dynamic-lookup"><i class="fa fa-check"></i><b>5.4.4</b> Dynamic lookup</a></li>
<li class="chapter" data-level="5.4.5" data-path="functions.html"><a href="functions.html#exercises-13"><i class="fa fa-check"></i><b>5.4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="functions.html"><a href="functions.html#lazy-evaluation"><i class="fa fa-check"></i><b>5.5</b> Lazy evaluation</a><ul>
<li class="chapter" data-level="5.5.1" data-path="functions.html"><a href="functions.html#forcing-evaluation"><i class="fa fa-check"></i><b>5.5.1</b> Forcing evaluation</a></li>
<li class="chapter" data-level="5.5.2" data-path="functions.html"><a href="functions.html#promises"><i class="fa fa-check"></i><b>5.5.2</b> Promises</a></li>
<li class="chapter" data-level="5.5.3" data-path="functions.html"><a href="functions.html#default-arguments"><i class="fa fa-check"></i><b>5.5.3</b> Default arguments</a></li>
<li class="chapter" data-level="5.5.4" data-path="functions.html"><a href="functions.html#missing-arguments"><i class="fa fa-check"></i><b>5.5.4</b> Missing arguments</a></li>
<li class="chapter" data-level="5.5.5" data-path="functions.html"><a href="functions.html#exercises-14"><i class="fa fa-check"></i><b>5.5.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="functions.html"><a href="functions.html#fun-dot-dot-dot"><i class="fa fa-check"></i><b>5.6</b> <code>...</code> (dot-dot-dot)</a><ul>
<li class="chapter" data-level="5.6.1" data-path="functions.html"><a href="functions.html#exercises-15"><i class="fa fa-check"></i><b>5.6.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="functions.html"><a href="functions.html#exiting-a-function"><i class="fa fa-check"></i><b>5.7</b> Exiting a function</a><ul>
<li class="chapter" data-level="5.7.1" data-path="functions.html"><a href="functions.html#implicit-vs.explict-returns"><i class="fa fa-check"></i><b>5.7.1</b> Implicit vs. explict returns</a></li>
<li class="chapter" data-level="5.7.2" data-path="functions.html"><a href="functions.html#invisible-values"><i class="fa fa-check"></i><b>5.7.2</b> Invisible values</a></li>
<li class="chapter" data-level="5.7.3" data-path="functions.html"><a href="functions.html#errors"><i class="fa fa-check"></i><b>5.7.3</b> Errors</a></li>
<li class="chapter" data-level="5.7.4" data-path="functions.html"><a href="functions.html#on-exit"><i class="fa fa-check"></i><b>5.7.4</b> Exit handlers</a></li>
<li class="chapter" data-level="5.7.5" data-path="functions.html"><a href="functions.html#exercises-16"><i class="fa fa-check"></i><b>5.7.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="functions.html"><a href="functions.html#function-forms"><i class="fa fa-check"></i><b>5.8</b> Function forms</a><ul>
<li class="chapter" data-level="5.8.1" data-path="functions.html"><a href="functions.html#rewriting-to-prefix-form"><i class="fa fa-check"></i><b>5.8.1</b> Rewriting to prefix form</a></li>
<li class="chapter" data-level="5.8.2" data-path="functions.html"><a href="functions.html#prefix-form"><i class="fa fa-check"></i><b>5.8.2</b> Prefix form</a></li>
<li class="chapter" data-level="5.8.3" data-path="functions.html"><a href="functions.html#infix-functions"><i class="fa fa-check"></i><b>5.8.3</b> Infix functions</a></li>
<li class="chapter" data-level="5.8.4" data-path="functions.html"><a href="functions.html#replacement-functions"><i class="fa fa-check"></i><b>5.8.4</b> Replacement functions</a></li>
<li class="chapter" data-level="5.8.5" data-path="functions.html"><a href="functions.html#special-forms"><i class="fa fa-check"></i><b>5.8.5</b> Special forms</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="functions.html"><a href="functions.html#invoking-a-function"><i class="fa fa-check"></i><b>5.9</b> Invoking a function</a><ul>
<li class="chapter" data-level="5.9.1" data-path="functions.html"><a href="functions.html#exercises-17"><i class="fa fa-check"></i><b>5.9.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="functions.html"><a href="functions.html#function-answers"><i class="fa fa-check"></i><b>5.10</b> Quiz answers</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="environments.html"><a href="environments.html"><i class="fa fa-check"></i><b>6</b> Environments</a><ul>
<li class="chapter" data-level="6.1" data-path="environments.html"><a href="environments.html#introduction-5"><i class="fa fa-check"></i><b>6.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="environments.html"><a href="environments.html#quiz-4"><i class="fa fa-check"></i>Quiz</a></li>
<li class="chapter" data-level="" data-path="environments.html"><a href="environments.html#outline-4"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="environments.html"><a href="environments.html#prerequisites-1"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="environments.html"><a href="environments.html#env-basics"><i class="fa fa-check"></i><b>6.2</b> Environment basics</a><ul>
<li class="chapter" data-level="6.2.1" data-path="environments.html"><a href="environments.html#basics"><i class="fa fa-check"></i><b>6.2.1</b> Basics</a></li>
<li class="chapter" data-level="6.2.2" data-path="environments.html"><a href="environments.html#important-environments"><i class="fa fa-check"></i><b>6.2.2</b> Important environments</a></li>
<li class="chapter" data-level="6.2.3" data-path="environments.html"><a href="environments.html#parents"><i class="fa fa-check"></i><b>6.2.3</b> Parents</a></li>
<li class="chapter" data-level="6.2.4" data-path="environments.html"><a href="environments.html#super-assigment--"><i class="fa fa-check"></i><b>6.2.4</b> Super assigment, <code>&lt;&lt;-</code></a></li>
<li class="chapter" data-level="6.2.5" data-path="environments.html"><a href="environments.html#getting-and-setting-1"><i class="fa fa-check"></i><b>6.2.5</b> Getting and setting</a></li>
<li class="chapter" data-level="6.2.6" data-path="environments.html"><a href="environments.html#finalisers"><i class="fa fa-check"></i><b>6.2.6</b> Finalisers</a></li>
<li class="chapter" data-level="6.2.7" data-path="environments.html"><a href="environments.html#advanced-bindings"><i class="fa fa-check"></i><b>6.2.7</b> Advanced bindings</a></li>
<li class="chapter" data-level="6.2.8" data-path="environments.html"><a href="environments.html#exercises-18"><i class="fa fa-check"></i><b>6.2.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="environments.html"><a href="environments.html#env-recursion"><i class="fa fa-check"></i><b>6.3</b> Recursing over environments</a><ul>
<li class="chapter" data-level="6.3.1" data-path="environments.html"><a href="environments.html#exercises-19"><i class="fa fa-check"></i><b>6.3.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="environments.html"><a href="environments.html#function-envs"><i class="fa fa-check"></i><b>6.4</b> Special environments</a><ul>
<li class="chapter" data-level="6.4.1" data-path="environments.html"><a href="environments.html#package-environments-and-the-search-path"><i class="fa fa-check"></i><b>6.4.1</b> Package environments and the search path</a></li>
<li class="chapter" data-level="6.4.2" data-path="environments.html"><a href="environments.html#the-function-environment"><i class="fa fa-check"></i><b>6.4.2</b> The function environment</a></li>
<li class="chapter" data-level="6.4.3" data-path="environments.html"><a href="environments.html#namespaces"><i class="fa fa-check"></i><b>6.4.3</b> Namespaces</a></li>
<li class="chapter" data-level="6.4.4" data-path="environments.html"><a href="environments.html#execution-environments"><i class="fa fa-check"></i><b>6.4.4</b> Execution environments</a></li>
<li class="chapter" data-level="6.4.5" data-path="environments.html"><a href="environments.html#exercises-20"><i class="fa fa-check"></i><b>6.4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="environments.html"><a href="environments.html#call-stack"><i class="fa fa-check"></i><b>6.5</b> The call stack</a><ul>
<li class="chapter" data-level="6.5.1" data-path="environments.html"><a href="environments.html#simple-call-stacks"><i class="fa fa-check"></i><b>6.5.1</b> Simple call stacks</a></li>
<li class="chapter" data-level="6.5.2" data-path="environments.html"><a href="environments.html#lazy-evaluation-1"><i class="fa fa-check"></i><b>6.5.2</b> Lazy evaluation</a></li>
<li class="chapter" data-level="6.5.3" data-path="environments.html"><a href="environments.html#frames"><i class="fa fa-check"></i><b>6.5.3</b> Frames</a></li>
<li class="chapter" data-level="6.5.4" data-path="environments.html"><a href="environments.html#dynamic-scope"><i class="fa fa-check"></i><b>6.5.4</b> Dynamic scope</a></li>
<li class="chapter" data-level="6.5.5" data-path="environments.html"><a href="environments.html#exercises-21"><i class="fa fa-check"></i><b>6.5.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="environments.html"><a href="environments.html#explicit-envs"><i class="fa fa-check"></i><b>6.6</b> As data structures</a></li>
<li class="chapter" data-level="6.7" data-path="environments.html"><a href="environments.html#env-answers"><i class="fa fa-check"></i><b>6.7</b> Quiz answers</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="conditions.html"><a href="conditions.html"><i class="fa fa-check"></i><b>7</b> Conditions</a><ul>
<li class="chapter" data-level="7.1" data-path="conditions.html"><a href="conditions.html#introduction-6"><i class="fa fa-check"></i><b>7.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="conditions.html"><a href="conditions.html#quiz-5"><i class="fa fa-check"></i>Quiz</a></li>
<li class="chapter" data-level="" data-path="conditions.html"><a href="conditions.html#overview"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="7.1.1" data-path="conditions.html"><a href="conditions.html#prerequisites-2"><i class="fa fa-check"></i><b>7.1.1</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="conditions.html"><a href="conditions.html#signalling-conditions"><i class="fa fa-check"></i><b>7.2</b> Signalling conditions</a><ul>
<li class="chapter" data-level="7.2.1" data-path="conditions.html"><a href="conditions.html#errors-1"><i class="fa fa-check"></i><b>7.2.1</b> Errors</a></li>
<li class="chapter" data-level="7.2.2" data-path="conditions.html"><a href="conditions.html#warnings"><i class="fa fa-check"></i><b>7.2.2</b> Warnings</a></li>
<li class="chapter" data-level="7.2.3" data-path="conditions.html"><a href="conditions.html#messages"><i class="fa fa-check"></i><b>7.2.3</b> Messages</a></li>
<li class="chapter" data-level="7.2.4" data-path="conditions.html"><a href="conditions.html#exercises-22"><i class="fa fa-check"></i><b>7.2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="conditions.html"><a href="conditions.html#ignoring-conditions"><i class="fa fa-check"></i><b>7.3</b> Ignoring conditions</a></li>
<li class="chapter" data-level="7.4" data-path="conditions.html"><a href="conditions.html#handling-conditions"><i class="fa fa-check"></i><b>7.4</b> Handling conditions</a><ul>
<li class="chapter" data-level="7.4.1" data-path="conditions.html"><a href="conditions.html#condition-objects"><i class="fa fa-check"></i><b>7.4.1</b> Condition objects</a></li>
<li class="chapter" data-level="7.4.2" data-path="conditions.html"><a href="conditions.html#exiting-handlers"><i class="fa fa-check"></i><b>7.4.2</b> Exiting handlers</a></li>
<li class="chapter" data-level="7.4.3" data-path="conditions.html"><a href="conditions.html#calling-handlers"><i class="fa fa-check"></i><b>7.4.3</b> Calling handlers</a></li>
<li class="chapter" data-level="7.4.4" data-path="conditions.html"><a href="conditions.html#call-stacks"><i class="fa fa-check"></i><b>7.4.4</b> Call stacks</a></li>
<li class="chapter" data-level="7.4.5" data-path="conditions.html"><a href="conditions.html#exercises-23"><i class="fa fa-check"></i><b>7.4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="conditions.html"><a href="conditions.html#custom-conditions"><i class="fa fa-check"></i><b>7.5</b> Custom conditions</a><ul>
<li class="chapter" data-level="7.5.1" data-path="conditions.html"><a href="conditions.html#motivation"><i class="fa fa-check"></i><b>7.5.1</b> Motivation</a></li>
<li class="chapter" data-level="7.5.2" data-path="conditions.html"><a href="conditions.html#signalling"><i class="fa fa-check"></i><b>7.5.2</b> Signalling</a></li>
<li class="chapter" data-level="7.5.3" data-path="conditions.html"><a href="conditions.html#handling"><i class="fa fa-check"></i><b>7.5.3</b> Handling</a></li>
<li class="chapter" data-level="7.5.4" data-path="conditions.html"><a href="conditions.html#exercises-24"><i class="fa fa-check"></i><b>7.5.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="conditions.html"><a href="conditions.html#condition-applications"><i class="fa fa-check"></i><b>7.6</b> Applications</a><ul>
<li class="chapter" data-level="7.6.1" data-path="conditions.html"><a href="conditions.html#failure-value"><i class="fa fa-check"></i><b>7.6.1</b> Failure value</a></li>
<li class="chapter" data-level="7.6.2" data-path="conditions.html"><a href="conditions.html#try-success-failure"><i class="fa fa-check"></i><b>7.6.2</b> Success and failure values</a></li>
<li class="chapter" data-level="7.6.3" data-path="conditions.html"><a href="conditions.html#resignal"><i class="fa fa-check"></i><b>7.6.3</b> Resignal</a></li>
<li class="chapter" data-level="7.6.4" data-path="conditions.html"><a href="conditions.html#record"><i class="fa fa-check"></i><b>7.6.4</b> Record</a></li>
<li class="chapter" data-level="7.6.5" data-path="conditions.html"><a href="conditions.html#no-default-behaviour"><i class="fa fa-check"></i><b>7.6.5</b> No default behaviour</a></li>
<li class="chapter" data-level="7.6.6" data-path="conditions.html"><a href="conditions.html#exercises-25"><i class="fa fa-check"></i><b>7.6.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="conditions.html"><a href="conditions.html#conditions-answers"><i class="fa fa-check"></i><b>7.7</b> Quiz answers</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="connections.html"><a href="connections.html"><i class="fa fa-check"></i><b>8</b> Connections</a><ul>
<li class="chapter" data-level="8.1" data-path="connections.html"><a href="connections.html#basics-1"><i class="fa fa-check"></i><b>8.1</b> Basics</a></li>
<li class="chapter" data-level="8.2" data-path="connections.html"><a href="connections.html#reading-and-writing-binary-data"><i class="fa fa-check"></i><b>8.2</b> Reading and writing binary data</a></li>
<li class="chapter" data-level="8.3" data-path="connections.html"><a href="connections.html#reading-and-writing-text-data"><i class="fa fa-check"></i><b>8.3</b> Reading and writing text data</a></li>
</ul></li>
<li class="part"><span><b>II Functional programming</b></span></li>
<li class="chapter" data-level="" data-path="fp.html"><a href="fp.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="" data-path="fp.html"><a href="fp.html#functional-programming-languages"><i class="fa fa-check"></i>Functional programming languages</a></li>
<li class="chapter" data-level="" data-path="fp.html"><a href="fp.html#functional-style"><i class="fa fa-check"></i>Functional style</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="functionals.html"><a href="functionals.html"><i class="fa fa-check"></i><b>9</b> Functionals</a><ul>
<li class="chapter" data-level="9.1" data-path="functionals.html"><a href="functionals.html#introduction-7"><i class="fa fa-check"></i><b>9.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="functionals.html"><a href="functionals.html#outline-5"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="functionals.html"><a href="functionals.html#prerequisites-3"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="functionals.html"><a href="functionals.html#map"><i class="fa fa-check"></i><b>9.2</b> My first functional: <code>map()</code></a><ul>
<li class="chapter" data-level="9.2.1" data-path="functionals.html"><a href="functionals.html#producing-atomic-vectors"><i class="fa fa-check"></i><b>9.2.1</b> Producing atomic vectors</a></li>
<li class="chapter" data-level="9.2.2" data-path="functionals.html"><a href="functionals.html#anonymous-functions-and-helpers"><i class="fa fa-check"></i><b>9.2.2</b> Anonymous functions and helpers</a></li>
<li class="chapter" data-level="9.2.3" data-path="functionals.html"><a href="functionals.html#passing-arguments"><i class="fa fa-check"></i><b>9.2.3</b> Passing arguments with <code>...</code></a></li>
<li class="chapter" data-level="9.2.4" data-path="functionals.html"><a href="functionals.html#argument-names"><i class="fa fa-check"></i><b>9.2.4</b> Argument names</a></li>
<li class="chapter" data-level="9.2.5" data-path="functionals.html"><a href="functionals.html#change-argument"><i class="fa fa-check"></i><b>9.2.5</b> Varying another argument</a></li>
<li class="chapter" data-level="9.2.6" data-path="functionals.html"><a href="functionals.html#exercises-26"><i class="fa fa-check"></i><b>9.2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="functionals.html"><a href="functionals.html#purrr-style"><i class="fa fa-check"></i><b>9.3</b> Purrr style</a></li>
<li class="chapter" data-level="9.4" data-path="functionals.html"><a href="functionals.html#functionals-loop"><i class="fa fa-check"></i><b>9.4</b> Map variants</a><ul>
<li class="chapter" data-level="9.4.1" data-path="functionals.html"><a href="functionals.html#modify"><i class="fa fa-check"></i><b>9.4.1</b> Same type of output as input: <code>modify()</code></a></li>
<li class="chapter" data-level="9.4.2" data-path="functionals.html"><a href="functionals.html#map2"><i class="fa fa-check"></i><b>9.4.2</b> Two inputs: <code>map2()</code> and friends</a></li>
<li class="chapter" data-level="9.4.3" data-path="functionals.html"><a href="functionals.html#no-outputs-walk-and-friends"><i class="fa fa-check"></i><b>9.4.3</b> No outputs: <code>walk()</code> and friends</a></li>
<li class="chapter" data-level="9.4.4" data-path="functionals.html"><a href="functionals.html#iterating-over-values-and-indices"><i class="fa fa-check"></i><b>9.4.4</b> Iterating over values and indices</a></li>
<li class="chapter" data-level="9.4.5" data-path="functionals.html"><a href="functionals.html#pmap"><i class="fa fa-check"></i><b>9.4.5</b> Any number of inputs: <code>pmap()</code> and friends</a></li>
<li class="chapter" data-level="9.4.6" data-path="functionals.html"><a href="functionals.html#exercises-27"><i class="fa fa-check"></i><b>9.4.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="functionals.html"><a href="functionals.html#reduce"><i class="fa fa-check"></i><b>9.5</b> Reduce</a><ul>
<li class="chapter" data-level="9.5.1" data-path="functionals.html"><a href="functionals.html#basics-2"><i class="fa fa-check"></i><b>9.5.1</b> Basics</a></li>
<li class="chapter" data-level="9.5.2" data-path="functionals.html"><a href="functionals.html#accumulate"><i class="fa fa-check"></i><b>9.5.2</b> Accumulate</a></li>
<li class="chapter" data-level="9.5.3" data-path="functionals.html"><a href="functionals.html#output-types"><i class="fa fa-check"></i><b>9.5.3</b> Output types</a></li>
<li class="chapter" data-level="9.5.4" data-path="functionals.html"><a href="functionals.html#multiple-inputs"><i class="fa fa-check"></i><b>9.5.4</b> Multiple inputs</a></li>
<li class="chapter" data-level="9.5.5" data-path="functionals.html"><a href="functionals.html#map-reduce"><i class="fa fa-check"></i><b>9.5.5</b> Map-reduce</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="functionals.html"><a href="functionals.html#predicate-functionals"><i class="fa fa-check"></i><b>9.6</b> Predicate functionals</a><ul>
<li class="chapter" data-level="9.6.1" data-path="functionals.html"><a href="functionals.html#basics-3"><i class="fa fa-check"></i><b>9.6.1</b> Basics</a></li>
<li class="chapter" data-level="9.6.2" data-path="functionals.html"><a href="functionals.html#predicate-map"><i class="fa fa-check"></i><b>9.6.2</b> Map variants</a></li>
<li class="chapter" data-level="9.6.3" data-path="functionals.html"><a href="functionals.html#exercises-28"><i class="fa fa-check"></i><b>9.6.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="functionals.html"><a href="functionals.html#functionals-math"><i class="fa fa-check"></i><b>9.7</b> Base functionals</a><ul>
<li class="chapter" data-level="9.7.1" data-path="functionals.html"><a href="functionals.html#matrices-and-arrays"><i class="fa fa-check"></i><b>9.7.1</b> Matrices and arrays</a></li>
<li class="chapter" data-level="9.7.2" data-path="functionals.html"><a href="functionals.html#ragged-arrays"><i class="fa fa-check"></i><b>9.7.2</b> “Ragged” arrays</a></li>
<li class="chapter" data-level="9.7.3" data-path="functionals.html"><a href="functionals.html#mathematical"><i class="fa fa-check"></i><b>9.7.3</b> Mathematical</a></li>
<li class="chapter" data-level="9.7.4" data-path="functionals.html"><a href="functionals.html#exercises-29"><i class="fa fa-check"></i><b>9.7.4</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="function-factories.html"><a href="function-factories.html"><i class="fa fa-check"></i><b>10</b> Function factories</a><ul>
<li class="chapter" data-level="10.1" data-path="function-factories.html"><a href="function-factories.html#introduction-8"><i class="fa fa-check"></i><b>10.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="function-factories.html"><a href="function-factories.html#outline-6"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="function-factories.html"><a href="function-factories.html#prerequisites-4"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="function-factories.html"><a href="function-factories.html#factory-fundamentals"><i class="fa fa-check"></i><b>10.2</b> Factory fundamentals</a><ul>
<li class="chapter" data-level="10.2.1" data-path="function-factories.html"><a href="function-factories.html#environments-1"><i class="fa fa-check"></i><b>10.2.1</b> Environments</a></li>
<li class="chapter" data-level="10.2.2" data-path="function-factories.html"><a href="function-factories.html#diagram-conventions"><i class="fa fa-check"></i><b>10.2.2</b> Diagram conventions</a></li>
<li class="chapter" data-level="10.2.3" data-path="function-factories.html"><a href="function-factories.html#stateful-funs"><i class="fa fa-check"></i><b>10.2.3</b> Stateful functions</a></li>
<li class="chapter" data-level="10.2.4" data-path="function-factories.html"><a href="function-factories.html#factory-pitfalls"><i class="fa fa-check"></i><b>10.2.4</b> Potential pitfalls</a></li>
<li class="chapter" data-level="10.2.5" data-path="function-factories.html"><a href="function-factories.html#exercises-30"><i class="fa fa-check"></i><b>10.2.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="function-factories.html"><a href="function-factories.html#graph-fact"><i class="fa fa-check"></i><b>10.3</b> Graphical factories</a><ul>
<li class="chapter" data-level="10.3.1" data-path="function-factories.html"><a href="function-factories.html#labelling"><i class="fa fa-check"></i><b>10.3.1</b> Labelling</a></li>
<li class="chapter" data-level="10.3.2" data-path="function-factories.html"><a href="function-factories.html#histogram-bins"><i class="fa fa-check"></i><b>10.3.2</b> Histogram bins</a></li>
<li class="chapter" data-level="10.3.3" data-path="function-factories.html"><a href="function-factories.html#ggsave"><i class="fa fa-check"></i><b>10.3.3</b> ggsave</a></li>
<li class="chapter" data-level="10.3.4" data-path="function-factories.html"><a href="function-factories.html#exercises-31"><i class="fa fa-check"></i><b>10.3.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="function-factories.html"><a href="function-factories.html#stat-fact"><i class="fa fa-check"></i><b>10.4</b> Statistical factories</a><ul>
<li class="chapter" data-level="10.4.1" data-path="function-factories.html"><a href="function-factories.html#box-cox-transformation"><i class="fa fa-check"></i><b>10.4.1</b> Box-Cox transformation</a></li>
<li class="chapter" data-level="10.4.2" data-path="function-factories.html"><a href="function-factories.html#bootstrap-generators"><i class="fa fa-check"></i><b>10.4.2</b> Bootstrap generators</a></li>
<li class="chapter" data-level="10.4.3" data-path="function-factories.html"><a href="function-factories.html#MLE"><i class="fa fa-check"></i><b>10.4.3</b> Maximum likelihood estimation</a></li>
<li class="chapter" data-level="10.4.4" data-path="function-factories.html"><a href="function-factories.html#exercises-32"><i class="fa fa-check"></i><b>10.4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="function-factories.html"><a href="function-factories.html#functional-factories"><i class="fa fa-check"></i><b>10.5</b> Function factories + functionals</a><ul>
<li class="chapter" data-level="10.5.1" data-path="function-factories.html"><a href="function-factories.html#moving-a-list-to-the-global-environment"><i class="fa fa-check"></i><b>10.5.1</b> Moving a list to the global environment</a></li>
<li class="chapter" data-level="10.5.2" data-path="function-factories.html"><a href="function-factories.html#another-approach"><i class="fa fa-check"></i><b>10.5.2</b> Another approach</a></li>
<li class="chapter" data-level="10.5.3" data-path="function-factories.html"><a href="function-factories.html#exercises-33"><i class="fa fa-check"></i><b>10.5.3</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="function-operators.html"><a href="function-operators.html"><i class="fa fa-check"></i><b>11</b> Function operators</a><ul>
<li class="chapter" data-level="11.1" data-path="function-operators.html"><a href="function-operators.html#introduction-9"><i class="fa fa-check"></i><b>11.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="function-operators.html"><a href="function-operators.html#outline-7"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="function-operators.html"><a href="function-operators.html#prerequisites-5"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="function-operators.html"><a href="function-operators.html#existing-fos"><i class="fa fa-check"></i><b>11.2</b> Existing FOs</a><ul>
<li class="chapter" data-level="11.2.1" data-path="function-operators.html"><a href="function-operators.html#safely"><i class="fa fa-check"></i><b>11.2.1</b> Capturing errors with <code>purrr::safely()</code></a></li>
<li class="chapter" data-level="11.2.2" data-path="function-operators.html"><a href="function-operators.html#memoise"><i class="fa fa-check"></i><b>11.2.2</b> Caching computations with <code>memoise::memoise()</code></a></li>
<li class="chapter" data-level="11.2.3" data-path="function-operators.html"><a href="function-operators.html#exercises-34"><i class="fa fa-check"></i><b>11.2.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="function-operators.html"><a href="function-operators.html#fo-case-study"><i class="fa fa-check"></i><b>11.3</b> Case study: creating your own FOs</a><ul>
<li class="chapter" data-level="11.3.1" data-path="function-operators.html"><a href="function-operators.html#exercises-35"><i class="fa fa-check"></i><b>11.3.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Object oriented programming</b></span></li>
<li class="chapter" data-level="" data-path="oo.html"><a href="oo.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="" data-path="oo.html"><a href="oo.html#oop-systems"><i class="fa fa-check"></i>OOP systems</a></li>
<li class="chapter" data-level="" data-path="oo.html"><a href="oo.html#oop-in-r"><i class="fa fa-check"></i>OOP in R</a></li>
<li class="chapter" data-level="" data-path="oo.html"><a href="oo.html#sloop"><i class="fa fa-check"></i>Sloop</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="base-types.html"><a href="base-types.html"><i class="fa fa-check"></i><b>12</b> Base types</a><ul>
<li class="chapter" data-level="12.1" data-path="base-types.html"><a href="base-types.html#introduction-10"><i class="fa fa-check"></i><b>12.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="base-types.html"><a href="base-types.html#outline-8"><i class="fa fa-check"></i>Outline</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="base-types.html"><a href="base-types.html#base-vs-oo"><i class="fa fa-check"></i><b>12.2</b> Base vs OO objects</a></li>
<li class="chapter" data-level="12.3" data-path="base-types.html"><a href="base-types.html#base-types-2"><i class="fa fa-check"></i><b>12.3</b> Base types</a><ul>
<li class="chapter" data-level="12.3.1" data-path="base-types.html"><a href="base-types.html#numeric-type"><i class="fa fa-check"></i><b>12.3.1</b> Numeric type</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="s3.html"><a href="s3.html"><i class="fa fa-check"></i><b>13</b> S3</a><ul>
<li class="chapter" data-level="13.1" data-path="s3.html"><a href="s3.html#introduction-11"><i class="fa fa-check"></i><b>13.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="s3.html"><a href="s3.html#outline-9"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="s3.html"><a href="s3.html#prerequisites-6"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="s3.html"><a href="s3.html#s3-basics"><i class="fa fa-check"></i><b>13.2</b> Basics</a><ul>
<li class="chapter" data-level="13.2.1" data-path="s3.html"><a href="s3.html#exercises-36"><i class="fa fa-check"></i><b>13.2.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="s3.html"><a href="s3.html#s3-classes"><i class="fa fa-check"></i><b>13.3</b> Classes</a><ul>
<li class="chapter" data-level="13.3.1" data-path="s3.html"><a href="s3.html#s3-constrcutor"><i class="fa fa-check"></i><b>13.3.1</b> Constructors</a></li>
<li class="chapter" data-level="13.3.2" data-path="s3.html"><a href="s3.html#validators"><i class="fa fa-check"></i><b>13.3.2</b> Validators</a></li>
<li class="chapter" data-level="13.3.3" data-path="s3.html"><a href="s3.html#helpers"><i class="fa fa-check"></i><b>13.3.3</b> Helpers</a></li>
<li class="chapter" data-level="13.3.4" data-path="s3.html"><a href="s3.html#exercises-37"><i class="fa fa-check"></i><b>13.3.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="s3.html"><a href="s3.html#s3-methods"><i class="fa fa-check"></i><b>13.4</b> Generics and methods</a><ul>
<li class="chapter" data-level="13.4.1" data-path="s3.html"><a href="s3.html#method-dispatch"><i class="fa fa-check"></i><b>13.4.1</b> Method dispatch</a></li>
<li class="chapter" data-level="13.4.2" data-path="s3.html"><a href="s3.html#finding-methods"><i class="fa fa-check"></i><b>13.4.2</b> Finding methods</a></li>
<li class="chapter" data-level="13.4.3" data-path="s3.html"><a href="s3.html#s3-arguments"><i class="fa fa-check"></i><b>13.4.3</b> Creating methods</a></li>
<li class="chapter" data-level="13.4.4" data-path="s3.html"><a href="s3.html#exercises-38"><i class="fa fa-check"></i><b>13.4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="s3.html"><a href="s3.html#object-styles"><i class="fa fa-check"></i><b>13.5</b> Object styles</a><ul>
<li class="chapter" data-level="13.5.1" data-path="s3.html"><a href="s3.html#exercises-39"><i class="fa fa-check"></i><b>13.5.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="s3.html"><a href="s3.html#s3-inheritance"><i class="fa fa-check"></i><b>13.6</b> Inheritance</a><ul>
<li class="chapter" data-level="13.6.1" data-path="s3.html"><a href="s3.html#nextmethod"><i class="fa fa-check"></i><b>13.6.1</b> <code>NextMethod()</code></a></li>
<li class="chapter" data-level="13.6.2" data-path="s3.html"><a href="s3.html#allowing-subclassing"><i class="fa fa-check"></i><b>13.6.2</b> Allowing subclassing</a></li>
<li class="chapter" data-level="13.6.3" data-path="s3.html"><a href="s3.html#exercises-40"><i class="fa fa-check"></i><b>13.6.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="s3.html"><a href="s3.html#s3-dispatch"><i class="fa fa-check"></i><b>13.7</b> Dispatch details</a><ul>
<li class="chapter" data-level="13.7.1" data-path="s3.html"><a href="s3.html#implicit-class"><i class="fa fa-check"></i><b>13.7.1</b> S3 and base types</a></li>
<li class="chapter" data-level="13.7.2" data-path="s3.html"><a href="s3.html#internal-generics"><i class="fa fa-check"></i><b>13.7.2</b> Internal generics</a></li>
<li class="chapter" data-level="13.7.3" data-path="s3.html"><a href="s3.html#group-generics"><i class="fa fa-check"></i><b>13.7.3</b> Group generics</a></li>
<li class="chapter" data-level="13.7.4" data-path="s3.html"><a href="s3.html#double-dispatch"><i class="fa fa-check"></i><b>13.7.4</b> Double dispatch</a></li>
<li class="chapter" data-level="13.7.5" data-path="s3.html"><a href="s3.html#exercises-41"><i class="fa fa-check"></i><b>13.7.5</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="r6.html"><a href="r6.html"><i class="fa fa-check"></i><b>14</b> R6</a><ul>
<li class="chapter" data-level="14.1" data-path="r6.html"><a href="r6.html#introduction-12"><i class="fa fa-check"></i><b>14.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="r6.html"><a href="r6.html#outline-10"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="r6.html"><a href="r6.html#prerequisites-7"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="r6.html"><a href="r6.html#r6-classes"><i class="fa fa-check"></i><b>14.2</b> Classes and methods</a><ul>
<li class="chapter" data-level="14.2.1" data-path="r6.html"><a href="r6.html#method-chaining"><i class="fa fa-check"></i><b>14.2.1</b> Method chaining</a></li>
<li class="chapter" data-level="14.2.2" data-path="r6.html"><a href="r6.html#important-methods"><i class="fa fa-check"></i><b>14.2.2</b> Important methods</a></li>
<li class="chapter" data-level="14.2.3" data-path="r6.html"><a href="r6.html#adding-methods-after-creation"><i class="fa fa-check"></i><b>14.2.3</b> Adding methods after creation</a></li>
<li class="chapter" data-level="14.2.4" data-path="r6.html"><a href="r6.html#inheritance"><i class="fa fa-check"></i><b>14.2.4</b> Inheritance</a></li>
<li class="chapter" data-level="14.2.5" data-path="r6.html"><a href="r6.html#introspection"><i class="fa fa-check"></i><b>14.2.5</b> Introspection</a></li>
<li class="chapter" data-level="14.2.6" data-path="r6.html"><a href="r6.html#exercises-42"><i class="fa fa-check"></i><b>14.2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="r6.html"><a href="r6.html#r6-access"><i class="fa fa-check"></i><b>14.3</b> Controlling access</a><ul>
<li class="chapter" data-level="14.3.1" data-path="r6.html"><a href="r6.html#privacy"><i class="fa fa-check"></i><b>14.3.1</b> Privacy</a></li>
<li class="chapter" data-level="14.3.2" data-path="r6.html"><a href="r6.html#active-fields"><i class="fa fa-check"></i><b>14.3.2</b> Active fields</a></li>
<li class="chapter" data-level="14.3.3" data-path="r6.html"><a href="r6.html#exercises-43"><i class="fa fa-check"></i><b>14.3.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="r6.html"><a href="r6.html#r6-semantics"><i class="fa fa-check"></i><b>14.4</b> Reference semantics</a><ul>
<li class="chapter" data-level="14.4.1" data-path="r6.html"><a href="r6.html#reasoning"><i class="fa fa-check"></i><b>14.4.1</b> Reasoning</a></li>
<li class="chapter" data-level="14.4.2" data-path="r6.html"><a href="r6.html#finalizer"><i class="fa fa-check"></i><b>14.4.2</b> Finalizer</a></li>
<li class="chapter" data-level="14.4.3" data-path="r6.html"><a href="r6.html#r6-fields"><i class="fa fa-check"></i><b>14.4.3</b> R6 fields</a></li>
<li class="chapter" data-level="14.4.4" data-path="r6.html"><a href="r6.html#exercises-44"><i class="fa fa-check"></i><b>14.4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="r6.html"><a href="r6.html#why-r6"><i class="fa fa-check"></i><b>14.5</b> Why R6?</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="s4.html"><a href="s4.html"><i class="fa fa-check"></i><b>15</b> S4</a><ul>
<li class="chapter" data-level="15.1" data-path="s4.html"><a href="s4.html#introduction-13"><i class="fa fa-check"></i><b>15.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="s4.html"><a href="s4.html#learning-more"><i class="fa fa-check"></i>Learning more</a></li>
<li class="chapter" data-level="" data-path="s4.html"><a href="s4.html#outline-11"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="s4.html"><a href="s4.html#prerequisites-8"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="s4.html"><a href="s4.html#s4-basics"><i class="fa fa-check"></i><b>15.2</b> Basics</a><ul>
<li class="chapter" data-level="15.2.1" data-path="s4.html"><a href="s4.html#exercises-45"><i class="fa fa-check"></i><b>15.2.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="s4.html"><a href="s4.html#s4-classes"><i class="fa fa-check"></i><b>15.3</b> Classes</a><ul>
<li class="chapter" data-level="15.3.1" data-path="s4.html"><a href="s4.html#inheritance-1"><i class="fa fa-check"></i><b>15.3.1</b> Inheritance</a></li>
<li class="chapter" data-level="15.3.2" data-path="s4.html"><a href="s4.html#redefinition"><i class="fa fa-check"></i><b>15.3.2</b> Redefinition</a></li>
<li class="chapter" data-level="15.3.3" data-path="s4.html"><a href="s4.html#helper"><i class="fa fa-check"></i><b>15.3.3</b> Helper</a></li>
<li class="chapter" data-level="15.3.4" data-path="s4.html"><a href="s4.html#validator"><i class="fa fa-check"></i><b>15.3.4</b> Validator</a></li>
<li class="chapter" data-level="15.3.5" data-path="s4.html"><a href="s4.html#introspection-1"><i class="fa fa-check"></i><b>15.3.5</b> Introspection</a></li>
<li class="chapter" data-level="15.3.6" data-path="s4.html"><a href="s4.html#exercises-46"><i class="fa fa-check"></i><b>15.3.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="s4.html"><a href="s4.html#s4-generics"><i class="fa fa-check"></i><b>15.4</b> Generics and methods</a><ul>
<li class="chapter" data-level="15.4.1" data-path="s4.html"><a href="s4.html#signature"><i class="fa fa-check"></i><b>15.4.1</b> Signature</a></li>
<li class="chapter" data-level="15.4.2" data-path="s4.html"><a href="s4.html#methods"><i class="fa fa-check"></i><b>15.4.2</b> Methods</a></li>
<li class="chapter" data-level="15.4.3" data-path="s4.html"><a href="s4.html#show-method"><i class="fa fa-check"></i><b>15.4.3</b> Show method</a></li>
<li class="chapter" data-level="15.4.4" data-path="s4.html"><a href="s4.html#accessors"><i class="fa fa-check"></i><b>15.4.4</b> Accessors</a></li>
<li class="chapter" data-level="15.4.5" data-path="s4.html"><a href="s4.html#introspection-2"><i class="fa fa-check"></i><b>15.4.5</b> Introspection</a></li>
<li class="chapter" data-level="15.4.6" data-path="s4.html"><a href="s4.html#exercises-47"><i class="fa fa-check"></i><b>15.4.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="s4.html"><a href="s4.html#s4-dispatch"><i class="fa fa-check"></i><b>15.5</b> Method dispatch</a><ul>
<li class="chapter" data-level="15.5.1" data-path="s4.html"><a href="s4.html#single-dispatch"><i class="fa fa-check"></i><b>15.5.1</b> Single dispatch</a></li>
<li class="chapter" data-level="15.5.2" data-path="s4.html"><a href="s4.html#multiple-inheritance"><i class="fa fa-check"></i><b>15.5.2</b> Multiple inheritance</a></li>
<li class="chapter" data-level="15.5.3" data-path="s4.html"><a href="s4.html#multiple-dispatch"><i class="fa fa-check"></i><b>15.5.3</b> Multiple dispatch</a></li>
<li class="chapter" data-level="15.5.4" data-path="s4.html"><a href="s4.html#multiple-dispatch-and-multiple-inheritance"><i class="fa fa-check"></i><b>15.5.4</b> Multiple dispatch and multiple inheritance</a></li>
<li class="chapter" data-level="15.5.5" data-path="s4.html"><a href="s4.html#exercises-48"><i class="fa fa-check"></i><b>15.5.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="s4.html"><a href="s4.html#s4-s3"><i class="fa fa-check"></i><b>15.6</b> S4 and S3</a><ul>
<li class="chapter" data-level="15.6.1" data-path="s4.html"><a href="s4.html#classes"><i class="fa fa-check"></i><b>15.6.1</b> Classes</a></li>
<li class="chapter" data-level="15.6.2" data-path="s4.html"><a href="s4.html#generics"><i class="fa fa-check"></i><b>15.6.2</b> Generics</a></li>
<li class="chapter" data-level="15.6.3" data-path="s4.html"><a href="s4.html#exercises-49"><i class="fa fa-check"></i><b>15.6.3</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html"><i class="fa fa-check"></i><b>16</b> Trade-offs</a><ul>
<li class="chapter" data-level="16.1" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html#introduction-14"><i class="fa fa-check"></i><b>16.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html#outline-12"><i class="fa fa-check"></i>Outline</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html#s3-s4"><i class="fa fa-check"></i><b>16.2</b> S4 vs S3</a></li>
<li class="chapter" data-level="16.3" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html#s3-r6"><i class="fa fa-check"></i><b>16.3</b> R6 vs S3</a><ul>
<li class="chapter" data-level="16.3.1" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html#namespacing"><i class="fa fa-check"></i><b>16.3.1</b> Namespacing</a></li>
<li class="chapter" data-level="16.3.2" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html#threading-state"><i class="fa fa-check"></i><b>16.3.2</b> Threading state</a></li>
<li class="chapter" data-level="16.3.3" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html#tradeoffs-pipe"><i class="fa fa-check"></i><b>16.3.3</b> Method chaining</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Metaprogramming</b></span></li>
<li class="chapter" data-level="" data-path="meta.html"><a href="meta.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="" data-path="meta.html"><a href="meta.html#trading-precision-for-concision"><i class="fa fa-check"></i>Trading precision for concision</a></li>
<li class="chapter" data-level="" data-path="meta.html"><a href="meta.html#domain-specific-languages"><i class="fa fa-check"></i>Domain specific languages</a></li>
<li class="chapter" data-level="" data-path="meta.html"><a href="meta.html#overview-1"><i class="fa fa-check"></i>Overview</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="expressions.html"><a href="expressions.html"><i class="fa fa-check"></i><b>17</b> Expressions</a><ul>
<li class="chapter" data-level="17.1" data-path="expressions.html"><a href="expressions.html#introduction-15"><i class="fa fa-check"></i><b>17.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="expressions.html"><a href="expressions.html#outline-13"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="expressions.html"><a href="expressions.html#prerequisites-9"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="expressions.html"><a href="expressions.html#abstract-syntax-trees"><i class="fa fa-check"></i><b>17.2</b> Abstract syntax trees</a><ul>
<li class="chapter" data-level="17.2.1" data-path="expressions.html"><a href="expressions.html#infix-vs.prefix-calls"><i class="fa fa-check"></i><b>17.2.1</b> Infix vs. prefix calls</a></li>
<li class="chapter" data-level="17.2.2" data-path="expressions.html"><a href="expressions.html#special-forms-1"><i class="fa fa-check"></i><b>17.2.2</b> Special forms</a></li>
<li class="chapter" data-level="17.2.3" data-path="expressions.html"><a href="expressions.html#function-factories-1"><i class="fa fa-check"></i><b>17.2.3</b> Function factories</a></li>
<li class="chapter" data-level="17.2.4" data-path="expressions.html"><a href="expressions.html#argument-names-1"><i class="fa fa-check"></i><b>17.2.4</b> Argument names</a></li>
<li class="chapter" data-level="17.2.5" data-path="expressions.html"><a href="expressions.html#exercises-50"><i class="fa fa-check"></i><b>17.2.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="expressions.html"><a href="expressions.html#rs-grammar"><i class="fa fa-check"></i><b>17.3</b> R’s grammar</a><ul>
<li class="chapter" data-level="17.3.1" data-path="expressions.html"><a href="expressions.html#operator-precedence"><i class="fa fa-check"></i><b>17.3.1</b> Operator precedence</a></li>
<li class="chapter" data-level="17.3.2" data-path="expressions.html"><a href="expressions.html#associativity"><i class="fa fa-check"></i><b>17.3.2</b> Associativity</a></li>
<li class="chapter" data-level="17.3.3" data-path="expressions.html"><a href="expressions.html#whitespace"><i class="fa fa-check"></i><b>17.3.3</b> Whitespace</a></li>
<li class="chapter" data-level="17.3.4" data-path="expressions.html"><a href="expressions.html#exercises-51"><i class="fa fa-check"></i><b>17.3.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="expressions.html"><a href="expressions.html#data-structures"><i class="fa fa-check"></i><b>17.4</b> Data structures</a><ul>
<li class="chapter" data-level="17.4.1" data-path="expressions.html"><a href="expressions.html#naming-conventions"><i class="fa fa-check"></i><b>17.4.1</b> Naming conventions</a></li>
<li class="chapter" data-level="17.4.2" data-path="expressions.html"><a href="expressions.html#constants"><i class="fa fa-check"></i><b>17.4.2</b> Constants</a></li>
<li class="chapter" data-level="17.4.3" data-path="expressions.html"><a href="expressions.html#symbols"><i class="fa fa-check"></i><b>17.4.3</b> Symbols</a></li>
<li class="chapter" data-level="17.4.4" data-path="expressions.html"><a href="expressions.html#calls"><i class="fa fa-check"></i><b>17.4.4</b> Calls</a></li>
<li class="chapter" data-level="17.4.5" data-path="expressions.html"><a href="expressions.html#pairlists"><i class="fa fa-check"></i><b>17.4.5</b> Pairlists</a></li>
<li class="chapter" data-level="17.4.6" data-path="expressions.html"><a href="expressions.html#expression-objects"><i class="fa fa-check"></i><b>17.4.6</b> Expression objects</a></li>
<li class="chapter" data-level="17.4.7" data-path="expressions.html"><a href="expressions.html#exercises-52"><i class="fa fa-check"></i><b>17.4.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="expressions.html"><a href="expressions.html#parsing-and-deparsing"><i class="fa fa-check"></i><b>17.5</b> Parsing and deparsing</a><ul>
<li class="chapter" data-level="17.5.1" data-path="expressions.html"><a href="expressions.html#exercises-53"><i class="fa fa-check"></i><b>17.5.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="17.6" data-path="expressions.html"><a href="expressions.html#ast-funs"><i class="fa fa-check"></i><b>17.6</b> Case study: Walking the AST with recursive functions</a><ul>
<li class="chapter" data-level="17.6.1" data-path="expressions.html"><a href="expressions.html#finding-f-and-t"><i class="fa fa-check"></i><b>17.6.1</b> Finding F and T</a></li>
<li class="chapter" data-level="17.6.2" data-path="expressions.html"><a href="expressions.html#finding-all-variables-created-by-assignment"><i class="fa fa-check"></i><b>17.6.2</b> Finding all variables created by assignment</a></li>
<li class="chapter" data-level="17.6.3" data-path="expressions.html"><a href="expressions.html#exercises-54"><i class="fa fa-check"></i><b>17.6.3</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="quasiquotation.html"><a href="quasiquotation.html"><i class="fa fa-check"></i><b>18</b> Quasiquotation</a><ul>
<li class="chapter" data-level="18.1" data-path="quasiquotation.html"><a href="quasiquotation.html#introduction-16"><i class="fa fa-check"></i><b>18.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="quasiquotation.html"><a href="quasiquotation.html#outline-14"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="quasiquotation.html"><a href="quasiquotation.html#prerequisites-10"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="quasiquotation.html"><a href="quasiquotation.html#motivation-1"><i class="fa fa-check"></i><b>18.2</b> Motivation</a><ul>
<li class="chapter" data-level="18.2.1" data-path="quasiquotation.html"><a href="quasiquotation.html#vocabulary"><i class="fa fa-check"></i><b>18.2.1</b> Vocabulary</a></li>
<li class="chapter" data-level="18.2.2" data-path="quasiquotation.html"><a href="quasiquotation.html#theory"><i class="fa fa-check"></i><b>18.2.2</b> Theory</a></li>
<li class="chapter" data-level="18.2.3" data-path="quasiquotation.html"><a href="quasiquotation.html#exercises-55"><i class="fa fa-check"></i><b>18.2.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="quasiquotation.html"><a href="quasiquotation.html#quotation"><i class="fa fa-check"></i><b>18.3</b> Quotation</a><ul>
<li class="chapter" data-level="18.3.1" data-path="quasiquotation.html"><a href="quasiquotation.html#with-rlang"><i class="fa fa-check"></i><b>18.3.1</b> With rlang</a></li>
<li class="chapter" data-level="18.3.2" data-path="quasiquotation.html"><a href="quasiquotation.html#with-base-r"><i class="fa fa-check"></i><b>18.3.2</b> With base R</a></li>
<li class="chapter" data-level="18.3.3" data-path="quasiquotation.html"><a href="quasiquotation.html#exercises-56"><i class="fa fa-check"></i><b>18.3.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="quasiquotation.html"><a href="quasiquotation.html#eval-basics"><i class="fa fa-check"></i><b>18.4</b> Evaluation</a></li>
<li class="chapter" data-level="18.5" data-path="quasiquotation.html"><a href="quasiquotation.html#unquotation"><i class="fa fa-check"></i><b>18.5</b> Unquotation</a><ul>
<li class="chapter" data-level="18.5.1" data-path="quasiquotation.html"><a href="quasiquotation.html#with-rlang-1"><i class="fa fa-check"></i><b>18.5.1</b> With rlang</a></li>
<li class="chapter" data-level="18.5.2" data-path="quasiquotation.html"><a href="quasiquotation.html#the-polite-fiction-of"><i class="fa fa-check"></i><b>18.5.2</b> The polite fiction of <code>!!</code></a></li>
<li class="chapter" data-level="18.5.3" data-path="quasiquotation.html"><a href="quasiquotation.html#unquote-base"><i class="fa fa-check"></i><b>18.5.3</b> With base R</a></li>
<li class="chapter" data-level="18.5.4" data-path="quasiquotation.html"><a href="quasiquotation.html#non-standard-asts"><i class="fa fa-check"></i><b>18.5.4</b> Non-standard ASTs</a></li>
<li class="chapter" data-level="18.5.5" data-path="quasiquotation.html"><a href="quasiquotation.html#missing-arguments-1"><i class="fa fa-check"></i><b>18.5.5</b> Missing arguments</a></li>
<li class="chapter" data-level="18.5.6" data-path="quasiquotation.html"><a href="quasiquotation.html#exercises-57"><i class="fa fa-check"></i><b>18.5.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="quasiquotation.html"><a href="quasiquotation.html#quasi-case-studies"><i class="fa fa-check"></i><b>18.6</b> Case studies</a><ul>
<li class="chapter" data-level="18.6.1" data-path="quasiquotation.html"><a href="quasiquotation.html#map-reduce-to-generate-code"><i class="fa fa-check"></i><b>18.6.1</b> Map-reduce to generate code</a></li>
<li class="chapter" data-level="18.6.2" data-path="quasiquotation.html"><a href="quasiquotation.html#partition"><i class="fa fa-check"></i><b>18.6.2</b> Partition</a></li>
<li class="chapter" data-level="18.6.3" data-path="quasiquotation.html"><a href="quasiquotation.html#slicing-an-array"><i class="fa fa-check"></i><b>18.6.3</b> Slicing an array</a></li>
<li class="chapter" data-level="18.6.4" data-path="quasiquotation.html"><a href="quasiquotation.html#quasi-function"><i class="fa fa-check"></i><b>18.6.4</b> Creating functions</a></li>
<li class="chapter" data-level="18.6.5" data-path="quasiquotation.html"><a href="quasiquotation.html#exercises-58"><i class="fa fa-check"></i><b>18.6.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="18.7" data-path="quasiquotation.html"><a href="quasiquotation.html#dot-dot-dot-..."><i class="fa fa-check"></i><b>18.7</b> Dot-dot-dot (<code>...</code>)</a><ul>
<li class="chapter" data-level="18.7.1" data-path="quasiquotation.html"><a href="quasiquotation.html#do.call"><i class="fa fa-check"></i><b>18.7.1</b> <code>do.call()</code></a></li>
<li class="chapter" data-level="18.7.2" data-path="quasiquotation.html"><a href="quasiquotation.html#the-tidyverse-approach"><i class="fa fa-check"></i><b>18.7.2</b> The tidyverse approach</a></li>
<li class="chapter" data-level="18.7.3" data-path="quasiquotation.html"><a href="quasiquotation.html#list2"><i class="fa fa-check"></i><b>18.7.3</b> <code>list2()</code></a></li>
<li class="chapter" data-level="18.7.4" data-path="quasiquotation.html"><a href="quasiquotation.html#application-invoke-and-lang"><i class="fa fa-check"></i><b>18.7.4</b> Application: <code>invoke()</code> and <code>lang()</code></a></li>
<li class="chapter" data-level="18.7.5" data-path="quasiquotation.html"><a href="quasiquotation.html#other-approaches"><i class="fa fa-check"></i><b>18.7.5</b> Other approaches</a></li>
<li class="chapter" data-level="18.7.6" data-path="quasiquotation.html"><a href="quasiquotation.html#exercises-59"><i class="fa fa-check"></i><b>18.7.6</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="evaluation.html"><a href="evaluation.html"><i class="fa fa-check"></i><b>19</b> Evaluation</a><ul>
<li class="chapter" data-level="19.1" data-path="evaluation.html"><a href="evaluation.html#introduction-17"><i class="fa fa-check"></i><b>19.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="evaluation.html"><a href="evaluation.html#outline-15"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="evaluation.html"><a href="evaluation.html#prerequisites-11"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="evaluation.html"><a href="evaluation.html#evaluation-basics"><i class="fa fa-check"></i><b>19.2</b> Evaluation basics</a><ul>
<li class="chapter" data-level="19.2.1" data-path="evaluation.html"><a href="evaluation.html#application-local"><i class="fa fa-check"></i><b>19.2.1</b> Application: <code>local()</code></a></li>
<li class="chapter" data-level="19.2.2" data-path="evaluation.html"><a href="evaluation.html#application-source"><i class="fa fa-check"></i><b>19.2.2</b> Application: <code>source()</code></a></li>
<li class="chapter" data-level="19.2.3" data-path="evaluation.html"><a href="evaluation.html#gotcha-function"><i class="fa fa-check"></i><b>19.2.3</b> Gotcha: <code>function()</code></a></li>
<li class="chapter" data-level="19.2.4" data-path="evaluation.html"><a href="evaluation.html#eval-frame"><i class="fa fa-check"></i><b>19.2.4</b> Advanced: environments vs. frames</a></li>
<li class="chapter" data-level="19.2.5" data-path="evaluation.html"><a href="evaluation.html#base-r"><i class="fa fa-check"></i><b>19.2.5</b> Base R</a></li>
<li class="chapter" data-level="19.2.6" data-path="evaluation.html"><a href="evaluation.html#exercises-60"><i class="fa fa-check"></i><b>19.2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="evaluation.html"><a href="evaluation.html#quosures"><i class="fa fa-check"></i><b>19.3</b> Quosures</a><ul>
<li class="chapter" data-level="19.3.1" data-path="evaluation.html"><a href="evaluation.html#motivation-2"><i class="fa fa-check"></i><b>19.3.1</b> Motivation</a></li>
<li class="chapter" data-level="19.3.2" data-path="evaluation.html"><a href="evaluation.html#creating-and-manipulating"><i class="fa fa-check"></i><b>19.3.2</b> Creating and manipulating</a></li>
<li class="chapter" data-level="19.3.3" data-path="evaluation.html"><a href="evaluation.html#evaluating"><i class="fa fa-check"></i><b>19.3.3</b> Evaluating</a></li>
<li class="chapter" data-level="19.3.4" data-path="evaluation.html"><a href="evaluation.html#implementation"><i class="fa fa-check"></i><b>19.3.4</b> Implementation</a></li>
<li class="chapter" data-level="19.3.5" data-path="evaluation.html"><a href="evaluation.html#when-not-to-use-quosures"><i class="fa fa-check"></i><b>19.3.5</b> When not to use quosures</a></li>
<li class="chapter" data-level="19.3.6" data-path="evaluation.html"><a href="evaluation.html#exercises-61"><i class="fa fa-check"></i><b>19.3.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="evaluation.html"><a href="evaluation.html#tidy-evaluation"><i class="fa fa-check"></i><b>19.4</b> Tidy evaluation</a><ul>
<li class="chapter" data-level="19.4.1" data-path="evaluation.html"><a href="evaluation.html#data-masks"><i class="fa fa-check"></i><b>19.4.1</b> Data masks</a></li>
<li class="chapter" data-level="19.4.2" data-path="evaluation.html"><a href="evaluation.html#subset"><i class="fa fa-check"></i><b>19.4.2</b> Application: <code>subset()</code></a></li>
<li class="chapter" data-level="19.4.3" data-path="evaluation.html"><a href="evaluation.html#application-arrange"><i class="fa fa-check"></i><b>19.4.3</b> Application: <code>arrange()</code></a></li>
<li class="chapter" data-level="19.4.4" data-path="evaluation.html"><a href="evaluation.html#ambiguity-and-pronouns"><i class="fa fa-check"></i><b>19.4.4</b> Ambiguity and pronouns</a></li>
<li class="chapter" data-level="19.4.5" data-path="evaluation.html"><a href="evaluation.html#base-subset"><i class="fa fa-check"></i><b>19.4.5</b> Base <code>subset()</code></a></li>
<li class="chapter" data-level="19.4.6" data-path="evaluation.html"><a href="evaluation.html#tidy-eval-performance"><i class="fa fa-check"></i><b>19.4.6</b> Performance</a></li>
<li class="chapter" data-level="19.4.7" data-path="evaluation.html"><a href="evaluation.html#exercises-62"><i class="fa fa-check"></i><b>19.4.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="evaluation.html"><a href="evaluation.html#wrapping-quoting-functions"><i class="fa fa-check"></i><b>19.5</b> Wrapping quoting functions</a><ul>
<li class="chapter" data-level="19.5.1" data-path="evaluation.html"><a href="evaluation.html#tidy-evaluation-1"><i class="fa fa-check"></i><b>19.5.1</b> Tidy evaluation</a></li>
<li class="chapter" data-level="19.5.2" data-path="evaluation.html"><a href="evaluation.html#base-r-1"><i class="fa fa-check"></i><b>19.5.2</b> Base R</a></li>
<li class="chapter" data-level="19.5.3" data-path="evaluation.html"><a href="evaluation.html#the-evaluation-environment"><i class="fa fa-check"></i><b>19.5.3</b> The evaluation environment</a></li>
<li class="chapter" data-level="19.5.4" data-path="evaluation.html"><a href="evaluation.html#making-formulas"><i class="fa fa-check"></i><b>19.5.4</b> Making formulas</a></li>
<li class="chapter" data-level="19.5.5" data-path="evaluation.html"><a href="evaluation.html#exercises-63"><i class="fa fa-check"></i><b>19.5.5</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="translation.html"><a href="translation.html"><i class="fa fa-check"></i><b>20</b> Translating R code</a><ul>
<li class="chapter" data-level="20.1" data-path="translation.html"><a href="translation.html#introduction-18"><i class="fa fa-check"></i><b>20.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="translation.html"><a href="translation.html#outline-16"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="translation.html"><a href="translation.html#prequisites"><i class="fa fa-check"></i>Prequisites</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="translation.html"><a href="translation.html#html"><i class="fa fa-check"></i><b>20.2</b> HTML</a><ul>
<li class="chapter" data-level="20.2.1" data-path="translation.html"><a href="translation.html#goal"><i class="fa fa-check"></i><b>20.2.1</b> Goal</a></li>
<li class="chapter" data-level="20.2.2" data-path="translation.html"><a href="translation.html#escaping"><i class="fa fa-check"></i><b>20.2.2</b> Escaping</a></li>
<li class="chapter" data-level="20.2.3" data-path="translation.html"><a href="translation.html#basic-tag-functions"><i class="fa fa-check"></i><b>20.2.3</b> Basic tag functions</a></li>
<li class="chapter" data-level="20.2.4" data-path="translation.html"><a href="translation.html#tag-functions"><i class="fa fa-check"></i><b>20.2.4</b> Tag functions</a></li>
<li class="chapter" data-level="20.2.5" data-path="translation.html"><a href="translation.html#processing-all-tags"><i class="fa fa-check"></i><b>20.2.5</b> Processing all tags</a></li>
<li class="chapter" data-level="20.2.6" data-path="translation.html"><a href="translation.html#exercises-64"><i class="fa fa-check"></i><b>20.2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="translation.html"><a href="translation.html#latex"><i class="fa fa-check"></i><b>20.3</b> LaTeX</a><ul>
<li class="chapter" data-level="20.3.1" data-path="translation.html"><a href="translation.html#latex-mathematics"><i class="fa fa-check"></i><b>20.3.1</b> LaTeX mathematics</a></li>
<li class="chapter" data-level="20.3.2" data-path="translation.html"><a href="translation.html#goal-1"><i class="fa fa-check"></i><b>20.3.2</b> Goal</a></li>
<li class="chapter" data-level="20.3.3" data-path="translation.html"><a href="translation.html#to_math"><i class="fa fa-check"></i><b>20.3.3</b> <code>to_math</code></a></li>
<li class="chapter" data-level="20.3.4" data-path="translation.html"><a href="translation.html#known-symbols"><i class="fa fa-check"></i><b>20.3.4</b> Known symbols</a></li>
<li class="chapter" data-level="20.3.5" data-path="translation.html"><a href="translation.html#unknown-symbols"><i class="fa fa-check"></i><b>20.3.5</b> Unknown symbols</a></li>
<li class="chapter" data-level="20.3.6" data-path="translation.html"><a href="translation.html#known-functions"><i class="fa fa-check"></i><b>20.3.6</b> Known functions</a></li>
<li class="chapter" data-level="20.3.7" data-path="translation.html"><a href="translation.html#unknown-functions"><i class="fa fa-check"></i><b>20.3.7</b> Unknown functions</a></li>
<li class="chapter" data-level="20.3.8" data-path="translation.html"><a href="translation.html#exercises-65"><i class="fa fa-check"></i><b>20.3.8</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>V Techniques</b></span></li>
<li class="chapter" data-level="21" data-path="debugging.html"><a href="debugging.html"><i class="fa fa-check"></i><b>21</b> Debugging</a><ul>
<li class="chapter" data-level="21.1" data-path="debugging.html"><a href="debugging.html#introduction-19"><i class="fa fa-check"></i><b>21.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="debugging.html"><a href="debugging.html#outline-17"><i class="fa fa-check"></i>Outline</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="debugging.html"><a href="debugging.html#debugging-techniques"><i class="fa fa-check"></i><b>21.2</b> Techniques</a></li>
<li class="chapter" data-level="21.3" data-path="debugging.html"><a href="debugging.html#debugging-tools"><i class="fa fa-check"></i><b>21.3</b> Tools</a><ul>
<li class="chapter" data-level="21.3.1" data-path="debugging.html"><a href="debugging.html#determining-the-sequence-of-calls"><i class="fa fa-check"></i><b>21.3.1</b> Determining the sequence of calls</a></li>
<li class="chapter" data-level="21.3.2" data-path="debugging.html"><a href="debugging.html#browsing-on-error"><i class="fa fa-check"></i><b>21.3.2</b> Browsing on error</a></li>
<li class="chapter" data-level="21.3.3" data-path="debugging.html"><a href="debugging.html#browsing-arbitrary-code"><i class="fa fa-check"></i><b>21.3.3</b> Browsing arbitrary code</a></li>
<li class="chapter" data-level="21.3.4" data-path="debugging.html"><a href="debugging.html#the-call-stack-traceback-where-and-recover"><i class="fa fa-check"></i><b>21.3.4</b> The call stack: <code>traceback()</code>, <code>where</code>, and <code>recover()</code></a></li>
<li class="chapter" data-level="21.3.5" data-path="debugging.html"><a href="debugging.html#other-types-of-failure"><i class="fa fa-check"></i><b>21.3.5</b> Other types of failure</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="performance.html"><a href="performance.html"><i class="fa fa-check"></i><b>22</b> Performance</a><ul>
<li class="chapter" data-level="22.1" data-path="performance.html"><a href="performance.html#why-is-r-slow"><i class="fa fa-check"></i><b>22.1</b> Why is R slow?</a></li>
<li class="chapter" data-level="22.2" data-path="performance.html"><a href="performance.html#microbenchmarking"><i class="fa fa-check"></i><b>22.2</b> Microbenchmarking</a><ul>
<li class="chapter" data-level="22.2.1" data-path="performance.html"><a href="performance.html#exercises-66"><i class="fa fa-check"></i><b>22.2.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="performance.html"><a href="performance.html#language-performance"><i class="fa fa-check"></i><b>22.3</b> Language performance</a><ul>
<li class="chapter" data-level="22.3.1" data-path="performance.html"><a href="performance.html#extreme-dynamism"><i class="fa fa-check"></i><b>22.3.1</b> Extreme dynamism</a></li>
<li class="chapter" data-level="22.3.2" data-path="performance.html"><a href="performance.html#name-lookup-with-mutable-environments"><i class="fa fa-check"></i><b>22.3.2</b> Name lookup with mutable environments</a></li>
<li class="chapter" data-level="22.3.3" data-path="performance.html"><a href="performance.html#lazy-evaluation-overhead"><i class="fa fa-check"></i><b>22.3.3</b> Lazy evaluation overhead</a></li>
<li class="chapter" data-level="22.3.4" data-path="performance.html"><a href="performance.html#exercises-67"><i class="fa fa-check"></i><b>22.3.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="performance.html"><a href="performance.html#implementation-performance"><i class="fa fa-check"></i><b>22.4</b> Implementation performance</a><ul>
<li class="chapter" data-level="22.4.1" data-path="performance.html"><a href="performance.html#extracting-a-single-value-from-a-data-frame"><i class="fa fa-check"></i><b>22.4.1</b> Extracting a single value from a data frame</a></li>
<li class="chapter" data-level="22.4.2" data-path="performance.html"><a href="performance.html#ifelse-pmin-and-pmax"><i class="fa fa-check"></i><b>22.4.2</b> <code>ifelse()</code>, <code>pmin()</code>, and <code>pmax()</code></a></li>
<li class="chapter" data-level="22.4.3" data-path="performance.html"><a href="performance.html#exercises-68"><i class="fa fa-check"></i><b>22.4.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="performance.html"><a href="performance.html#faster-r"><i class="fa fa-check"></i><b>22.5</b> Alternative R implementations</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="profiling.html"><a href="profiling.html"><i class="fa fa-check"></i><b>23</b> Optimising code</a><ul>
<li class="chapter" data-level="23.1" data-path="profiling.html"><a href="profiling.html#introduction-20"><i class="fa fa-check"></i><b>23.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="profiling.html"><a href="profiling.html#outline-18"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="profiling.html"><a href="profiling.html#prerequisites-12"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="23.2" data-path="profiling.html"><a href="profiling.html#measure-perf"><i class="fa fa-check"></i><b>23.2</b> Measuring performance</a><ul>
<li class="chapter" data-level="23.2.1" data-path="profiling.html"><a href="profiling.html#limitations"><i class="fa fa-check"></i><b>23.2.1</b> Limitations</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="profiling.html"><a href="profiling.html#memory-profiling"><i class="fa fa-check"></i><b>23.3</b> Memory profiling with lineprof</a><ul>
<li class="chapter" data-level="23.3.1" data-path="profiling.html"><a href="profiling.html#exercises-69"><i class="fa fa-check"></i><b>23.3.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="profiling.html"><a href="profiling.html#improve-perf"><i class="fa fa-check"></i><b>23.4</b> Improving performance</a></li>
<li class="chapter" data-level="23.5" data-path="profiling.html"><a href="profiling.html#code-organisation"><i class="fa fa-check"></i><b>23.5</b> Code organisation</a></li>
<li class="chapter" data-level="23.6" data-path="profiling.html"><a href="profiling.html#already-solved"><i class="fa fa-check"></i><b>23.6</b> Has someone already solved the problem?</a><ul>
<li class="chapter" data-level="23.6.1" data-path="profiling.html"><a href="profiling.html#exercises-70"><i class="fa fa-check"></i><b>23.6.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="23.7" data-path="profiling.html"><a href="profiling.html#be-lazy"><i class="fa fa-check"></i><b>23.7</b> Do as little as possible</a><ul>
<li class="chapter" data-level="23.7.1" data-path="profiling.html"><a href="profiling.html#exercises-71"><i class="fa fa-check"></i><b>23.7.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="23.8" data-path="profiling.html"><a href="profiling.html#vectorise"><i class="fa fa-check"></i><b>23.8</b> Vectorise</a><ul>
<li class="chapter" data-level="23.8.1" data-path="profiling.html"><a href="profiling.html#exercises-72"><i class="fa fa-check"></i><b>23.8.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="23.9" data-path="profiling.html"><a href="profiling.html#avoid-copies"><i class="fa fa-check"></i><b>23.9</b> Avoid copies</a></li>
<li class="chapter" data-level="23.10" data-path="profiling.html"><a href="profiling.html#byte-code"><i class="fa fa-check"></i><b>23.10</b> Byte code compilation</a></li>
<li class="chapter" data-level="23.11" data-path="profiling.html"><a href="profiling.html#t-test"><i class="fa fa-check"></i><b>23.11</b> Case study: t-test</a></li>
<li class="chapter" data-level="23.12" data-path="profiling.html"><a href="profiling.html#parallelise"><i class="fa fa-check"></i><b>23.12</b> Parallelise</a></li>
<li class="chapter" data-level="23.13" data-path="profiling.html"><a href="profiling.html#more-techniques"><i class="fa fa-check"></i><b>23.13</b> Other techniques</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="rcpp.html"><a href="rcpp.html"><i class="fa fa-check"></i><b>24</b> Rewriting R code in C++</a><ul>
<li class="chapter" data-level="24.1" data-path="rcpp.html"><a href="rcpp.html#introduction-21"><i class="fa fa-check"></i><b>24.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="rcpp.html"><a href="rcpp.html#outline-19"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="rcpp.html"><a href="rcpp.html#prerequistes"><i class="fa fa-check"></i>Prerequistes</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="rcpp.html"><a href="rcpp.html#rcpp-intro"><i class="fa fa-check"></i><b>24.2</b> Getting started with C++</a><ul>
<li class="chapter" data-level="24.2.1" data-path="rcpp.html"><a href="rcpp.html#no-inputs-scalar-output"><i class="fa fa-check"></i><b>24.2.1</b> No inputs, scalar output</a></li>
<li class="chapter" data-level="24.2.2" data-path="rcpp.html"><a href="rcpp.html#scalar-input-scalar-output"><i class="fa fa-check"></i><b>24.2.2</b> Scalar input, scalar output</a></li>
<li class="chapter" data-level="24.2.3" data-path="rcpp.html"><a href="rcpp.html#vector-input-scalar-output"><i class="fa fa-check"></i><b>24.2.3</b> Vector input, scalar output</a></li>
<li class="chapter" data-level="24.2.4" data-path="rcpp.html"><a href="rcpp.html#vector-input-vector-output"><i class="fa fa-check"></i><b>24.2.4</b> Vector input, vector output</a></li>
<li class="chapter" data-level="24.2.5" data-path="rcpp.html"><a href="rcpp.html#matrix-input-vector-output"><i class="fa fa-check"></i><b>24.2.5</b> Matrix input, vector output</a></li>
<li class="chapter" data-level="24.2.6" data-path="rcpp.html"><a href="rcpp.html#sourceCpp"><i class="fa fa-check"></i><b>24.2.6</b> Using sourceCpp</a></li>
<li class="chapter" data-level="24.2.7" data-path="rcpp.html"><a href="rcpp.html#exercises-73"><i class="fa fa-check"></i><b>24.2.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="24.3" data-path="rcpp.html"><a href="rcpp.html#rcpp-classes"><i class="fa fa-check"></i><b>24.3</b> Attributes and other classes</a><ul>
<li class="chapter" data-level="24.3.1" data-path="rcpp.html"><a href="rcpp.html#lists-and-data-frames"><i class="fa fa-check"></i><b>24.3.1</b> Lists and data frames</a></li>
<li class="chapter" data-level="24.3.2" data-path="rcpp.html"><a href="rcpp.html#functions-rcpp"><i class="fa fa-check"></i><b>24.3.2</b> Functions</a></li>
<li class="chapter" data-level="24.3.3" data-path="rcpp.html"><a href="rcpp.html#other-types"><i class="fa fa-check"></i><b>24.3.3</b> Other types</a></li>
</ul></li>
<li class="chapter" data-level="24.4" data-path="rcpp.html"><a href="rcpp.html#rcpp-na"><i class="fa fa-check"></i><b>24.4</b> Missing values</a><ul>
<li class="chapter" data-level="24.4.1" data-path="rcpp.html"><a href="rcpp.html#scalars-1"><i class="fa fa-check"></i><b>24.4.1</b> Scalars</a></li>
<li class="chapter" data-level="24.4.2" data-path="rcpp.html"><a href="rcpp.html#strings"><i class="fa fa-check"></i><b>24.4.2</b> Strings</a></li>
<li class="chapter" data-level="24.4.3" data-path="rcpp.html"><a href="rcpp.html#boolean"><i class="fa fa-check"></i><b>24.4.3</b> Boolean</a></li>
<li class="chapter" data-level="24.4.4" data-path="rcpp.html"><a href="rcpp.html#vectors-rcpp"><i class="fa fa-check"></i><b>24.4.4</b> Vectors</a></li>
<li class="chapter" data-level="24.4.5" data-path="rcpp.html"><a href="rcpp.html#exercises-74"><i class="fa fa-check"></i><b>24.4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="24.5" data-path="rcpp.html"><a href="rcpp.html#rcpp-sugar"><i class="fa fa-check"></i><b>24.5</b> Rcpp sugar</a><ul>
<li class="chapter" data-level="24.5.1" data-path="rcpp.html"><a href="rcpp.html#arithmetic-and-logical-operators"><i class="fa fa-check"></i><b>24.5.1</b> Arithmetic and logical operators</a></li>
<li class="chapter" data-level="24.5.2" data-path="rcpp.html"><a href="rcpp.html#logical-summary-functions"><i class="fa fa-check"></i><b>24.5.2</b> Logical summary functions</a></li>
<li class="chapter" data-level="24.5.3" data-path="rcpp.html"><a href="rcpp.html#vector-views"><i class="fa fa-check"></i><b>24.5.3</b> Vector views</a></li>
<li class="chapter" data-level="24.5.4" data-path="rcpp.html"><a href="rcpp.html#other-useful-functions"><i class="fa fa-check"></i><b>24.5.4</b> Other useful functions</a></li>
</ul></li>
<li class="chapter" data-level="24.6" data-path="rcpp.html"><a href="rcpp.html#stl"><i class="fa fa-check"></i><b>24.6</b> The STL</a><ul>
<li class="chapter" data-level="24.6.1" data-path="rcpp.html"><a href="rcpp.html#using-iterators"><i class="fa fa-check"></i><b>24.6.1</b> Using iterators</a></li>
<li class="chapter" data-level="24.6.2" data-path="rcpp.html"><a href="rcpp.html#algorithms"><i class="fa fa-check"></i><b>24.6.2</b> Algorithms</a></li>
<li class="chapter" data-level="24.6.3" data-path="rcpp.html"><a href="rcpp.html#data-structures-rcpp"><i class="fa fa-check"></i><b>24.6.3</b> Data structures</a></li>
<li class="chapter" data-level="24.6.4" data-path="rcpp.html"><a href="rcpp.html#vectors-stl"><i class="fa fa-check"></i><b>24.6.4</b> Vectors</a></li>
<li class="chapter" data-level="24.6.5" data-path="rcpp.html"><a href="rcpp.html#sets"><i class="fa fa-check"></i><b>24.6.5</b> Sets</a></li>
<li class="chapter" data-level="24.6.6" data-path="rcpp.html"><a href="rcpp.html#map-1"><i class="fa fa-check"></i><b>24.6.6</b> Map</a></li>
<li class="chapter" data-level="24.6.7" data-path="rcpp.html"><a href="rcpp.html#exercises-75"><i class="fa fa-check"></i><b>24.6.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="24.7" data-path="rcpp.html"><a href="rcpp.html#rcpp-case-studies"><i class="fa fa-check"></i><b>24.7</b> Case studies</a><ul>
<li class="chapter" data-level="24.7.1" data-path="rcpp.html"><a href="rcpp.html#gibbs-sampler"><i class="fa fa-check"></i><b>24.7.1</b> Gibbs sampler</a></li>
<li class="chapter" data-level="24.7.2" data-path="rcpp.html"><a href="rcpp.html#r-vectorisation-vs.c-vectorisation"><i class="fa fa-check"></i><b>24.7.2</b> R vectorisation vs. C++ vectorisation</a></li>
</ul></li>
<li class="chapter" data-level="24.8" data-path="rcpp.html"><a href="rcpp.html#rcpp-package"><i class="fa fa-check"></i><b>24.8</b> Using Rcpp in a package</a></li>
<li class="chapter" data-level="24.9" data-path="rcpp.html"><a href="rcpp.html#rcpp-more"><i class="fa fa-check"></i><b>24.9</b> Learning more</a></li>
<li class="chapter" data-level="24.10" data-path="rcpp.html"><a href="rcpp.html#acknowledgments"><i class="fa fa-check"></i><b>24.10</b> Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown">
Proudly published with bookdown</a></li>
<li><a href="https://github.com/hadley/adv-r">Forked from Hadley</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Advanced R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="r6" class="section level1">
<h1><span class="header-section-number">14</span> R6</h1>
<div id="introduction-12" class="section level2">
<h2><span class="header-section-number">14.1</span> Introduction</h2>
<p>This chapter describes the R6 object system, which is built on top of environments and S3.
R6 is an encapsulated OOP system which means that methods belong to objects, not generics, and you call them like <code>object$method()</code>. R6 objects are also <strong>mutable</strong>, which means that they are modified in place, and hence have reference semantics.</p>
<p>If you’ve learned OOP in another programming language, it’s likely that R6 will feel very natural, and you’ll be inclined to prefer it over S3. Resist the temptation to follow the path of least resistance: as in most cases R6 will lead you to non-idiomatic R code. We’ll come back to this theme in Section <a href="oo-tradeoffs.html#s3-r6">16.3</a>.</p>
<p>R6 is very similar to a base OOP system called <strong>reference classes</strong>, or RC for short. I describe why I teach R6 and not RC in Section <a href="r6.html#why-r6">14.5</a>.</p>
<div id="outline-10" class="section level3 unnumbered">
<h3>Outline</h3>
<ul>
<li><p>Section <a href="r6.html#r6-classes">14.2</a> introduces <code>R6::R6class()</code>, the one function that
you need to know to create R6 classes. You’ll learn about the constructor
method, <code>$new()</code>, which allows you to create R6 objects, and important
R6 methods <code>$initialize()</code> and <code>$print()</code>.</p></li>
<li><p>Section <a href="r6.html#r6-access">14.3</a> discusses the access mechanisms of R6: private and
active fields. Together, these allow you to hide data from the user, or
expose private data for reading but not writing.</p></li>
<li><p>Section <a href="r6.html#r6-semantics">14.4</a> explores the consequnces of R6’s reference
semantics. You’ll learn about the use of finalizers to automatically
clean up any operations performed in the intializer, and a common gotcha
if you use an R6 object as a field in another R6 object.</p></li>
<li><p>Section <a href="r6.html#why-r6">14.5</a> describes why I cover R6, rather than the base RC
system.</p></li>
</ul>
</div>
<div id="prerequisites-7" class="section level3 unnumbered">
<h3>Prerequisites</h3>
<p>Because R6 is not built into base R, you’ll need to install and load the R6 package to use it:</p>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb560-1" data-line-number="1"><span class="co"># install.packages(&quot;R6&quot;)</span></a>
<a class="sourceLine" id="cb560-2" data-line-number="2"><span class="kw">library</span>(R6)</a></code></pre></div>
<p>R6 objects have reference semantics which means that they are modified in-place, not copied-on-modify. Make sure you’re familiar with these distinctions as described in Section <a href="names-values.html#modify-in-place">2.5</a>.</p>
</div>
</div>
<div id="r6-classes" class="section level2">
<h2><span class="header-section-number">14.2</span> Classes and methods</h2>
<p>R6 only needs a single function call to create both the class and its methods: <code>R6::R6Class()</code>. This is the only function from the package that you’ll ever use!<a href="#fn47" class="footnote-ref" id="fnref47"><sup>47</sup></a></p>
<p>The following example shows the two most important arguments to `R6Class():</p>
<ul>
<li><p>The first argument is the <code>classname</code>. It’s not strictly needed, but it
improves error messages and makes it possible to use R6 objects with S3
generics. By convention, R6 classes have UpperCamelCase names.</p></li>
<li><p>The second argument, <code>public</code>, supplies a list of methods (functions) and
fields (anything else) that make up the public interface of the object.
By convention, methods and fields use snake_case. Methods can access
the methods and fields of the current object via <code>self$</code>.<a href="#fn48" class="footnote-ref" id="fnref48"><sup>48</sup></a></p></li>
</ul>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb561-1" data-line-number="1">Accumulator &lt;-<span class="st"> </span><span class="kw">R6Class</span>(<span class="st">&quot;Accumulator&quot;</span>, <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb561-2" data-line-number="2">  <span class="dt">sum =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb561-3" data-line-number="3">  <span class="dt">add =</span> <span class="cf">function</span>(<span class="dt">x =</span> <span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb561-4" data-line-number="4">    self<span class="op">$</span>sum &lt;-<span class="st"> </span>self<span class="op">$</span>sum <span class="op">+</span><span class="st"> </span>x </a>
<a class="sourceLine" id="cb561-5" data-line-number="5">    <span class="kw">invisible</span>(self)</a>
<a class="sourceLine" id="cb561-6" data-line-number="6">  })</a>
<a class="sourceLine" id="cb561-7" data-line-number="7">)</a></code></pre></div>
<p>You should always assign the result of <code>R6Class()</code> into a variable with the same name as the class, because <code>R6Class()</code> returns an R6 object that defines the class:</p>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb562-1" data-line-number="1">Accumulator</a>
<a class="sourceLine" id="cb562-2" data-line-number="2"><span class="co">#&gt; &lt;Accumulator&gt; object generator</span></a>
<a class="sourceLine" id="cb562-3" data-line-number="3"><span class="co">#&gt;   Public:</span></a>
<a class="sourceLine" id="cb562-4" data-line-number="4"><span class="co">#&gt;     sum: 0</span></a>
<a class="sourceLine" id="cb562-5" data-line-number="5"><span class="co">#&gt;     add: function (x = 1) </span></a>
<a class="sourceLine" id="cb562-6" data-line-number="6"><span class="co">#&gt;     clone: function (deep = FALSE) </span></a>
<a class="sourceLine" id="cb562-7" data-line-number="7"><span class="co">#&gt;   Parent env: &lt;environment: R_GlobalEnv&gt;</span></a>
<a class="sourceLine" id="cb562-8" data-line-number="8"><span class="co">#&gt;   Locked objects: TRUE</span></a>
<a class="sourceLine" id="cb562-9" data-line-number="9"><span class="co">#&gt;   Locked class: FALSE</span></a>
<a class="sourceLine" id="cb562-10" data-line-number="10"><span class="co">#&gt;   Portable: TRUE</span></a></code></pre></div>
<p>You construct a new object from the class by calling the <code>new()</code> method. In R6, methods belong to objects, so you use <code>$</code> to access <code>new()</code>:</p>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb563-1" data-line-number="1">x &lt;-<span class="st"> </span>Accumulator<span class="op">$</span><span class="kw">new</span>() </a></code></pre></div>
<p>You can then call methods and access fields with <code>$</code>:</p>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb564-1" data-line-number="1">x<span class="op">$</span><span class="kw">add</span>(<span class="dv">4</span>) </a>
<a class="sourceLine" id="cb564-2" data-line-number="2">x<span class="op">$</span>sum</a>
<a class="sourceLine" id="cb564-3" data-line-number="3"><span class="co">#&gt; [1] 4</span></a></code></pre></div>
<p>In this class, the fields and methods are public, which means that you can get or set the value of any field. Later, we’ll see how to use private fields and methods to prevent casual access to the internals of your class.</p>
<p>To make it clear when we’re talking about fields and methods as opposed to variables and functions, I’ll prefix their names with <code>$</code>. For example, the <code>Accumulate</code> class has field <code>$sum</code> and method <code>$add()</code>.</p>
<div id="method-chaining" class="section level3">
<h3><span class="header-section-number">14.2.1</span> Method chaining</h3>
<p><code>$add()</code> is called primarily for its side-effect of updating <code>$sum</code>.</p>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb565-1" data-line-number="1">Accumulator &lt;-<span class="st"> </span><span class="kw">R6Class</span>(<span class="st">&quot;Accumulator&quot;</span>, <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb565-2" data-line-number="2">  <span class="dt">sum =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb565-3" data-line-number="3">  <span class="dt">add =</span> <span class="cf">function</span>(<span class="dt">x =</span> <span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb565-4" data-line-number="4">    self<span class="op">$</span>sum &lt;-<span class="st"> </span>self<span class="op">$</span>sum <span class="op">+</span><span class="st"> </span>x </a>
<a class="sourceLine" id="cb565-5" data-line-number="5">    <span class="kw">invisible</span>(self)</a>
<a class="sourceLine" id="cb565-6" data-line-number="6">  })</a>
<a class="sourceLine" id="cb565-7" data-line-number="7">)</a></code></pre></div>
<p>Side-effect R6 methods should always return <code>self</code> invisibly. This returns the “current” object and makes it possible to chain together multiple method calls:</p>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb566-1" data-line-number="1">x<span class="op">$</span><span class="kw">add</span>(<span class="dv">10</span>)<span class="op">$</span><span class="kw">add</span>(<span class="dv">10</span>)<span class="op">$</span>sum</a>
<a class="sourceLine" id="cb566-2" data-line-number="2"><span class="co">#&gt; [1] 24</span></a></code></pre></div>
<p>For, readability, you might put one method call on each line:</p>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb567-1" data-line-number="1">x<span class="op">$</span></a>
<a class="sourceLine" id="cb567-2" data-line-number="2"><span class="st">  </span><span class="kw">add</span>(<span class="dv">10</span>)<span class="op">$</span></a>
<a class="sourceLine" id="cb567-3" data-line-number="3"><span class="st">  </span><span class="kw">add</span>(<span class="dv">10</span>)<span class="op">$</span></a>
<a class="sourceLine" id="cb567-4" data-line-number="4"><span class="st">  </span>sum</a>
<a class="sourceLine" id="cb567-5" data-line-number="5"><span class="co">#&gt; [1] 44</span></a></code></pre></div>
<p>This technique is called <strong>method chaining</strong> and is commonly used in languages like Python and JavaScript. Method chaining is deeply related to the pipe, and we’ll discuss the pros and cons of each approach in Section <a href="oo-tradeoffs.html#tradeoffs-pipe">16.3.3</a>.</p>
</div>
<div id="important-methods" class="section level3">
<h3><span class="header-section-number">14.2.2</span> Important methods</h3>
<p>There are two important methods that will be defined for most classes: <code>$initialize()</code> and <code>$print()</code>. They’re not required, but providing them will make your class easier to use.</p>
<p><code>$initialize()</code> overrides the default behaviour of <code>$new()</code>. For example, the following code defines an Person class with fields <code>$name</code> and <code>$age</code>. To ensure that that <code>$name</code> is always a single string, and <code>$age</code> is always a single number, I added checks in <code>$initialize()</code>.</p>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb568-1" data-line-number="1">Person &lt;-<span class="st"> </span><span class="kw">R6Class</span>(<span class="st">&quot;Person&quot;</span>, <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb568-2" data-line-number="2">  <span class="dt">name =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb568-3" data-line-number="3">  <span class="dt">age =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb568-4" data-line-number="4">  <span class="dt">initialize =</span> <span class="cf">function</span>(name, <span class="dt">age =</span> <span class="ot">NA</span>) {</a>
<a class="sourceLine" id="cb568-5" data-line-number="5">    <span class="kw">stopifnot</span>(<span class="kw">is.character</span>(name), <span class="kw">length</span>(name) <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb568-6" data-line-number="6">    <span class="kw">stopifnot</span>(<span class="kw">is.numeric</span>(age), <span class="kw">length</span>(age) <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb568-7" data-line-number="7">    </a>
<a class="sourceLine" id="cb568-8" data-line-number="8">    self<span class="op">$</span>name &lt;-<span class="st"> </span>name</a>
<a class="sourceLine" id="cb568-9" data-line-number="9">    self<span class="op">$</span>age &lt;-<span class="st"> </span>age</a>
<a class="sourceLine" id="cb568-10" data-line-number="10">  }</a>
<a class="sourceLine" id="cb568-11" data-line-number="11">))</a>
<a class="sourceLine" id="cb568-12" data-line-number="12"></a>
<a class="sourceLine" id="cb568-13" data-line-number="13">hadley &lt;-<span class="st"> </span>Person<span class="op">$</span><span class="kw">new</span>(<span class="st">&quot;Hadley&quot;</span>, <span class="dt">age =</span> <span class="st">&quot;thirty-eight&quot;</span>)</a>
<a class="sourceLine" id="cb568-14" data-line-number="14"><span class="co">#&gt; Error in .subset2(public_bind_env, &quot;initialize&quot;)(...):</span></a>
<a class="sourceLine" id="cb568-15" data-line-number="15"><span class="co">#&gt;   is.numeric(age) is not TRUE</span></a>
<a class="sourceLine" id="cb568-16" data-line-number="16"></a>
<a class="sourceLine" id="cb568-17" data-line-number="17">hadley &lt;-<span class="st"> </span>Person<span class="op">$</span><span class="kw">new</span>(<span class="st">&quot;Hadley&quot;</span>, <span class="dt">age =</span> <span class="dv">38</span>)</a></code></pre></div>
<p>If you have more expensive validation requirements, implement them in a separate <code>$validate()</code> and only call when needed.</p>
<p>Defining <code>$print()</code> allows you to override the default printing behaviour. As with any R6 method called for its side effects, <code>$print()</code> should return <code>invisible(self)</code>.</p>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb569-1" data-line-number="1">Person &lt;-<span class="st"> </span><span class="kw">R6Class</span>(<span class="st">&quot;Person&quot;</span>, <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb569-2" data-line-number="2">  <span class="dt">name =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb569-3" data-line-number="3">  <span class="dt">age =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb569-4" data-line-number="4">  <span class="dt">initialize =</span> <span class="cf">function</span>(name, <span class="dt">age =</span> <span class="ot">NA</span>) {</a>
<a class="sourceLine" id="cb569-5" data-line-number="5">    self<span class="op">$</span>name &lt;-<span class="st"> </span>name</a>
<a class="sourceLine" id="cb569-6" data-line-number="6">    self<span class="op">$</span>age &lt;-<span class="st"> </span>age</a>
<a class="sourceLine" id="cb569-7" data-line-number="7">  },</a>
<a class="sourceLine" id="cb569-8" data-line-number="8">  <span class="dt">print =</span> <span class="cf">function</span>(...) {</a>
<a class="sourceLine" id="cb569-9" data-line-number="9">    <span class="kw">cat</span>(<span class="st">&quot;Person: </span><span class="ch">\n</span><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb569-10" data-line-number="10">    <span class="kw">cat</span>(<span class="st">&quot;  Name: &quot;</span>, self<span class="op">$</span>name, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb569-11" data-line-number="11">    <span class="kw">cat</span>(<span class="st">&quot;  Age:  &quot;</span>, self<span class="op">$</span>age, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb569-12" data-line-number="12">    <span class="kw">invisible</span>(self)</a>
<a class="sourceLine" id="cb569-13" data-line-number="13">  }</a>
<a class="sourceLine" id="cb569-14" data-line-number="14">))</a>
<a class="sourceLine" id="cb569-15" data-line-number="15"></a>
<a class="sourceLine" id="cb569-16" data-line-number="16">hadley2 &lt;-<span class="st"> </span>Person<span class="op">$</span><span class="kw">new</span>(<span class="st">&quot;Hadley&quot;</span>)</a>
<a class="sourceLine" id="cb569-17" data-line-number="17">hadley2</a>
<a class="sourceLine" id="cb569-18" data-line-number="18"><span class="co">#&gt; Person: </span></a>
<a class="sourceLine" id="cb569-19" data-line-number="19"><span class="co">#&gt;   Name: Hadley</span></a>
<a class="sourceLine" id="cb569-20" data-line-number="20"><span class="co">#&gt;   Age:  NA</span></a></code></pre></div>
<p>This code illustrates an important aspect of R6. Because methods are bound to individual objects, the previously created <code>hadley</code> object does not get this new method:</p>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb570-1" data-line-number="1">hadley</a>
<a class="sourceLine" id="cb570-2" data-line-number="2"><span class="co">#&gt; &lt;Person&gt;</span></a>
<a class="sourceLine" id="cb570-3" data-line-number="3"><span class="co">#&gt;   Public:</span></a>
<a class="sourceLine" id="cb570-4" data-line-number="4"><span class="co">#&gt;     age: 38</span></a>
<a class="sourceLine" id="cb570-5" data-line-number="5"><span class="co">#&gt;     clone: function (deep = FALSE) </span></a>
<a class="sourceLine" id="cb570-6" data-line-number="6"><span class="co">#&gt;     initialize: function (name, age = NA) </span></a>
<a class="sourceLine" id="cb570-7" data-line-number="7"><span class="co">#&gt;     name: Hadley</span></a>
<a class="sourceLine" id="cb570-8" data-line-number="8"></a>
<a class="sourceLine" id="cb570-9" data-line-number="9">hadley<span class="op">$</span>print</a>
<a class="sourceLine" id="cb570-10" data-line-number="10"><span class="co">#&gt; NULL</span></a></code></pre></div>
<p>From the perspective of R6, there is no relationship between <code>hadley</code> and <code>hadley2</code>; they just coincidentally share the same class name. This doesn’t cause problems when using already developed R6 problems but can make interactive experimentation confusing. If you’re changing the code and can’t figure out why the results of method calls aren’t changed, make sure you’ve re-constructed R6 objects with the new class.</p>
</div>
<div id="adding-methods-after-creation" class="section level3">
<h3><span class="header-section-number">14.2.3</span> Adding methods after creation</h3>
<p>Instead of continuously creating new classes, it’s also possible to modify the fields and methods of an existing class. This is useful when exploring interactively, or when you have a class with many functions that you’d like to break up into pieces. Add new elements to an existing class with <code>$set()</code>, supplying the visibility (more on in Section <a href="r6.html#r6-access">14.3</a>), the name, and the component.</p>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb571-1" data-line-number="1">Accumulator &lt;-<span class="st"> </span><span class="kw">R6Class</span>(<span class="st">&quot;Accumulator&quot;</span>)</a>
<a class="sourceLine" id="cb571-2" data-line-number="2">Accumulator<span class="op">$</span><span class="kw">set</span>(<span class="st">&quot;public&quot;</span>, <span class="st">&quot;sum&quot;</span>, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb571-3" data-line-number="3">Accumulator<span class="op">$</span><span class="kw">set</span>(<span class="st">&quot;public&quot;</span>, <span class="st">&quot;add&quot;</span>, <span class="cf">function</span>(<span class="dt">x =</span> <span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb571-4" data-line-number="4">  self<span class="op">$</span>sum &lt;-<span class="st"> </span>self<span class="op">$</span>sum <span class="op">+</span><span class="st"> </span>x </a>
<a class="sourceLine" id="cb571-5" data-line-number="5">})</a></code></pre></div>
<p>As above, new methods and fields are only available to new objects; they are not retrospectively added to existing objects.</p>
</div>
<div id="inheritance" class="section level3">
<h3><span class="header-section-number">14.2.4</span> Inheritance</h3>
<p>To inherit behaviour from an existing class, provide the class object to the <code>inherit</code> argument:</p>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb572-1" data-line-number="1">AccumulatorChatty &lt;-<span class="st"> </span><span class="kw">R6Class</span>(<span class="st">&quot;AccumulatorChatty&quot;</span>, </a>
<a class="sourceLine" id="cb572-2" data-line-number="2">  <span class="dt">inherit =</span> Accumulator,</a>
<a class="sourceLine" id="cb572-3" data-line-number="3">  <span class="dt">public =</span> <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb572-4" data-line-number="4">    <span class="dt">add =</span> <span class="cf">function</span>(<span class="dt">x =</span> <span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb572-5" data-line-number="5">      <span class="kw">cat</span>(<span class="st">&quot;Adding &quot;</span>, x, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb572-6" data-line-number="6">      super<span class="op">$</span><span class="kw">add</span>(<span class="dt">x =</span> x)</a>
<a class="sourceLine" id="cb572-7" data-line-number="7">    }</a>
<a class="sourceLine" id="cb572-8" data-line-number="8">  )</a>
<a class="sourceLine" id="cb572-9" data-line-number="9">)</a>
<a class="sourceLine" id="cb572-10" data-line-number="10"></a>
<a class="sourceLine" id="cb572-11" data-line-number="11">x2 &lt;-<span class="st"> </span>AccumulatorChatty<span class="op">$</span><span class="kw">new</span>()</a>
<a class="sourceLine" id="cb572-12" data-line-number="12">x2<span class="op">$</span><span class="kw">add</span>(<span class="dv">10</span>)<span class="op">$</span><span class="kw">add</span>(<span class="dv">1</span>)<span class="op">$</span>sum</a>
<a class="sourceLine" id="cb572-13" data-line-number="13"><span class="co">#&gt; Adding 10</span></a>
<a class="sourceLine" id="cb572-14" data-line-number="14"><span class="co">#&gt; Adding 1</span></a>
<a class="sourceLine" id="cb572-15" data-line-number="15"><span class="co">#&gt; [1] 11</span></a></code></pre></div>
<p>Note that <code>$add()</code> overrides the implementation in the superclass, but we can delegate to the superclass implementation through <code>super$</code>. (This is analagous to <code>NextMethod()</code> in S3, as discussed in Section <a href="s3.html#s3-inheritance">13.6</a>.) Any methods which are overridden will automatically call the implementation in the parent class.</p>
</div>
<div id="introspection" class="section level3">
<h3><span class="header-section-number">14.2.5</span> Introspection</h3>
<p>Every R6 object has an S3 class that reflects its hierarchy of R6 classes. This means that the easiest way to determine the class (and all classes it inherits from) is to use <code>class()</code>:</p>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb573-1" data-line-number="1"><span class="kw">class</span>(hadley2)</a>
<a class="sourceLine" id="cb573-2" data-line-number="2"><span class="co">#&gt; [1] &quot;Person&quot; &quot;R6&quot;</span></a></code></pre></div>
<p>The S3 hierarchy includes the base “R6” class. This provides common behaviour, including a <code>print.R6()</code> method which calls <code>$print()</code>, as described above.</p>
<p>You can list all methods and fields with <code>names()</code>:</p>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb574-1" data-line-number="1"><span class="kw">names</span>(hadley2)</a>
<a class="sourceLine" id="cb574-2" data-line-number="2"><span class="co">#&gt; [1] &quot;.__enclos_env__&quot; &quot;age&quot;             &quot;name&quot;            &quot;clone&quot;          </span></a>
<a class="sourceLine" id="cb574-3" data-line-number="3"><span class="co">#&gt; [5] &quot;print&quot;           &quot;initialize&quot;</span></a></code></pre></div>
<p>We defined <code>$name</code>, <code>$age</code>, <code>$print</code>, and <code>$initialize</code>. As suggested by the name <code>.__enclos_env__</code> is an internal implementation detail that you shouldn’t touch; we’ll come to <code>$clone()</code> in Section <a href="r6.html#r6-semantics">14.4</a>.</p>
</div>
<div id="exercises-42" class="section level3">
<h3><span class="header-section-number">14.2.6</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li><p>Create a bank account R6 class that stores a balance and allows you to
deposit and withdraw money. Create a subclass that throws an error
if you attempt to go into overdraft. Create another subclass that allows
you to go into overdraft, but charges you a fee.</p></li>
<li><p>Create an R6 class that represents a shuffled deck of cards. You should be
able to draw cards from the deck with <code>$draw(n)</code>, and return all cards to
the deck and reshuffle with <code>$reshuffle()</code>. Use the following code to make
a vector of cards.</p>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb575-1" data-line-number="1">suit &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;♠&quot;</span>, <span class="st">&quot;♥&quot;</span>, <span class="st">&quot;♦&quot;</span>, <span class="st">&quot;♣&quot;</span>)</a>
<a class="sourceLine" id="cb575-2" data-line-number="2">value &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="dv">2</span><span class="op">:</span><span class="dv">10</span>, <span class="st">&quot;J&quot;</span>, <span class="st">&quot;Q&quot;</span>, <span class="st">&quot;K&quot;</span>)</a>
<a class="sourceLine" id="cb575-3" data-line-number="3">cards &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">rep</span>(value, <span class="dv">4</span>), suit)</a></code></pre></div></li>
<li><p>Why can’t you model a bank account or a deck of cards with an S3 class?</p></li>
<li><p>Create an R6 class that allows you to get and set the current timezone.
You can access the current timezone with <code>Sys.timezone()</code> and set it
with <code>Sys.setenv(TZ = &quot;newtimezone&quot;)</code>. When setting the time zone, make
sure the new time zone is in the list provided by <code>OlsonNames()</code>.</p></li>
<li><p>Create an R6 class that manages the current working directory.
It should have <code>$get()</code> and <code>$set()</code> methods.</p></li>
<li><p>Why can’t you model the time zone or current working directory with an S3
class?</p></li>
</ol>
</div>
</div>
<div id="r6-access" class="section level2">
<h2><span class="header-section-number">14.3</span> Controlling access</h2>
<p><code>R6Class()</code> has two other arguments that work similarly to <code>public</code>:</p>
<ul>
<li><p><code>private</code> allows you to create fields and methods that are only available
from within the class, not outside of it.</p></li>
<li><p><code>active</code> allows you to use accessor functions to define dynamic, or
active, fields.</p></li>
</ul>
<p>These are described in the following sections.</p>
<div id="privacy" class="section level3">
<h3><span class="header-section-number">14.3.1</span> Privacy</h3>
<p>With R6 you can define <strong>private</strong> fields and methods, elements that can only be accessed from within the class, not from the outside<a href="#fn49" class="footnote-ref" id="fnref49"><sup>49</sup></a>. There are two things that you need to know to take advantage of private elements:</p>
<ul>
<li><p>The <code>private</code> argument to <code>R6Class</code> works in the same way as the <code>public</code>
argument: you give it a named list of methods (functions) and fields
(everything else).</p></li>
<li><p>Fields and methods defined in <code>private</code> are available within the methods
using <code>private$</code> instead of <code>self$</code>. You cannot access private fields or
methods outside of the class.</p></li>
</ul>
<p>To make this concrete, we could make <code>$age</code> and <code>$name</code> fields of the Person class private. With this definition of <code>Person</code> we can only set <code>$age</code> and <code>$name</code> during object creation, and we cannot access their values from outside of the class.</p>
<div class="sourceCode" id="cb576"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb576-1" data-line-number="1">Person &lt;-<span class="st"> </span><span class="kw">R6Class</span>(<span class="st">&quot;Person&quot;</span>, </a>
<a class="sourceLine" id="cb576-2" data-line-number="2">  <span class="dt">public =</span> <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb576-3" data-line-number="3">    <span class="dt">initialize =</span> <span class="cf">function</span>(name, <span class="dt">age =</span> <span class="ot">NA</span>) {</a>
<a class="sourceLine" id="cb576-4" data-line-number="4">      private<span class="op">$</span>name &lt;-<span class="st"> </span>name</a>
<a class="sourceLine" id="cb576-5" data-line-number="5">      private<span class="op">$</span>age &lt;-<span class="st"> </span>age</a>
<a class="sourceLine" id="cb576-6" data-line-number="6">    },</a>
<a class="sourceLine" id="cb576-7" data-line-number="7">    <span class="dt">print =</span> <span class="cf">function</span>(...) {</a>
<a class="sourceLine" id="cb576-8" data-line-number="8">      <span class="kw">cat</span>(<span class="st">&quot;Person: </span><span class="ch">\n</span><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb576-9" data-line-number="9">      <span class="kw">cat</span>(<span class="st">&quot;  Name: &quot;</span>, private<span class="op">$</span>name, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb576-10" data-line-number="10">      <span class="kw">cat</span>(<span class="st">&quot;  Age:  &quot;</span>, private<span class="op">$</span>age, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb576-11" data-line-number="11">    }</a>
<a class="sourceLine" id="cb576-12" data-line-number="12">  ),</a>
<a class="sourceLine" id="cb576-13" data-line-number="13">  <span class="dt">private =</span> <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb576-14" data-line-number="14">    <span class="dt">age =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb576-15" data-line-number="15">    <span class="dt">name =</span> <span class="ot">NULL</span></a>
<a class="sourceLine" id="cb576-16" data-line-number="16">  )</a>
<a class="sourceLine" id="cb576-17" data-line-number="17">)</a>
<a class="sourceLine" id="cb576-18" data-line-number="18"></a>
<a class="sourceLine" id="cb576-19" data-line-number="19">hadley3 &lt;-<span class="st"> </span>Person<span class="op">$</span><span class="kw">new</span>(<span class="st">&quot;Hadley&quot;</span>)</a>
<a class="sourceLine" id="cb576-20" data-line-number="20">hadley3<span class="op">$</span>name</a>
<a class="sourceLine" id="cb576-21" data-line-number="21"><span class="co">#&gt; NULL</span></a></code></pre></div>
<p>The distinction between public and private fields is important when you create complex networks of classes, and you want to make it as clear as possible what it’s ok for others to access. Anything that’s private can be more easily refactored because you know others aren’t relying on it. Private methods tend to be less important in R compared to other programming languages because the object hierarchies in R tend to be simpler.</p>
</div>
<div id="active-fields" class="section level3">
<h3><span class="header-section-number">14.3.2</span> Active fields</h3>
<p>Active fields allow you to define components that look like fields from the outside, but are defined with functions, like methods. Active fields are implemented using <strong>active bindings</strong> (see Section <a href="environments.html#advanced-bindings">6.2.7</a> for details). Each active binding must be a function that takes a single argument: <code>value</code>. If the argument is <code>missing()</code>, the value is being retrieved; otherwise it’s being modified.</p>
<p>For example, you could make an active field <code>random</code> that returns a different value every time you access it:</p>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb577-1" data-line-number="1">Rando &lt;-<span class="st"> </span>R6<span class="op">::</span><span class="kw">R6Class</span>(<span class="st">&quot;Rando&quot;</span>, <span class="dt">active =</span> <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb577-2" data-line-number="2">  <span class="dt">random =</span> <span class="cf">function</span>(value) {</a>
<a class="sourceLine" id="cb577-3" data-line-number="3">    <span class="cf">if</span> (<span class="kw">missing</span>(value)) {</a>
<a class="sourceLine" id="cb577-4" data-line-number="4">      <span class="kw">runif</span>(<span class="dv">1</span>)  </a>
<a class="sourceLine" id="cb577-5" data-line-number="5">    } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb577-6" data-line-number="6">      <span class="kw">stop</span>(<span class="st">&quot;Can&#39;t set `$random`&quot;</span>, <span class="dt">call. =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb577-7" data-line-number="7">    }</a>
<a class="sourceLine" id="cb577-8" data-line-number="8">  }</a>
<a class="sourceLine" id="cb577-9" data-line-number="9">))</a>
<a class="sourceLine" id="cb577-10" data-line-number="10">x &lt;-<span class="st"> </span>Rando<span class="op">$</span><span class="kw">new</span>()</a>
<a class="sourceLine" id="cb577-11" data-line-number="11">x<span class="op">$</span>random</a>
<a class="sourceLine" id="cb577-12" data-line-number="12"><span class="co">#&gt; [1] 0.0808</span></a>
<a class="sourceLine" id="cb577-13" data-line-number="13">x<span class="op">$</span>random</a>
<a class="sourceLine" id="cb577-14" data-line-number="14"><span class="co">#&gt; [1] 0.834</span></a>
<a class="sourceLine" id="cb577-15" data-line-number="15">x<span class="op">$</span>random</a>
<a class="sourceLine" id="cb577-16" data-line-number="16"><span class="co">#&gt; [1] 0.601</span></a></code></pre></div>
<p>Active fields are particularly useful in conjunction with private fields, because they make it possible to implement components that look like fields from the outside but provide additional checks. For example, we can use then make a read-only <code>age</code> field, and to ensure that <code>name</code> is a length 1 character vector.</p>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb578-1" data-line-number="1">Person &lt;-<span class="st"> </span><span class="kw">R6Class</span>(<span class="st">&quot;Person&quot;</span>, </a>
<a class="sourceLine" id="cb578-2" data-line-number="2">  <span class="dt">private =</span> <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb578-3" data-line-number="3">    <span class="dt">.age =</span> <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb578-4" data-line-number="4">    <span class="dt">.name =</span> <span class="ot">NULL</span></a>
<a class="sourceLine" id="cb578-5" data-line-number="5">  ),</a>
<a class="sourceLine" id="cb578-6" data-line-number="6">  <span class="dt">active =</span> <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb578-7" data-line-number="7">    <span class="dt">age =</span> <span class="cf">function</span>(value) {</a>
<a class="sourceLine" id="cb578-8" data-line-number="8">      <span class="cf">if</span> (<span class="kw">missing</span>(value)) {</a>
<a class="sourceLine" id="cb578-9" data-line-number="9">        private<span class="op">$</span>.age</a>
<a class="sourceLine" id="cb578-10" data-line-number="10">      } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb578-11" data-line-number="11">        <span class="kw">stop</span>(<span class="st">&quot;`$age` is read only&quot;</span>, <span class="dt">call. =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb578-12" data-line-number="12">      }</a>
<a class="sourceLine" id="cb578-13" data-line-number="13">    },</a>
<a class="sourceLine" id="cb578-14" data-line-number="14">    <span class="dt">name =</span> <span class="cf">function</span>(value) {</a>
<a class="sourceLine" id="cb578-15" data-line-number="15">      <span class="cf">if</span> (<span class="kw">missing</span>(value)) {</a>
<a class="sourceLine" id="cb578-16" data-line-number="16">        private<span class="op">$</span>.name</a>
<a class="sourceLine" id="cb578-17" data-line-number="17">      } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb578-18" data-line-number="18">        <span class="kw">stopifnot</span>(<span class="kw">is.character</span>(value), <span class="kw">length</span>(value) <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb578-19" data-line-number="19">        private<span class="op">$</span>.name &lt;-<span class="st"> </span>value</a>
<a class="sourceLine" id="cb578-20" data-line-number="20">        self</a>
<a class="sourceLine" id="cb578-21" data-line-number="21">      }</a>
<a class="sourceLine" id="cb578-22" data-line-number="22">    }</a>
<a class="sourceLine" id="cb578-23" data-line-number="23">  ),</a>
<a class="sourceLine" id="cb578-24" data-line-number="24">  <span class="dt">public =</span> <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb578-25" data-line-number="25">    <span class="dt">initialize =</span> <span class="cf">function</span>(name, <span class="dt">age =</span> <span class="ot">NA</span>) {</a>
<a class="sourceLine" id="cb578-26" data-line-number="26">      private<span class="op">$</span>.name &lt;-<span class="st"> </span>name</a>
<a class="sourceLine" id="cb578-27" data-line-number="27">      private<span class="op">$</span>.age &lt;-<span class="st"> </span>age</a>
<a class="sourceLine" id="cb578-28" data-line-number="28">    }</a>
<a class="sourceLine" id="cb578-29" data-line-number="29">  )</a>
<a class="sourceLine" id="cb578-30" data-line-number="30">)</a>
<a class="sourceLine" id="cb578-31" data-line-number="31"></a>
<a class="sourceLine" id="cb578-32" data-line-number="32">hadley4 &lt;-<span class="st"> </span>Person<span class="op">$</span><span class="kw">new</span>(<span class="st">&quot;Hadley&quot;</span>, <span class="dt">age =</span> <span class="dv">38</span>)</a>
<a class="sourceLine" id="cb578-33" data-line-number="33">hadley4<span class="op">$</span>name</a>
<a class="sourceLine" id="cb578-34" data-line-number="34"><span class="co">#&gt; [1] &quot;Hadley&quot;</span></a>
<a class="sourceLine" id="cb578-35" data-line-number="35">hadley4<span class="op">$</span>name &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb578-36" data-line-number="36"><span class="co">#&gt; Error in (function (value) :</span></a>
<a class="sourceLine" id="cb578-37" data-line-number="37"><span class="co">#&gt;   is.character(value) is not TRUE</span></a>
<a class="sourceLine" id="cb578-38" data-line-number="38">hadley4<span class="op">$</span>age &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb578-39" data-line-number="39"><span class="co">#&gt; Error: `$age` is read only</span></a></code></pre></div>
</div>
<div id="exercises-43" class="section level3">
<h3><span class="header-section-number">14.3.3</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li><p>Create a bank account class that you can withdraw from and deposit to, but
prevents you from directly setting the account balance.</p></li>
<li><p>Create an class with a write-only <code>$password</code> field. It should have
<code>$check_password(password)</code> method that returns <code>TRUE</code> or <code>FALSE</code>, but
there should be no way to view the complete password.</p></li>
<li><p>Extend the <code>Rando</code> class with another active binding that allows you to
access the previous random value. Ensure that active binding is the only
way to access the value.</p></li>
<li><p>Can subclasses access private fields/methods from their parent? Perform
an experiment to find out.</p></li>
</ol>
</div>
</div>
<div id="r6-semantics" class="section level2">
<h2><span class="header-section-number">14.4</span> Reference semantics</h2>
<p>One of the big differences between R6 and most other objects is that they have reference semantics. They inherit this behaviour from environments, the base type that they are built from:</p>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb579-1" data-line-number="1"><span class="kw">typeof</span>(x2)</a>
<a class="sourceLine" id="cb579-2" data-line-number="2"><span class="co">#&gt; [1] &quot;environment&quot;</span></a></code></pre></div>
<p>The main consequence of reference semantics is that objects are not copied when modified:</p>
<div class="sourceCode" id="cb580"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb580-1" data-line-number="1">y1 &lt;-<span class="st"> </span>Accumulator<span class="op">$</span><span class="kw">new</span>() </a>
<a class="sourceLine" id="cb580-2" data-line-number="2">y2 &lt;-<span class="st"> </span>y1</a>
<a class="sourceLine" id="cb580-3" data-line-number="3"></a>
<a class="sourceLine" id="cb580-4" data-line-number="4">y1<span class="op">$</span><span class="kw">add</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb580-5" data-line-number="5"><span class="kw">c</span>(<span class="dt">y1 =</span> y1<span class="op">$</span>sum, <span class="dt">y2 =</span> y2<span class="op">$</span>sum)</a>
<a class="sourceLine" id="cb580-6" data-line-number="6"><span class="co">#&gt; y1 y2 </span></a>
<a class="sourceLine" id="cb580-7" data-line-number="7"><span class="co">#&gt; 10 10</span></a></code></pre></div>
<p>Instead, if you want a copy, you’ll need to explicitly <code>$clone()</code> the object:</p>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb581-1" data-line-number="1">y1 &lt;-<span class="st"> </span>Accumulator<span class="op">$</span><span class="kw">new</span>() </a>
<a class="sourceLine" id="cb581-2" data-line-number="2">y2 &lt;-<span class="st"> </span>y1<span class="op">$</span><span class="kw">clone</span>()</a>
<a class="sourceLine" id="cb581-3" data-line-number="3"></a>
<a class="sourceLine" id="cb581-4" data-line-number="4">y1<span class="op">$</span><span class="kw">add</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb581-5" data-line-number="5"><span class="kw">c</span>(<span class="dt">y1 =</span> y1<span class="op">$</span>sum, <span class="dt">y2 =</span> y2<span class="op">$</span>sum)</a>
<a class="sourceLine" id="cb581-6" data-line-number="6"><span class="co">#&gt; y1 y2 </span></a>
<a class="sourceLine" id="cb581-7" data-line-number="7"><span class="co">#&gt; 10  0</span></a></code></pre></div>
<p>(Note that <code>$clone()</code> does not recursively clone nested R6 objects. If you want that, you’ll need to use <code>$clone(deep = TRUE)</code>. This this only clones R6 objects: you’ll need to provide your own <code>$clone()</code> if your class contains environments.)</p>
<p>There are three other less obvious consequences:</p>
<ul>
<li><p>It is harder to reason about code that uses R6 objects because you need to
understand more context.</p></li>
<li><p>It makes sense to think about when an R6 object is deleted, and you
can write a <code>$finalize()</code> to complement the <code>$initialize()</code>.</p></li>
<li><p>If one of the fields is an R6 object, you must create it inside
<code>$initialize()</code>, not <code>R6Class()</code>.</p></li>
</ul>
<p>These consequences are described in more detail below.</p>
<div id="reasoning" class="section level3">
<h3><span class="header-section-number">14.4.1</span> Reasoning</h3>
<p>Generally, reference semantics makes code harder to reason about. Take this very simple example:</p>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb582-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">a =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb582-2" data-line-number="2">y &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">b =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb582-3" data-line-number="3"></a>
<a class="sourceLine" id="cb582-4" data-line-number="4">z &lt;-<span class="st"> </span><span class="kw">f</span>(x, y)</a></code></pre></div>
<p>For the vast majority of functions, you know that the final line only modifies <code>z</code>.</p>
<p>Take a similar example that uses an imaginary <code>List</code> reference class:</p>
<div class="sourceCode" id="cb583"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb583-1" data-line-number="1">x &lt;-<span class="st"> </span>List<span class="op">$</span><span class="kw">new</span>(<span class="dt">a =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb583-2" data-line-number="2">y &lt;-<span class="st"> </span>List<span class="op">$</span><span class="kw">new</span>(<span class="dt">b =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb583-3" data-line-number="3"></a>
<a class="sourceLine" id="cb583-4" data-line-number="4">z &lt;-<span class="st"> </span><span class="kw">f</span>(x, y)</a></code></pre></div>
<p>The final line is much harder to reason about: if <code>f()</code> calls methods of <code>x</code> or <code>y</code>, it might modify them as well as <code>z</code>. This is the biggest potential downside of R6 and you should take care to avoid it by writing functions that either return a value, or modify their R6 inputs, but not both.</p>
<p>That said, modifying R6 inputs can lead to substantially simpler code in some cases. One challenge of working with immutable data is known as <strong>threading state</strong>: if you want to return a modified value from a deeply nested function, you need to return the modified value up through every function. This can complicate code, particularly if you need to modify multiple values. We’ll come back to this problem in Section <a href="oo-tradeoffs.html#threading-state">16.3.2</a>.</p>
</div>
<div id="finalizer" class="section level3">
<h3><span class="header-section-number">14.4.2</span> Finalizer</h3>
<p>One useful property of reference semantics is that it makes sense to think about when an R6 object is <strong>finalized</strong>, i.e. when it’s deleted. This doesn’t make sense for most objects because copy-on-modify semantics mean that there may be many transient versions of an object, as eluded to in Section <a href="names-values.html#gc">2.6</a>. For example, the following creates two two factor objects: the second is created when the levels are modified, leaving the first to be destroyed by the garbage collector.</p>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb584-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>))</a>
<a class="sourceLine" id="cb584-2" data-line-number="2"><span class="kw">levels</span>(x) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;c&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;a&quot;</span>)</a></code></pre></div>
<p>Since R6 objects are not copied-on-modify they are only deleted once, and it makes sense to think about <code>$finalize()</code> as a complement to <code>$initialize()</code>. Finalizers usually play a similar role to <code>on.exit()</code> (as described in Section <a href="functions.html#on-exit">5.7.4</a>), cleaning up any resources created by the initializer. For example, the following class wraps up a temporary file, automatically deleting it when the class is finalized.</p>
<div class="sourceCode" id="cb585"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb585-1" data-line-number="1">TemporaryFile &lt;-<span class="st"> </span><span class="kw">R6Class</span>(<span class="st">&quot;TemporaryFile&quot;</span>, <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb585-2" data-line-number="2">  <span class="dt">path =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb585-3" data-line-number="3">  <span class="dt">initialize =</span> <span class="cf">function</span>() {</a>
<a class="sourceLine" id="cb585-4" data-line-number="4">    self<span class="op">$</span>path &lt;-<span class="st"> </span><span class="kw">tempfile</span>()</a>
<a class="sourceLine" id="cb585-5" data-line-number="5">  },</a>
<a class="sourceLine" id="cb585-6" data-line-number="6">  <span class="dt">finalize =</span> <span class="cf">function</span>() {</a>
<a class="sourceLine" id="cb585-7" data-line-number="7">    <span class="kw">message</span>(<span class="st">&quot;Cleaning up &quot;</span>, self<span class="op">$</span>path)</a>
<a class="sourceLine" id="cb585-8" data-line-number="8">    <span class="kw">unlink</span>(self<span class="op">$</span>path)</a>
<a class="sourceLine" id="cb585-9" data-line-number="9">  }</a>
<a class="sourceLine" id="cb585-10" data-line-number="10">))</a>
<a class="sourceLine" id="cb585-11" data-line-number="11"></a>
<a class="sourceLine" id="cb585-12" data-line-number="12">tf &lt;-<span class="st"> </span>TemporaryFile<span class="op">$</span><span class="kw">new</span>()</a></code></pre></div>
<p>The finalize method will be run when the object is deleted (or more precisely, by by the first garbage collection after the object has been unbound from all names) or when R exits. This means that the finalizer can called effectively anywhere in your R code, and therefore it’s almost impossible to reason about finalizer code that touches shared data structures. Avoid these potential problems by only using the finalizer to clean up private resources allocated by initializer.</p>
<div class="sourceCode" id="cb586"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb586-1" data-line-number="1"><span class="kw">rm</span>(tf)</a>
<a class="sourceLine" id="cb586-2" data-line-number="2"><span class="kw">invisible</span>(<span class="kw">gc</span>())</a></code></pre></div>
<p>I forcing garbage collection here to ensure that the message printed by the finaliser message appears in this code block.</p>
</div>
<div id="r6-fields" class="section level3">
<h3><span class="header-section-number">14.4.3</span> R6 fields</h3>
<p>A final consequence of reference semantics can crop up where you don’t expect it: never use a R6 class as the default value of a field. It will be shared across all instances of the object because it’s is only initialized once, when you define the class, not each time you call <code>$new()</code>.</p>
<div class="sourceCode" id="cb587"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb587-1" data-line-number="1">TemporaryDatabase &lt;-<span class="st"> </span><span class="kw">R6Class</span>(<span class="st">&quot;TemporaryDatabase&quot;</span>, <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb587-2" data-line-number="2">  <span class="dt">con =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb587-3" data-line-number="3">  <span class="dt">file =</span> TemporaryFile<span class="op">$</span><span class="kw">new</span>(),</a>
<a class="sourceLine" id="cb587-4" data-line-number="4">  <span class="dt">initialize =</span> <span class="cf">function</span>() {</a>
<a class="sourceLine" id="cb587-5" data-line-number="5">    self<span class="op">$</span>con &lt;-<span class="st"> </span>DBI<span class="op">::</span><span class="kw">dbConnect</span>(RSQLite<span class="op">::</span><span class="kw">SQLite</span>(), <span class="dt">path =</span> file<span class="op">$</span>path)</a>
<a class="sourceLine" id="cb587-6" data-line-number="6">  },</a>
<a class="sourceLine" id="cb587-7" data-line-number="7">  <span class="dt">finalize =</span> <span class="cf">function</span>() {</a>
<a class="sourceLine" id="cb587-8" data-line-number="8">    DBI<span class="op">::</span><span class="kw">dbDisconnect</span>(self<span class="op">$</span>con)</a>
<a class="sourceLine" id="cb587-9" data-line-number="9">  }</a>
<a class="sourceLine" id="cb587-10" data-line-number="10">))</a>
<a class="sourceLine" id="cb587-11" data-line-number="11"></a>
<a class="sourceLine" id="cb587-12" data-line-number="12">db_a &lt;-<span class="st"> </span>TemporaryDatabase<span class="op">$</span><span class="kw">new</span>()</a>
<a class="sourceLine" id="cb587-13" data-line-number="13">db_b &lt;-<span class="st"> </span>TemporaryDatabase<span class="op">$</span><span class="kw">new</span>()</a>
<a class="sourceLine" id="cb587-14" data-line-number="14"></a>
<a class="sourceLine" id="cb587-15" data-line-number="15">db_a<span class="op">$</span>file<span class="op">$</span>path <span class="op">==</span><span class="st"> </span>db_b<span class="op">$</span>file<span class="op">$</span>path</a>
<a class="sourceLine" id="cb587-16" data-line-number="16"><span class="co">#&gt; [1] TRUE</span></a></code></pre></div>
<p>(If you’re familiar with Python, this is very similar to the “mutable default argument” problem.)</p>
<p>You can fix this by creating the object in <code>$initialize()</code>:</p>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb588-1" data-line-number="1">TemporaryDatabase &lt;-<span class="st"> </span><span class="kw">R6Class</span>(<span class="st">&quot;TemporaryDatabase&quot;</span>, <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb588-2" data-line-number="2">  <span class="dt">con =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb588-3" data-line-number="3">  <span class="dt">file =</span> <span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb588-4" data-line-number="4">  <span class="dt">initialize =</span> <span class="cf">function</span>() {</a>
<a class="sourceLine" id="cb588-5" data-line-number="5">    self<span class="op">$</span>file &lt;-<span class="st"> </span>TemporaryFile<span class="op">$</span><span class="kw">new</span>()</a>
<a class="sourceLine" id="cb588-6" data-line-number="6">    self<span class="op">$</span>con &lt;-<span class="st"> </span>DBI<span class="op">::</span><span class="kw">dbConnect</span>(RSQLite<span class="op">::</span><span class="kw">SQLite</span>(), <span class="dt">path =</span> file<span class="op">$</span>path)</a>
<a class="sourceLine" id="cb588-7" data-line-number="7">  },</a>
<a class="sourceLine" id="cb588-8" data-line-number="8">  <span class="dt">finalize =</span> <span class="cf">function</span>() {</a>
<a class="sourceLine" id="cb588-9" data-line-number="9">    DBI<span class="op">::</span><span class="kw">dbDisconnect</span>(self<span class="op">$</span>con)</a>
<a class="sourceLine" id="cb588-10" data-line-number="10">  }</a>
<a class="sourceLine" id="cb588-11" data-line-number="11">))</a>
<a class="sourceLine" id="cb588-12" data-line-number="12"></a>
<a class="sourceLine" id="cb588-13" data-line-number="13">db_a &lt;-<span class="st"> </span>TemporaryDatabase<span class="op">$</span><span class="kw">new</span>()</a>
<a class="sourceLine" id="cb588-14" data-line-number="14">db_b &lt;-<span class="st"> </span>TemporaryDatabase<span class="op">$</span><span class="kw">new</span>()</a>
<a class="sourceLine" id="cb588-15" data-line-number="15"></a>
<a class="sourceLine" id="cb588-16" data-line-number="16">db_a<span class="op">$</span>file<span class="op">$</span>path <span class="op">==</span><span class="st"> </span>db_b<span class="op">$</span>file<span class="op">$</span>path</a>
<a class="sourceLine" id="cb588-17" data-line-number="17"><span class="co">#&gt; [1] FALSE</span></a></code></pre></div>
</div>
<div id="exercises-44" class="section level3">
<h3><span class="header-section-number">14.4.4</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li>Create a class that allows you to write a line to a specified file.
You should open a connection to the file in <code>$initialize()</code>, append a
line using <code>cat()</code> in <code>$append_line()</code>, and close the connection in
<code>$finalize()</code>.</li>
</ol>
</div>
</div>
<div id="why-r6" class="section level2">
<h2><span class="header-section-number">14.5</span> Why R6?</h2>
<p>R6 is very similar to a built-in OO system called <strong>reference classes</strong>, or RC for short. I prefer R6 over RC for a few reasons:</p>
<ul>
<li><p>R6 is much simpler. Both R6 and RC are built on top of environments, but
while R6 uses S3, RC uses S4. This means to fully understand RC, you need
to understand how the more complicated S4 works.</p></li>
<li><p>R6 has comprehensive online documentation at <a href="https://r6.r-lib.org" class="uri">https://r6.r-lib.org</a>.</p></li>
<li><p>R6 has a simpler mechnaism for cross-package subclassing, which just
works without you having to think about. For RC, read the details in the
“External Methods; Inter-Package Superclasses” section of <code>?setRefClass</code>.</p></li>
<li><p>RC mingles variables and fields in the same stack of environments so that you
get (<code>field</code>) and set (<code>field &lt;&lt;- value</code>) fields like regular values. R6 puts
fields in a separate environment so you get (<code>self$field</code>) and set
(<code>self$field &lt;- value</code>) with a prefix. The R6 approach is more verbose but
I like it because I think it makes the code easier to read.</p></li>
<li><p>R6 is much faster than RC. Generally, the speed of method dispatch is not
important outside of microbenchmarks, but R6 is substantially more performant.
Switching from RC to R6 yielded substantial performance improvements in shiny.
<code>vignette(&quot;Performance&quot;, &quot;R6&quot;)</code> provides more details.</p></li>
<li><p>RC is tied to R version. That means if any bugs are fixed, you can only
take advantage of the fixes by requiring a newer version of R. This makes it
difficult for packages (like those in the tidyverse) that need to work across
many R versions.</p></li>
<li><p>Because the ideas that underlie R6 and RC are similar, it will only require
a small amount of additional effort to learn RC if you need to.</p></li>
</ul>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="47">
<li id="fn47"><p>That means if you’re creating R6 in a package, you only need to make sure it’s listed in the <code>Imports</code> field of the <code>DESCRIPTION</code>. There’s no need to import the package into the <code>NAMESPACE</code>.<a href="r6.html#fnref47" class="footnote-back">↩</a></p></li>
<li id="fn48"><p>Unlike in <code>this</code> in python, the <code>self</code> variable is automatically provided by R6, and does not form part of the method signature.<a href="r6.html#fnref48" class="footnote-back">↩</a></p></li>
<li id="fn49"><p>Because R is such a flexible language, it’s technically still possible to access private values, but you have to try much harder and spelunk in to the details of R6’s implementation.<a href="r6.html#fnref49" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="s3.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="s4.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": true,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/hadley/adv-r/edit/master/R6.Rmd",
"text": "Edit"
},
"download": [["https://github.com/BruceZhaoR/adv-r/raw/gh-pages/_main.pdf", "PDF"], ["https://github.com/BruceZhaoR/adv-r/raw/gh-pages/_main.epub", "EPUB3"]],
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
