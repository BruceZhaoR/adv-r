<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Advanced R</title>
  <meta name="description" content="The book is designed primarily for R users who want to improve their programming skills and understanding of the language. It should also be useful for programmers coming to R from other languages, as it explains some of R’s quirks and shows how some parts that seem horrible do have a positive side.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Advanced R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://adv-r.hadley.nz/" />
  <meta property="og:image" content="https://adv-r.hadley.nz/cover.png" />
  <meta property="og:description" content="The book is designed primarily for R users who want to improve their programming skills and understanding of the language. It should also be useful for programmers coming to R from other languages, as it explains some of R’s quirks and shows how some parts that seem horrible do have a positive side." />
  <meta name="github-repo" content="hadley/adv-r" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Advanced R" />
  <meta name="twitter:site" content="@hadley" />
  <meta name="twitter:description" content="The book is designed primarily for R users who want to improve their programming skills and understanding of the language. It should also be useful for programmers coming to R from other languages, as it explains some of R’s quirks and shows how some parts that seem horrible do have a positive side." />
  <meta name="twitter:image" content="https://adv-r.hadley.nz/cover.png" />

<meta name="author" content="Hadley Wickham">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="debugging.html">
<link rel="next" href="profiling.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="adv-r.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">Advanced R</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#other-books"><i class="fa fa-check"></i>Other books</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#why-r"><i class="fa fa-check"></i><b>1.1</b> Why R?</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#who-should-read"><i class="fa fa-check"></i><b>1.2</b> Who should read this book</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#what-you-will-get"><i class="fa fa-check"></i><b>1.3</b> What you will get out of this book</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#what-you-will-not-learn"><i class="fa fa-check"></i><b>1.4</b> What you will not learn</a></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#meta-techniques"><i class="fa fa-check"></i><b>1.5</b> Meta-techniques</a></li>
<li class="chapter" data-level="1.6" data-path="introduction.html"><a href="introduction.html#recommended-reading"><i class="fa fa-check"></i><b>1.6</b> Recommended reading</a></li>
<li class="chapter" data-level="1.7" data-path="introduction.html"><a href="introduction.html#getting-help"><i class="fa fa-check"></i><b>1.7</b> Getting help</a></li>
<li class="chapter" data-level="1.8" data-path="introduction.html"><a href="introduction.html#intro-ack"><i class="fa fa-check"></i><b>1.8</b> Acknowledgments</a></li>
<li class="chapter" data-level="1.9" data-path="introduction.html"><a href="introduction.html#conventions"><i class="fa fa-check"></i><b>1.9</b> Conventions</a></li>
<li class="chapter" data-level="1.10" data-path="introduction.html"><a href="introduction.html#colophon"><i class="fa fa-check"></i><b>1.10</b> Colophon</a></li>
</ul></li>
<li class="part"><span><b>I Foundations</b></span></li>
<li class="chapter" data-level="" data-path="foundations-intro.html"><a href="foundations-intro.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="2" data-path="names-values.html"><a href="names-values.html"><i class="fa fa-check"></i><b>2</b> Names and values</a><ul>
<li class="chapter" data-level="2.1" data-path="names-values.html"><a href="names-values.html#introduction-1"><i class="fa fa-check"></i><b>2.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#quiz"><i class="fa fa-check"></i>Quiz</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#outline"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="names-values.html"><a href="names-values.html#sources"><i class="fa fa-check"></i>Sources</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="names-values.html"><a href="names-values.html#binding-basics"><i class="fa fa-check"></i><b>2.2</b> Binding basics</a><ul>
<li class="chapter" data-level="2.2.1" data-path="names-values.html"><a href="names-values.html#non-syntactic"><i class="fa fa-check"></i><b>2.2.1</b> Non-syntactic names</a></li>
<li class="chapter" data-level="2.2.2" data-path="names-values.html"><a href="names-values.html#exercises"><i class="fa fa-check"></i><b>2.2.2</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="names-values.html"><a href="names-values.html#copy-on-modify"><i class="fa fa-check"></i><b>2.3</b> Copy-on-modify</a><ul>
<li class="chapter" data-level="2.3.1" data-path="names-values.html"><a href="names-values.html#tracemem"><i class="fa fa-check"></i><b>2.3.1</b> <code>tracemem()</code></a></li>
<li class="chapter" data-level="2.3.2" data-path="names-values.html"><a href="names-values.html#function-calls"><i class="fa fa-check"></i><b>2.3.2</b> Function calls</a></li>
<li class="chapter" data-level="2.3.3" data-path="names-values.html"><a href="names-values.html#list-references"><i class="fa fa-check"></i><b>2.3.3</b> Lists</a></li>
<li class="chapter" data-level="2.3.4" data-path="names-values.html"><a href="names-values.html#df-modify"><i class="fa fa-check"></i><b>2.3.4</b> Data frames</a></li>
<li class="chapter" data-level="2.3.5" data-path="names-values.html"><a href="names-values.html#character-vectors"><i class="fa fa-check"></i><b>2.3.5</b> Character vectors</a></li>
<li class="chapter" data-level="2.3.6" data-path="names-values.html"><a href="names-values.html#exercises-1"><i class="fa fa-check"></i><b>2.3.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="names-values.html"><a href="names-values.html#object-size"><i class="fa fa-check"></i><b>2.4</b> Object size</a><ul>
<li class="chapter" data-level="2.4.1" data-path="names-values.html"><a href="names-values.html#exercises-2"><i class="fa fa-check"></i><b>2.4.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="names-values.html"><a href="names-values.html#modify-in-place"><i class="fa fa-check"></i><b>2.5</b> Modify-in-place</a><ul>
<li class="chapter" data-level="2.5.1" data-path="names-values.html"><a href="names-values.html#single-binding"><i class="fa fa-check"></i><b>2.5.1</b> Objects with a single binding</a></li>
<li class="chapter" data-level="2.5.2" data-path="names-values.html"><a href="names-values.html#env-modify"><i class="fa fa-check"></i><b>2.5.2</b> Environments</a></li>
<li class="chapter" data-level="2.5.3" data-path="names-values.html"><a href="names-values.html#exercises-3"><i class="fa fa-check"></i><b>2.5.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="names-values.html"><a href="names-values.html#gc"><i class="fa fa-check"></i><b>2.6</b> Unbinding and the garbage collector</a></li>
<li class="chapter" data-level="2.7" data-path="names-values.html"><a href="names-values.html#names-values-answers"><i class="fa fa-check"></i><b>2.7</b> Answers</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="vectors-chap.html"><a href="vectors-chap.html"><i class="fa fa-check"></i><b>3</b> Vectors</a><ul>
<li class="chapter" data-level="3.1" data-path="vectors-chap.html"><a href="vectors-chap.html#introduction-2"><i class="fa fa-check"></i><b>3.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="vectors-chap.html"><a href="vectors-chap.html#quiz-1"><i class="fa fa-check"></i>Quiz</a></li>
<li class="chapter" data-level="" data-path="vectors-chap.html"><a href="vectors-chap.html#outline-1"><i class="fa fa-check"></i>Outline</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="vectors-chap.html"><a href="vectors-chap.html#atomic-vectors"><i class="fa fa-check"></i><b>3.2</b> Atomic vectors</a><ul>
<li class="chapter" data-level="3.2.1" data-path="vectors-chap.html"><a href="vectors-chap.html#scalars"><i class="fa fa-check"></i><b>3.2.1</b> Scalars</a></li>
<li class="chapter" data-level="3.2.2" data-path="vectors-chap.html"><a href="vectors-chap.html#atomic-constructing"><i class="fa fa-check"></i><b>3.2.2</b> Making longer vectors with <code>c()</code></a></li>
<li class="chapter" data-level="3.2.3" data-path="vectors-chap.html"><a href="vectors-chap.html#testing-and-coercing"><i class="fa fa-check"></i><b>3.2.3</b> Testing and coercing</a></li>
<li class="chapter" data-level="3.2.4" data-path="vectors-chap.html"><a href="vectors-chap.html#exercises-4"><i class="fa fa-check"></i><b>3.2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="vectors-chap.html"><a href="vectors-chap.html#attributes"><i class="fa fa-check"></i><b>3.3</b> Attributes</a><ul>
<li class="chapter" data-level="3.3.1" data-path="vectors-chap.html"><a href="vectors-chap.html#getting-and-setting"><i class="fa fa-check"></i><b>3.3.1</b> Getting and setting</a></li>
<li class="chapter" data-level="3.3.2" data-path="vectors-chap.html"><a href="vectors-chap.html#attr-names"><i class="fa fa-check"></i><b>3.3.2</b> Names</a></li>
<li class="chapter" data-level="3.3.3" data-path="vectors-chap.html"><a href="vectors-chap.html#attr-dims"><i class="fa fa-check"></i><b>3.3.3</b> Dimensions</a></li>
<li class="chapter" data-level="3.3.4" data-path="vectors-chap.html"><a href="vectors-chap.html#exercises-5"><i class="fa fa-check"></i><b>3.3.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="vectors-chap.html"><a href="vectors-chap.html#s3-atomic-vectors"><i class="fa fa-check"></i><b>3.4</b> S3 atomic vectors</a><ul>
<li class="chapter" data-level="3.4.1" data-path="vectors-chap.html"><a href="vectors-chap.html#factors"><i class="fa fa-check"></i><b>3.4.1</b> Factors</a></li>
<li class="chapter" data-level="3.4.2" data-path="vectors-chap.html"><a href="vectors-chap.html#dates"><i class="fa fa-check"></i><b>3.4.2</b> Dates</a></li>
<li class="chapter" data-level="3.4.3" data-path="vectors-chap.html"><a href="vectors-chap.html#date-times"><i class="fa fa-check"></i><b>3.4.3</b> Date-times</a></li>
<li class="chapter" data-level="3.4.4" data-path="vectors-chap.html"><a href="vectors-chap.html#exercises-6"><i class="fa fa-check"></i><b>3.4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="vectors-chap.html"><a href="vectors-chap.html#lists"><i class="fa fa-check"></i><b>3.5</b> Lists</a><ul>
<li class="chapter" data-level="3.5.1" data-path="vectors-chap.html"><a href="vectors-chap.html#list-creating"><i class="fa fa-check"></i><b>3.5.1</b> Creating</a></li>
<li class="chapter" data-level="3.5.2" data-path="vectors-chap.html"><a href="vectors-chap.html#list-types"><i class="fa fa-check"></i><b>3.5.2</b> Testing and coercing</a></li>
<li class="chapter" data-level="3.5.3" data-path="vectors-chap.html"><a href="vectors-chap.html#list-array"><i class="fa fa-check"></i><b>3.5.3</b> Matrices and arrays</a></li>
<li class="chapter" data-level="3.5.4" data-path="vectors-chap.html"><a href="vectors-chap.html#exercises-7"><i class="fa fa-check"></i><b>3.5.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="vectors-chap.html"><a href="vectors-chap.html#tibble"><i class="fa fa-check"></i><b>3.6</b> Data frames and tibbles</a><ul>
<li class="chapter" data-level="3.6.1" data-path="vectors-chap.html"><a href="vectors-chap.html#df-create"><i class="fa fa-check"></i><b>3.6.1</b> Creating</a></li>
<li class="chapter" data-level="3.6.2" data-path="vectors-chap.html"><a href="vectors-chap.html#rownames"><i class="fa fa-check"></i><b>3.6.2</b> Row names</a></li>
<li class="chapter" data-level="3.6.3" data-path="vectors-chap.html"><a href="vectors-chap.html#printing"><i class="fa fa-check"></i><b>3.6.3</b> Printing</a></li>
<li class="chapter" data-level="3.6.4" data-path="vectors-chap.html"><a href="vectors-chap.html#safe-subsetting"><i class="fa fa-check"></i><b>3.6.4</b> Subsetting</a></li>
<li class="chapter" data-level="3.6.5" data-path="vectors-chap.html"><a href="vectors-chap.html#df-test-coerce"><i class="fa fa-check"></i><b>3.6.5</b> Testing and coercing</a></li>
<li class="chapter" data-level="3.6.6" data-path="vectors-chap.html"><a href="vectors-chap.html#list-columns"><i class="fa fa-check"></i><b>3.6.6</b> List columns</a></li>
<li class="chapter" data-level="3.6.7" data-path="vectors-chap.html"><a href="vectors-chap.html#matrix-and-data-frame-columns"><i class="fa fa-check"></i><b>3.6.7</b> Matrix and data frame columns</a></li>
<li class="chapter" data-level="3.6.8" data-path="vectors-chap.html"><a href="vectors-chap.html#exercises-8"><i class="fa fa-check"></i><b>3.6.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="vectors-chap.html"><a href="vectors-chap.html#null"><i class="fa fa-check"></i><b>3.7</b> <code>NULL</code></a></li>
<li class="chapter" data-level="3.8" data-path="vectors-chap.html"><a href="vectors-chap.html#data-structure-answers"><i class="fa fa-check"></i><b>3.8</b> Answers</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="subsetting.html"><a href="subsetting.html"><i class="fa fa-check"></i><b>4</b> Subsetting</a><ul>
<li class="chapter" data-level="4.1" data-path="subsetting.html"><a href="subsetting.html#introduction-3"><i class="fa fa-check"></i><b>4.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="subsetting.html"><a href="subsetting.html#quiz-2"><i class="fa fa-check"></i>Quiz</a></li>
<li class="chapter" data-level="" data-path="subsetting.html"><a href="subsetting.html#outline-2"><i class="fa fa-check"></i>Outline</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="subsetting.html"><a href="subsetting.html#subset-multiple"><i class="fa fa-check"></i><b>4.2</b> Selecting multiple elements</a><ul>
<li class="chapter" data-level="4.2.1" data-path="subsetting.html"><a href="subsetting.html#atomic-vectors-1"><i class="fa fa-check"></i><b>4.2.1</b> Atomic vectors</a></li>
<li class="chapter" data-level="4.2.2" data-path="subsetting.html"><a href="subsetting.html#lists-1"><i class="fa fa-check"></i><b>4.2.2</b> Lists</a></li>
<li class="chapter" data-level="4.2.3" data-path="subsetting.html"><a href="subsetting.html#matrix-subsetting"><i class="fa fa-check"></i><b>4.2.3</b> Matrices and arrays</a></li>
<li class="chapter" data-level="4.2.4" data-path="subsetting.html"><a href="subsetting.html#df-subsetting"><i class="fa fa-check"></i><b>4.2.4</b> Data frames and tibbles</a></li>
<li class="chapter" data-level="4.2.5" data-path="subsetting.html"><a href="subsetting.html#simplify-preserve"><i class="fa fa-check"></i><b>4.2.5</b> Preserving dimensionality</a></li>
<li class="chapter" data-level="4.2.6" data-path="subsetting.html"><a href="subsetting.html#exercises-9"><i class="fa fa-check"></i><b>4.2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="subsetting.html"><a href="subsetting.html#subset-single"><i class="fa fa-check"></i><b>4.3</b> Selecting a single element</a><ul>
<li class="chapter" data-level="4.3.1" data-path="subsetting.html"><a href="subsetting.html#section"><i class="fa fa-check"></i><b>4.3.1</b> <code>[[</code></a></li>
<li class="chapter" data-level="4.3.2" data-path="subsetting.html"><a href="subsetting.html#section-1"><i class="fa fa-check"></i><b>4.3.2</b> <code>$</code></a></li>
<li class="chapter" data-level="4.3.3" data-path="subsetting.html"><a href="subsetting.html#missingout-of-bounds-indices"><i class="fa fa-check"></i><b>4.3.3</b> Missing/out of bounds indices</a></li>
<li class="chapter" data-level="4.3.4" data-path="subsetting.html"><a href="subsetting.html#and-slot"><i class="fa fa-check"></i><b>4.3.4</b> <code>@</code> and <code>slot()</code></a></li>
<li class="chapter" data-level="4.3.5" data-path="subsetting.html"><a href="subsetting.html#exercises-10"><i class="fa fa-check"></i><b>4.3.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="subsetting.html"><a href="subsetting.html#subassignment"><i class="fa fa-check"></i><b>4.4</b> Subsetting and assignment</a></li>
<li class="chapter" data-level="4.5" data-path="subsetting.html"><a href="subsetting.html#applications"><i class="fa fa-check"></i><b>4.5</b> Applications</a><ul>
<li class="chapter" data-level="4.5.1" data-path="subsetting.html"><a href="subsetting.html#lookup-tables"><i class="fa fa-check"></i><b>4.5.1</b> Lookup tables (character subsetting)</a></li>
<li class="chapter" data-level="4.5.2" data-path="subsetting.html"><a href="subsetting.html#matching-merging"><i class="fa fa-check"></i><b>4.5.2</b> Matching and merging by hand (integer subsetting)</a></li>
<li class="chapter" data-level="4.5.3" data-path="subsetting.html"><a href="subsetting.html#random-samplesbootstraps-integer-subsetting"><i class="fa fa-check"></i><b>4.5.3</b> Random samples/bootstraps (integer subsetting)</a></li>
<li class="chapter" data-level="4.5.4" data-path="subsetting.html"><a href="subsetting.html#ordering-integer-subsetting"><i class="fa fa-check"></i><b>4.5.4</b> Ordering (integer subsetting)</a></li>
<li class="chapter" data-level="4.5.5" data-path="subsetting.html"><a href="subsetting.html#expanding-aggregated-counts-integer-subsetting"><i class="fa fa-check"></i><b>4.5.5</b> Expanding aggregated counts (integer subsetting)</a></li>
<li class="chapter" data-level="4.5.6" data-path="subsetting.html"><a href="subsetting.html#removing-columns-from-data-frames-character-subsetting"><i class="fa fa-check"></i><b>4.5.6</b> Removing columns from data frames (character subsetting)</a></li>
<li class="chapter" data-level="4.5.7" data-path="subsetting.html"><a href="subsetting.html#selecting-rows-based-on-a-condition-logical-subsetting"><i class="fa fa-check"></i><b>4.5.7</b> Selecting rows based on a condition (logical subsetting)</a></li>
<li class="chapter" data-level="4.5.8" data-path="subsetting.html"><a href="subsetting.html#boolean-algebra-vs.sets-logical-integer-subsetting"><i class="fa fa-check"></i><b>4.5.8</b> Boolean algebra vs. sets (logical &amp; integer subsetting)</a></li>
<li class="chapter" data-level="4.5.9" data-path="subsetting.html"><a href="subsetting.html#exercises-11"><i class="fa fa-check"></i><b>4.5.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="subsetting.html"><a href="subsetting.html#subsetting-answers"><i class="fa fa-check"></i><b>4.6</b> Answers</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>5</b> Functions</a><ul>
<li class="chapter" data-level="5.1" data-path="functions.html"><a href="functions.html#introduction-4"><i class="fa fa-check"></i><b>5.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="functions.html"><a href="functions.html#quiz-3"><i class="fa fa-check"></i>Quiz</a></li>
<li class="chapter" data-level="" data-path="functions.html"><a href="functions.html#outline-3"><i class="fa fa-check"></i>Outline</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="functions.html"><a href="functions.html#function-fundamentals"><i class="fa fa-check"></i><b>5.2</b> Function fundamentals</a><ul>
<li class="chapter" data-level="5.2.1" data-path="functions.html"><a href="functions.html#first-class-functions"><i class="fa fa-check"></i><b>5.2.1</b> First-class functions</a></li>
<li class="chapter" data-level="5.2.2" data-path="functions.html"><a href="functions.html#function-components"><i class="fa fa-check"></i><b>5.2.2</b> Function components</a></li>
<li class="chapter" data-level="5.2.3" data-path="functions.html"><a href="functions.html#primitive-functions"><i class="fa fa-check"></i><b>5.2.3</b> Primitive functions</a></li>
<li class="chapter" data-level="5.2.4" data-path="functions.html"><a href="functions.html#exercises-12"><i class="fa fa-check"></i><b>5.2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="functions.html"><a href="functions.html#function-composition"><i class="fa fa-check"></i><b>5.3</b> Function composition</a></li>
<li class="chapter" data-level="5.4" data-path="functions.html"><a href="functions.html#lexical-scoping"><i class="fa fa-check"></i><b>5.4</b> Lexical scoping</a><ul>
<li class="chapter" data-level="5.4.1" data-path="functions.html"><a href="functions.html#name-masking"><i class="fa fa-check"></i><b>5.4.1</b> Name masking</a></li>
<li class="chapter" data-level="5.4.2" data-path="functions.html"><a href="functions.html#functions-vs.variables"><i class="fa fa-check"></i><b>5.4.2</b> Functions vs. variables</a></li>
<li class="chapter" data-level="5.4.3" data-path="functions.html"><a href="functions.html#fresh-start"><i class="fa fa-check"></i><b>5.4.3</b> A fresh start</a></li>
<li class="chapter" data-level="5.4.4" data-path="functions.html"><a href="functions.html#dynamic-lookup"><i class="fa fa-check"></i><b>5.4.4</b> Dynamic lookup</a></li>
<li class="chapter" data-level="5.4.5" data-path="functions.html"><a href="functions.html#exercises-13"><i class="fa fa-check"></i><b>5.4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="functions.html"><a href="functions.html#lazy-evaluation"><i class="fa fa-check"></i><b>5.5</b> Lazy evaluation</a><ul>
<li class="chapter" data-level="5.5.1" data-path="functions.html"><a href="functions.html#forcing-evaluation"><i class="fa fa-check"></i><b>5.5.1</b> Forcing evaluation</a></li>
<li class="chapter" data-level="5.5.2" data-path="functions.html"><a href="functions.html#promises"><i class="fa fa-check"></i><b>5.5.2</b> Promises</a></li>
<li class="chapter" data-level="5.5.3" data-path="functions.html"><a href="functions.html#default-arguments"><i class="fa fa-check"></i><b>5.5.3</b> Default arguments</a></li>
<li class="chapter" data-level="5.5.4" data-path="functions.html"><a href="functions.html#missing-arguments"><i class="fa fa-check"></i><b>5.5.4</b> Missing arguments</a></li>
<li class="chapter" data-level="5.5.5" data-path="functions.html"><a href="functions.html#exercises-14"><i class="fa fa-check"></i><b>5.5.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="functions.html"><a href="functions.html#fun-dot-dot-dot"><i class="fa fa-check"></i><b>5.6</b> <code>...</code> (dot-dot-dot)</a><ul>
<li class="chapter" data-level="5.6.1" data-path="functions.html"><a href="functions.html#exercises-15"><i class="fa fa-check"></i><b>5.6.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="functions.html"><a href="functions.html#exiting-a-function"><i class="fa fa-check"></i><b>5.7</b> Exiting a function</a><ul>
<li class="chapter" data-level="5.7.1" data-path="functions.html"><a href="functions.html#implicit-vs.explicit-returns"><i class="fa fa-check"></i><b>5.7.1</b> Implicit vs. explicit returns</a></li>
<li class="chapter" data-level="5.7.2" data-path="functions.html"><a href="functions.html#invisible-values"><i class="fa fa-check"></i><b>5.7.2</b> Invisible values</a></li>
<li class="chapter" data-level="5.7.3" data-path="functions.html"><a href="functions.html#errors"><i class="fa fa-check"></i><b>5.7.3</b> Errors</a></li>
<li class="chapter" data-level="5.7.4" data-path="functions.html"><a href="functions.html#on-exit"><i class="fa fa-check"></i><b>5.7.4</b> Exit handlers</a></li>
<li class="chapter" data-level="5.7.5" data-path="functions.html"><a href="functions.html#exercises-16"><i class="fa fa-check"></i><b>5.7.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="functions.html"><a href="functions.html#function-forms"><i class="fa fa-check"></i><b>5.8</b> Function forms</a><ul>
<li class="chapter" data-level="5.8.1" data-path="functions.html"><a href="functions.html#prefix-form"><i class="fa fa-check"></i><b>5.8.1</b> Rewriting to prefix form</a></li>
<li class="chapter" data-level="5.8.2" data-path="functions.html"><a href="functions.html#prefix-form"><i class="fa fa-check"></i><b>5.8.2</b> Prefix form</a></li>
<li class="chapter" data-level="5.8.3" data-path="functions.html"><a href="functions.html#infix-functions"><i class="fa fa-check"></i><b>5.8.3</b> Infix functions</a></li>
<li class="chapter" data-level="5.8.4" data-path="functions.html"><a href="functions.html#replacement-functions"><i class="fa fa-check"></i><b>5.8.4</b> Replacement functions</a></li>
<li class="chapter" data-level="5.8.5" data-path="functions.html"><a href="functions.html#special-forms"><i class="fa fa-check"></i><b>5.8.5</b> Special forms</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="functions.html"><a href="functions.html#invoking-a-function"><i class="fa fa-check"></i><b>5.9</b> Invoking a function</a><ul>
<li class="chapter" data-level="5.9.1" data-path="functions.html"><a href="functions.html#exercises-17"><i class="fa fa-check"></i><b>5.9.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="functions.html"><a href="functions.html#function-answers"><i class="fa fa-check"></i><b>5.10</b> Quiz answers</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="environments.html"><a href="environments.html"><i class="fa fa-check"></i><b>6</b> Environments</a><ul>
<li class="chapter" data-level="6.1" data-path="environments.html"><a href="environments.html#introduction-5"><i class="fa fa-check"></i><b>6.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="environments.html"><a href="environments.html#quiz-4"><i class="fa fa-check"></i>Quiz</a></li>
<li class="chapter" data-level="" data-path="environments.html"><a href="environments.html#outline-4"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="environments.html"><a href="environments.html#prerequisites-1"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="environments.html"><a href="environments.html#env-basics"><i class="fa fa-check"></i><b>6.2</b> Environment basics</a><ul>
<li class="chapter" data-level="6.2.1" data-path="environments.html"><a href="environments.html#basics"><i class="fa fa-check"></i><b>6.2.1</b> Basics</a></li>
<li class="chapter" data-level="6.2.2" data-path="environments.html"><a href="environments.html#important-environments"><i class="fa fa-check"></i><b>6.2.2</b> Important environments</a></li>
<li class="chapter" data-level="6.2.3" data-path="environments.html"><a href="environments.html#parents"><i class="fa fa-check"></i><b>6.2.3</b> Parents</a></li>
<li class="chapter" data-level="6.2.4" data-path="environments.html"><a href="environments.html#super-assigment--"><i class="fa fa-check"></i><b>6.2.4</b> Super assigment, <code>&lt;&lt;-</code></a></li>
<li class="chapter" data-level="6.2.5" data-path="environments.html"><a href="environments.html#getting-and-setting-1"><i class="fa fa-check"></i><b>6.2.5</b> Getting and setting</a></li>
<li class="chapter" data-level="6.2.6" data-path="environments.html"><a href="environments.html#finalisers"><i class="fa fa-check"></i><b>6.2.6</b> Finalisers</a></li>
<li class="chapter" data-level="6.2.7" data-path="environments.html"><a href="environments.html#advanced-bindings"><i class="fa fa-check"></i><b>6.2.7</b> Advanced bindings</a></li>
<li class="chapter" data-level="6.2.8" data-path="environments.html"><a href="environments.html#exercises-18"><i class="fa fa-check"></i><b>6.2.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="environments.html"><a href="environments.html#env-recursion"><i class="fa fa-check"></i><b>6.3</b> Recursing over environments</a><ul>
<li class="chapter" data-level="6.3.1" data-path="environments.html"><a href="environments.html#exercises-19"><i class="fa fa-check"></i><b>6.3.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="environments.html"><a href="environments.html#function-envs"><i class="fa fa-check"></i><b>6.4</b> Special environments</a><ul>
<li class="chapter" data-level="6.4.1" data-path="environments.html"><a href="environments.html#package-environments-and-the-search-path"><i class="fa fa-check"></i><b>6.4.1</b> Package environments and the search path</a></li>
<li class="chapter" data-level="6.4.2" data-path="environments.html"><a href="environments.html#the-function-environment"><i class="fa fa-check"></i><b>6.4.2</b> The function environment</a></li>
<li class="chapter" data-level="6.4.3" data-path="environments.html"><a href="environments.html#namespaces"><i class="fa fa-check"></i><b>6.4.3</b> Namespaces</a></li>
<li class="chapter" data-level="6.4.4" data-path="environments.html"><a href="environments.html#execution-environments"><i class="fa fa-check"></i><b>6.4.4</b> Execution environments</a></li>
<li class="chapter" data-level="6.4.5" data-path="environments.html"><a href="environments.html#exercises-20"><i class="fa fa-check"></i><b>6.4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="environments.html"><a href="environments.html#call-stack"><i class="fa fa-check"></i><b>6.5</b> The call stack</a><ul>
<li class="chapter" data-level="6.5.1" data-path="environments.html"><a href="environments.html#simple-call-stacks"><i class="fa fa-check"></i><b>6.5.1</b> Simple call stacks</a></li>
<li class="chapter" data-level="6.5.2" data-path="environments.html"><a href="environments.html#lazy-evaluation-1"><i class="fa fa-check"></i><b>6.5.2</b> Lazy evaluation</a></li>
<li class="chapter" data-level="6.5.3" data-path="environments.html"><a href="environments.html#frames"><i class="fa fa-check"></i><b>6.5.3</b> Frames</a></li>
<li class="chapter" data-level="6.5.4" data-path="environments.html"><a href="environments.html#dynamic-scope"><i class="fa fa-check"></i><b>6.5.4</b> Dynamic scope</a></li>
<li class="chapter" data-level="6.5.5" data-path="environments.html"><a href="environments.html#exercises-21"><i class="fa fa-check"></i><b>6.5.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="environments.html"><a href="environments.html#explicit-envs"><i class="fa fa-check"></i><b>6.6</b> As data structures</a></li>
<li class="chapter" data-level="6.7" data-path="environments.html"><a href="environments.html#env-answers"><i class="fa fa-check"></i><b>6.7</b> Quiz answers</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="conditions.html"><a href="conditions.html"><i class="fa fa-check"></i><b>7</b> Conditions</a><ul>
<li class="chapter" data-level="7.1" data-path="conditions.html"><a href="conditions.html#introduction-6"><i class="fa fa-check"></i><b>7.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="conditions.html"><a href="conditions.html#quiz-5"><i class="fa fa-check"></i>Quiz</a></li>
<li class="chapter" data-level="" data-path="conditions.html"><a href="conditions.html#overview"><i class="fa fa-check"></i>Overview</a></li>
<li class="chapter" data-level="7.1.1" data-path="conditions.html"><a href="conditions.html#prerequisites-2"><i class="fa fa-check"></i><b>7.1.1</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="conditions.html"><a href="conditions.html#signalling-conditions"><i class="fa fa-check"></i><b>7.2</b> Signalling conditions</a><ul>
<li class="chapter" data-level="7.2.1" data-path="conditions.html"><a href="conditions.html#errors-1"><i class="fa fa-check"></i><b>7.2.1</b> Errors</a></li>
<li class="chapter" data-level="7.2.2" data-path="conditions.html"><a href="conditions.html#warnings"><i class="fa fa-check"></i><b>7.2.2</b> Warnings</a></li>
<li class="chapter" data-level="7.2.3" data-path="conditions.html"><a href="conditions.html#messages"><i class="fa fa-check"></i><b>7.2.3</b> Messages</a></li>
<li class="chapter" data-level="7.2.4" data-path="conditions.html"><a href="conditions.html#exercises-22"><i class="fa fa-check"></i><b>7.2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="conditions.html"><a href="conditions.html#ignoring-conditions"><i class="fa fa-check"></i><b>7.3</b> Ignoring conditions</a></li>
<li class="chapter" data-level="7.4" data-path="conditions.html"><a href="conditions.html#handling-conditions"><i class="fa fa-check"></i><b>7.4</b> Handling conditions</a><ul>
<li class="chapter" data-level="7.4.1" data-path="conditions.html"><a href="conditions.html#condition-objects"><i class="fa fa-check"></i><b>7.4.1</b> Condition objects</a></li>
<li class="chapter" data-level="7.4.2" data-path="conditions.html"><a href="conditions.html#exiting-handlers"><i class="fa fa-check"></i><b>7.4.2</b> Exiting handlers</a></li>
<li class="chapter" data-level="7.4.3" data-path="conditions.html"><a href="conditions.html#calling-handlers"><i class="fa fa-check"></i><b>7.4.3</b> Calling handlers</a></li>
<li class="chapter" data-level="7.4.4" data-path="conditions.html"><a href="conditions.html#call-stacks"><i class="fa fa-check"></i><b>7.4.4</b> Call stacks</a></li>
<li class="chapter" data-level="7.4.5" data-path="conditions.html"><a href="conditions.html#exercises-23"><i class="fa fa-check"></i><b>7.4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="conditions.html"><a href="conditions.html#custom-conditions"><i class="fa fa-check"></i><b>7.5</b> Custom conditions</a><ul>
<li class="chapter" data-level="7.5.1" data-path="conditions.html"><a href="conditions.html#motivation"><i class="fa fa-check"></i><b>7.5.1</b> Motivation</a></li>
<li class="chapter" data-level="7.5.2" data-path="conditions.html"><a href="conditions.html#signalling"><i class="fa fa-check"></i><b>7.5.2</b> Signalling</a></li>
<li class="chapter" data-level="7.5.3" data-path="conditions.html"><a href="conditions.html#handling"><i class="fa fa-check"></i><b>7.5.3</b> Handling</a></li>
<li class="chapter" data-level="7.5.4" data-path="conditions.html"><a href="conditions.html#exercises-24"><i class="fa fa-check"></i><b>7.5.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="conditions.html"><a href="conditions.html#condition-applications"><i class="fa fa-check"></i><b>7.6</b> Applications</a><ul>
<li class="chapter" data-level="7.6.1" data-path="conditions.html"><a href="conditions.html#failure-value"><i class="fa fa-check"></i><b>7.6.1</b> Failure value</a></li>
<li class="chapter" data-level="7.6.2" data-path="conditions.html"><a href="conditions.html#try-success-failure"><i class="fa fa-check"></i><b>7.6.2</b> Success and failure values</a></li>
<li class="chapter" data-level="7.6.3" data-path="conditions.html"><a href="conditions.html#resignal"><i class="fa fa-check"></i><b>7.6.3</b> Resignal</a></li>
<li class="chapter" data-level="7.6.4" data-path="conditions.html"><a href="conditions.html#record"><i class="fa fa-check"></i><b>7.6.4</b> Record</a></li>
<li class="chapter" data-level="7.6.5" data-path="conditions.html"><a href="conditions.html#no-default-behaviour"><i class="fa fa-check"></i><b>7.6.5</b> No default behaviour</a></li>
<li class="chapter" data-level="7.6.6" data-path="conditions.html"><a href="conditions.html#exercises-25"><i class="fa fa-check"></i><b>7.6.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="conditions.html"><a href="conditions.html#conditions-answers"><i class="fa fa-check"></i><b>7.7</b> Quiz answers</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="connections.html"><a href="connections.html"><i class="fa fa-check"></i><b>8</b> Connections</a><ul>
<li class="chapter" data-level="8.1" data-path="connections.html"><a href="connections.html#basics-1"><i class="fa fa-check"></i><b>8.1</b> Basics</a></li>
<li class="chapter" data-level="8.2" data-path="connections.html"><a href="connections.html#reading-and-writing-binary-data"><i class="fa fa-check"></i><b>8.2</b> Reading and writing binary data</a></li>
<li class="chapter" data-level="8.3" data-path="connections.html"><a href="connections.html#reading-and-writing-text-data"><i class="fa fa-check"></i><b>8.3</b> Reading and writing text data</a></li>
</ul></li>
<li class="part"><span><b>II Functional programming</b></span></li>
<li class="chapter" data-level="" data-path="fp.html"><a href="fp.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="" data-path="fp.html"><a href="fp.html#functional-programming-languages"><i class="fa fa-check"></i>Functional programming languages</a></li>
<li class="chapter" data-level="" data-path="fp.html"><a href="fp.html#functional-style"><i class="fa fa-check"></i>Functional style</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="functionals.html"><a href="functionals.html"><i class="fa fa-check"></i><b>9</b> Functionals</a><ul>
<li class="chapter" data-level="9.1" data-path="functionals.html"><a href="functionals.html#introduction-7"><i class="fa fa-check"></i><b>9.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="functionals.html"><a href="functionals.html#outline-5"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="functionals.html"><a href="functionals.html#prerequisites-3"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="functionals.html"><a href="functionals.html#map"><i class="fa fa-check"></i><b>9.2</b> My first functional: <code>map()</code></a><ul>
<li class="chapter" data-level="9.2.1" data-path="functionals.html"><a href="functionals.html#producing-atomic-vectors"><i class="fa fa-check"></i><b>9.2.1</b> Producing atomic vectors</a></li>
<li class="chapter" data-level="9.2.2" data-path="functionals.html"><a href="functionals.html#purrr-shortcuts"><i class="fa fa-check"></i><b>9.2.2</b> Anonymous functions and shortcuts</a></li>
<li class="chapter" data-level="9.2.3" data-path="functionals.html"><a href="functionals.html#passing-arguments"><i class="fa fa-check"></i><b>9.2.3</b> Passing arguments with <code>...</code></a></li>
<li class="chapter" data-level="9.2.4" data-path="functionals.html"><a href="functionals.html#argument-names"><i class="fa fa-check"></i><b>9.2.4</b> Argument names</a></li>
<li class="chapter" data-level="9.2.5" data-path="functionals.html"><a href="functionals.html#change-argument"><i class="fa fa-check"></i><b>9.2.5</b> Varying another argument</a></li>
<li class="chapter" data-level="9.2.6" data-path="functionals.html"><a href="functionals.html#exercises-26"><i class="fa fa-check"></i><b>9.2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="functionals.html"><a href="functionals.html#purrr-style"><i class="fa fa-check"></i><b>9.3</b> Purrr style</a></li>
<li class="chapter" data-level="9.4" data-path="functionals.html"><a href="functionals.html#map-variants"><i class="fa fa-check"></i><b>9.4</b> Map variants</a><ul>
<li class="chapter" data-level="9.4.1" data-path="functionals.html"><a href="functionals.html#modify"><i class="fa fa-check"></i><b>9.4.1</b> Same type of output as input: <code>modify()</code></a></li>
<li class="chapter" data-level="9.4.2" data-path="functionals.html"><a href="functionals.html#map2"><i class="fa fa-check"></i><b>9.4.2</b> Two inputs: <code>map2()</code> and friends</a></li>
<li class="chapter" data-level="9.4.3" data-path="functionals.html"><a href="functionals.html#no-outputs-walk-and-friends"><i class="fa fa-check"></i><b>9.4.3</b> No outputs: <code>walk()</code> and friends</a></li>
<li class="chapter" data-level="9.4.4" data-path="functionals.html"><a href="functionals.html#iterating-over-values-and-indices"><i class="fa fa-check"></i><b>9.4.4</b> Iterating over values and indices</a></li>
<li class="chapter" data-level="9.4.5" data-path="functionals.html"><a href="functionals.html#pmap"><i class="fa fa-check"></i><b>9.4.5</b> Any number of inputs: <code>pmap()</code> and friends</a></li>
<li class="chapter" data-level="9.4.6" data-path="functionals.html"><a href="functionals.html#exercises-27"><i class="fa fa-check"></i><b>9.4.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="functionals.html"><a href="functionals.html#reduce"><i class="fa fa-check"></i><b>9.5</b> Reduce</a><ul>
<li class="chapter" data-level="9.5.1" data-path="functionals.html"><a href="functionals.html#basics-2"><i class="fa fa-check"></i><b>9.5.1</b> Basics</a></li>
<li class="chapter" data-level="9.5.2" data-path="functionals.html"><a href="functionals.html#accumulate"><i class="fa fa-check"></i><b>9.5.2</b> Accumulate</a></li>
<li class="chapter" data-level="9.5.3" data-path="functionals.html"><a href="functionals.html#output-types"><i class="fa fa-check"></i><b>9.5.3</b> Output types</a></li>
<li class="chapter" data-level="9.5.4" data-path="functionals.html"><a href="functionals.html#multiple-inputs"><i class="fa fa-check"></i><b>9.5.4</b> Multiple inputs</a></li>
<li class="chapter" data-level="9.5.5" data-path="functionals.html"><a href="functionals.html#map-reduce"><i class="fa fa-check"></i><b>9.5.5</b> Map-reduce</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="functionals.html"><a href="functionals.html#predicate-functionals"><i class="fa fa-check"></i><b>9.6</b> Predicate functionals</a><ul>
<li class="chapter" data-level="9.6.1" data-path="functionals.html"><a href="functionals.html#basics-3"><i class="fa fa-check"></i><b>9.6.1</b> Basics</a></li>
<li class="chapter" data-level="9.6.2" data-path="functionals.html"><a href="functionals.html#predicate-map"><i class="fa fa-check"></i><b>9.6.2</b> Map variants</a></li>
<li class="chapter" data-level="9.6.3" data-path="functionals.html"><a href="functionals.html#exercises-28"><i class="fa fa-check"></i><b>9.6.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="functionals.html"><a href="functionals.html#base-functionals"><i class="fa fa-check"></i><b>9.7</b> Base functionals</a><ul>
<li class="chapter" data-level="9.7.1" data-path="functionals.html"><a href="functionals.html#matrices-and-arrays"><i class="fa fa-check"></i><b>9.7.1</b> Matrices and arrays</a></li>
<li class="chapter" data-level="9.7.2" data-path="functionals.html"><a href="functionals.html#mathematical"><i class="fa fa-check"></i><b>9.7.2</b> Mathematical</a></li>
<li class="chapter" data-level="9.7.3" data-path="functionals.html"><a href="functionals.html#exercises-29"><i class="fa fa-check"></i><b>9.7.3</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="function-factories.html"><a href="function-factories.html"><i class="fa fa-check"></i><b>10</b> Function factories</a><ul>
<li class="chapter" data-level="10.1" data-path="function-factories.html"><a href="function-factories.html#introduction-8"><i class="fa fa-check"></i><b>10.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="function-factories.html"><a href="function-factories.html#outline-6"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="function-factories.html"><a href="function-factories.html#prerequisites-4"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="function-factories.html"><a href="function-factories.html#factory-fundamentals"><i class="fa fa-check"></i><b>10.2</b> Factory fundamentals</a><ul>
<li class="chapter" data-level="10.2.1" data-path="function-factories.html"><a href="function-factories.html#environments-1"><i class="fa fa-check"></i><b>10.2.1</b> Environments</a></li>
<li class="chapter" data-level="10.2.2" data-path="function-factories.html"><a href="function-factories.html#diagram-conventions"><i class="fa fa-check"></i><b>10.2.2</b> Diagram conventions</a></li>
<li class="chapter" data-level="10.2.3" data-path="function-factories.html"><a href="function-factories.html#stateful-funs"><i class="fa fa-check"></i><b>10.2.3</b> Stateful functions</a></li>
<li class="chapter" data-level="10.2.4" data-path="function-factories.html"><a href="function-factories.html#factory-pitfalls"><i class="fa fa-check"></i><b>10.2.4</b> Potential pitfalls</a></li>
<li class="chapter" data-level="10.2.5" data-path="function-factories.html"><a href="function-factories.html#exercises-30"><i class="fa fa-check"></i><b>10.2.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="function-factories.html"><a href="function-factories.html#graph-fact"><i class="fa fa-check"></i><b>10.3</b> Graphical factories</a><ul>
<li class="chapter" data-level="10.3.1" data-path="function-factories.html"><a href="function-factories.html#labelling"><i class="fa fa-check"></i><b>10.3.1</b> Labelling</a></li>
<li class="chapter" data-level="10.3.2" data-path="function-factories.html"><a href="function-factories.html#histogram-bins"><i class="fa fa-check"></i><b>10.3.2</b> Histogram bins</a></li>
<li class="chapter" data-level="10.3.3" data-path="function-factories.html"><a href="function-factories.html#ggsave"><i class="fa fa-check"></i><b>10.3.3</b> ggsave</a></li>
<li class="chapter" data-level="10.3.4" data-path="function-factories.html"><a href="function-factories.html#exercises-31"><i class="fa fa-check"></i><b>10.3.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="function-factories.html"><a href="function-factories.html#stat-fact"><i class="fa fa-check"></i><b>10.4</b> Statistical factories</a><ul>
<li class="chapter" data-level="10.4.1" data-path="function-factories.html"><a href="function-factories.html#box-cox-transformation"><i class="fa fa-check"></i><b>10.4.1</b> Box-Cox transformation</a></li>
<li class="chapter" data-level="10.4.2" data-path="function-factories.html"><a href="function-factories.html#bootstrap-generators"><i class="fa fa-check"></i><b>10.4.2</b> Bootstrap generators</a></li>
<li class="chapter" data-level="10.4.3" data-path="function-factories.html"><a href="function-factories.html#MLE"><i class="fa fa-check"></i><b>10.4.3</b> Maximum likelihood estimation</a></li>
<li class="chapter" data-level="10.4.4" data-path="function-factories.html"><a href="function-factories.html#exercises-32"><i class="fa fa-check"></i><b>10.4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="function-factories.html"><a href="function-factories.html#functional-factories"><i class="fa fa-check"></i><b>10.5</b> Function factories + functionals</a><ul>
<li class="chapter" data-level="10.5.1" data-path="function-factories.html"><a href="function-factories.html#moving-a-list-to-the-global-environment"><i class="fa fa-check"></i><b>10.5.1</b> Moving a list to the global environment</a></li>
<li class="chapter" data-level="10.5.2" data-path="function-factories.html"><a href="function-factories.html#another-approach"><i class="fa fa-check"></i><b>10.5.2</b> Another approach</a></li>
<li class="chapter" data-level="10.5.3" data-path="function-factories.html"><a href="function-factories.html#exercises-33"><i class="fa fa-check"></i><b>10.5.3</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="function-operators.html"><a href="function-operators.html"><i class="fa fa-check"></i><b>11</b> Function operators</a><ul>
<li class="chapter" data-level="11.1" data-path="function-operators.html"><a href="function-operators.html#introduction-9"><i class="fa fa-check"></i><b>11.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="function-operators.html"><a href="function-operators.html#outline-7"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="function-operators.html"><a href="function-operators.html#prerequisites-5"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="11.1.1" data-path="function-operators.html"><a href="function-operators.html#in-other-languages"><i class="fa fa-check"></i><b>11.1.1</b> In other languages</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="function-operators.html"><a href="function-operators.html#existing-fos"><i class="fa fa-check"></i><b>11.2</b> Existing FOs</a><ul>
<li class="chapter" data-level="11.2.1" data-path="function-operators.html"><a href="function-operators.html#safely"><i class="fa fa-check"></i><b>11.2.1</b> Capturing errors with <code>purrr::safely()</code></a></li>
<li class="chapter" data-level="11.2.2" data-path="function-operators.html"><a href="function-operators.html#memoise"><i class="fa fa-check"></i><b>11.2.2</b> Caching computations with <code>memoise::memoise()</code></a></li>
<li class="chapter" data-level="11.2.3" data-path="function-operators.html"><a href="function-operators.html#exercises-34"><i class="fa fa-check"></i><b>11.2.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="function-operators.html"><a href="function-operators.html#fo-case-study"><i class="fa fa-check"></i><b>11.3</b> Case study: creating your own FOs</a><ul>
<li class="chapter" data-level="11.3.1" data-path="function-operators.html"><a href="function-operators.html#exercises-35"><i class="fa fa-check"></i><b>11.3.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Object oriented programming</b></span></li>
<li class="chapter" data-level="" data-path="oo.html"><a href="oo.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="" data-path="oo.html"><a href="oo.html#oop-systems"><i class="fa fa-check"></i>OOP systems</a></li>
<li class="chapter" data-level="" data-path="oo.html"><a href="oo.html#oop-in-r"><i class="fa fa-check"></i>OOP in R</a></li>
<li class="chapter" data-level="" data-path="oo.html"><a href="oo.html#sloop"><i class="fa fa-check"></i>sloop</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="base-types.html"><a href="base-types.html"><i class="fa fa-check"></i><b>12</b> Base types</a><ul>
<li class="chapter" data-level="12.1" data-path="base-types.html"><a href="base-types.html#introduction-10"><i class="fa fa-check"></i><b>12.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="base-types.html"><a href="base-types.html#outline-8"><i class="fa fa-check"></i>Outline</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="base-types.html"><a href="base-types.html#base-vs-oo"><i class="fa fa-check"></i><b>12.2</b> Base vs OO objects</a></li>
<li class="chapter" data-level="12.3" data-path="base-types.html"><a href="base-types.html#base-types-2"><i class="fa fa-check"></i><b>12.3</b> Base types</a><ul>
<li class="chapter" data-level="12.3.1" data-path="base-types.html"><a href="base-types.html#numeric-type"><i class="fa fa-check"></i><b>12.3.1</b> Numeric type</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="s3.html"><a href="s3.html"><i class="fa fa-check"></i><b>13</b> S3</a><ul>
<li class="chapter" data-level="13.1" data-path="s3.html"><a href="s3.html#introduction-11"><i class="fa fa-check"></i><b>13.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="s3.html"><a href="s3.html#outline-9"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="s3.html"><a href="s3.html#prerequisites-6"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="s3.html"><a href="s3.html#s3-basics"><i class="fa fa-check"></i><b>13.2</b> Basics</a><ul>
<li class="chapter" data-level="13.2.1" data-path="s3.html"><a href="s3.html#exercises-36"><i class="fa fa-check"></i><b>13.2.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="s3.html"><a href="s3.html#s3-classes"><i class="fa fa-check"></i><b>13.3</b> Classes</a><ul>
<li class="chapter" data-level="13.3.1" data-path="s3.html"><a href="s3.html#s3-constrcutor"><i class="fa fa-check"></i><b>13.3.1</b> Constructors</a></li>
<li class="chapter" data-level="13.3.2" data-path="s3.html"><a href="s3.html#validators"><i class="fa fa-check"></i><b>13.3.2</b> Validators</a></li>
<li class="chapter" data-level="13.3.3" data-path="s3.html"><a href="s3.html#helpers"><i class="fa fa-check"></i><b>13.3.3</b> Helpers</a></li>
<li class="chapter" data-level="13.3.4" data-path="s3.html"><a href="s3.html#exercises-37"><i class="fa fa-check"></i><b>13.3.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="s3.html"><a href="s3.html#s3-methods"><i class="fa fa-check"></i><b>13.4</b> Generics and methods</a><ul>
<li class="chapter" data-level="13.4.1" data-path="s3.html"><a href="s3.html#method-dispatch"><i class="fa fa-check"></i><b>13.4.1</b> Method dispatch</a></li>
<li class="chapter" data-level="13.4.2" data-path="s3.html"><a href="s3.html#finding-methods"><i class="fa fa-check"></i><b>13.4.2</b> Finding methods</a></li>
<li class="chapter" data-level="13.4.3" data-path="s3.html"><a href="s3.html#s3-arguments"><i class="fa fa-check"></i><b>13.4.3</b> Creating methods</a></li>
<li class="chapter" data-level="13.4.4" data-path="s3.html"><a href="s3.html#exercises-38"><i class="fa fa-check"></i><b>13.4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="s3.html"><a href="s3.html#object-styles"><i class="fa fa-check"></i><b>13.5</b> Object styles</a><ul>
<li class="chapter" data-level="13.5.1" data-path="s3.html"><a href="s3.html#exercises-39"><i class="fa fa-check"></i><b>13.5.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="s3.html"><a href="s3.html#s3-inheritance"><i class="fa fa-check"></i><b>13.6</b> Inheritance</a><ul>
<li class="chapter" data-level="13.6.1" data-path="s3.html"><a href="s3.html#nextmethod"><i class="fa fa-check"></i><b>13.6.1</b> <code>NextMethod()</code></a></li>
<li class="chapter" data-level="13.6.2" data-path="s3.html"><a href="s3.html#s3-subclassing"><i class="fa fa-check"></i><b>13.6.2</b> Allowing subclassing</a></li>
<li class="chapter" data-level="13.6.3" data-path="s3.html"><a href="s3.html#exercises-40"><i class="fa fa-check"></i><b>13.6.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13.7" data-path="s3.html"><a href="s3.html#s3-dispatch"><i class="fa fa-check"></i><b>13.7</b> Dispatch details</a><ul>
<li class="chapter" data-level="13.7.1" data-path="s3.html"><a href="s3.html#implicit-class"><i class="fa fa-check"></i><b>13.7.1</b> S3 and base types</a></li>
<li class="chapter" data-level="13.7.2" data-path="s3.html"><a href="s3.html#internal-generics"><i class="fa fa-check"></i><b>13.7.2</b> Internal generics</a></li>
<li class="chapter" data-level="13.7.3" data-path="s3.html"><a href="s3.html#group-generics"><i class="fa fa-check"></i><b>13.7.3</b> Group generics</a></li>
<li class="chapter" data-level="13.7.4" data-path="s3.html"><a href="s3.html#double-dispatch"><i class="fa fa-check"></i><b>13.7.4</b> Double dispatch</a></li>
<li class="chapter" data-level="13.7.5" data-path="s3.html"><a href="s3.html#exercises-41"><i class="fa fa-check"></i><b>13.7.5</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="r6.html"><a href="r6.html"><i class="fa fa-check"></i><b>14</b> R6</a><ul>
<li class="chapter" data-level="14.1" data-path="r6.html"><a href="r6.html#introduction-12"><i class="fa fa-check"></i><b>14.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="r6.html"><a href="r6.html#outline-10"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="r6.html"><a href="r6.html#prerequisites-7"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="r6.html"><a href="r6.html#r6-classes"><i class="fa fa-check"></i><b>14.2</b> Classes and methods</a><ul>
<li class="chapter" data-level="14.2.1" data-path="r6.html"><a href="r6.html#method-chaining"><i class="fa fa-check"></i><b>14.2.1</b> Method chaining</a></li>
<li class="chapter" data-level="14.2.2" data-path="r6.html"><a href="r6.html#r6-important-methods"><i class="fa fa-check"></i><b>14.2.2</b> Important methods</a></li>
<li class="chapter" data-level="14.2.3" data-path="r6.html"><a href="r6.html#adding-methods-after-creation"><i class="fa fa-check"></i><b>14.2.3</b> Adding methods after creation</a></li>
<li class="chapter" data-level="14.2.4" data-path="r6.html"><a href="r6.html#inheritance"><i class="fa fa-check"></i><b>14.2.4</b> Inheritance</a></li>
<li class="chapter" data-level="14.2.5" data-path="r6.html"><a href="r6.html#introspection"><i class="fa fa-check"></i><b>14.2.5</b> Introspection</a></li>
<li class="chapter" data-level="14.2.6" data-path="r6.html"><a href="r6.html#exercises-42"><i class="fa fa-check"></i><b>14.2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="r6.html"><a href="r6.html#r6-access"><i class="fa fa-check"></i><b>14.3</b> Controlling access</a><ul>
<li class="chapter" data-level="14.3.1" data-path="r6.html"><a href="r6.html#privacy"><i class="fa fa-check"></i><b>14.3.1</b> Privacy</a></li>
<li class="chapter" data-level="14.3.2" data-path="r6.html"><a href="r6.html#active-fields"><i class="fa fa-check"></i><b>14.3.2</b> Active fields</a></li>
<li class="chapter" data-level="14.3.3" data-path="r6.html"><a href="r6.html#exercises-43"><i class="fa fa-check"></i><b>14.3.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="r6.html"><a href="r6.html#r6-semantics"><i class="fa fa-check"></i><b>14.4</b> Reference semantics</a><ul>
<li class="chapter" data-level="14.4.1" data-path="r6.html"><a href="r6.html#reasoning"><i class="fa fa-check"></i><b>14.4.1</b> Reasoning</a></li>
<li class="chapter" data-level="14.4.2" data-path="r6.html"><a href="r6.html#finalizer"><i class="fa fa-check"></i><b>14.4.2</b> Finalizer</a></li>
<li class="chapter" data-level="14.4.3" data-path="r6.html"><a href="r6.html#r6-fields"><i class="fa fa-check"></i><b>14.4.3</b> R6 fields</a></li>
<li class="chapter" data-level="14.4.4" data-path="r6.html"><a href="r6.html#exercises-44"><i class="fa fa-check"></i><b>14.4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="r6.html"><a href="r6.html#why-r6"><i class="fa fa-check"></i><b>14.5</b> Why R6?</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="s4.html"><a href="s4.html"><i class="fa fa-check"></i><b>15</b> S4</a><ul>
<li class="chapter" data-level="15.1" data-path="s4.html"><a href="s4.html#introduction-13"><i class="fa fa-check"></i><b>15.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="s4.html"><a href="s4.html#learning-more"><i class="fa fa-check"></i>Learning more</a></li>
<li class="chapter" data-level="" data-path="s4.html"><a href="s4.html#outline-11"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="s4.html"><a href="s4.html#prerequisites-8"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="s4.html"><a href="s4.html#s4-basics"><i class="fa fa-check"></i><b>15.2</b> Basics</a><ul>
<li class="chapter" data-level="15.2.1" data-path="s4.html"><a href="s4.html#exercises-45"><i class="fa fa-check"></i><b>15.2.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="s4.html"><a href="s4.html#s4-classes"><i class="fa fa-check"></i><b>15.3</b> Classes</a><ul>
<li class="chapter" data-level="15.3.1" data-path="s4.html"><a href="s4.html#inheritance-1"><i class="fa fa-check"></i><b>15.3.1</b> Inheritance</a></li>
<li class="chapter" data-level="15.3.2" data-path="s4.html"><a href="s4.html#introspection-1"><i class="fa fa-check"></i><b>15.3.2</b> Introspection</a></li>
<li class="chapter" data-level="15.3.3" data-path="s4.html"><a href="s4.html#redefinition"><i class="fa fa-check"></i><b>15.3.3</b> Redefinition</a></li>
<li class="chapter" data-level="15.3.4" data-path="s4.html"><a href="s4.html#helper"><i class="fa fa-check"></i><b>15.3.4</b> Helper</a></li>
<li class="chapter" data-level="15.3.5" data-path="s4.html"><a href="s4.html#validator"><i class="fa fa-check"></i><b>15.3.5</b> Validator</a></li>
<li class="chapter" data-level="15.3.6" data-path="s4.html"><a href="s4.html#exercises-46"><i class="fa fa-check"></i><b>15.3.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="s4.html"><a href="s4.html#s4-generics"><i class="fa fa-check"></i><b>15.4</b> Generics and methods</a><ul>
<li class="chapter" data-level="15.4.1" data-path="s4.html"><a href="s4.html#signature"><i class="fa fa-check"></i><b>15.4.1</b> Signature</a></li>
<li class="chapter" data-level="15.4.2" data-path="s4.html"><a href="s4.html#methods"><i class="fa fa-check"></i><b>15.4.2</b> Methods</a></li>
<li class="chapter" data-level="15.4.3" data-path="s4.html"><a href="s4.html#show-method"><i class="fa fa-check"></i><b>15.4.3</b> Show method</a></li>
<li class="chapter" data-level="15.4.4" data-path="s4.html"><a href="s4.html#accessors"><i class="fa fa-check"></i><b>15.4.4</b> Accessors</a></li>
<li class="chapter" data-level="15.4.5" data-path="s4.html"><a href="s4.html#exercises-47"><i class="fa fa-check"></i><b>15.4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="s4.html"><a href="s4.html#s4-dispatch"><i class="fa fa-check"></i><b>15.5</b> Method dispatch</a><ul>
<li class="chapter" data-level="15.5.1" data-path="s4.html"><a href="s4.html#single-dispatch"><i class="fa fa-check"></i><b>15.5.1</b> Single dispatch</a></li>
<li class="chapter" data-level="15.5.2" data-path="s4.html"><a href="s4.html#multiple-inheritance"><i class="fa fa-check"></i><b>15.5.2</b> Multiple inheritance</a></li>
<li class="chapter" data-level="15.5.3" data-path="s4.html"><a href="s4.html#multiple-dispatch"><i class="fa fa-check"></i><b>15.5.3</b> Multiple dispatch</a></li>
<li class="chapter" data-level="15.5.4" data-path="s4.html"><a href="s4.html#multiple-dispatch-and-multiple-inheritance"><i class="fa fa-check"></i><b>15.5.4</b> Multiple dispatch and multiple inheritance</a></li>
<li class="chapter" data-level="15.5.5" data-path="s4.html"><a href="s4.html#exercises-48"><i class="fa fa-check"></i><b>15.5.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="s4.html"><a href="s4.html#s4-s3"><i class="fa fa-check"></i><b>15.6</b> S4 and S3</a><ul>
<li class="chapter" data-level="15.6.1" data-path="s4.html"><a href="s4.html#classes"><i class="fa fa-check"></i><b>15.6.1</b> Classes</a></li>
<li class="chapter" data-level="15.6.2" data-path="s4.html"><a href="s4.html#generics"><i class="fa fa-check"></i><b>15.6.2</b> Generics</a></li>
<li class="chapter" data-level="15.6.3" data-path="s4.html"><a href="s4.html#exercises-49"><i class="fa fa-check"></i><b>15.6.3</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html"><i class="fa fa-check"></i><b>16</b> Trade-offs</a><ul>
<li class="chapter" data-level="16.1" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html#introduction-14"><i class="fa fa-check"></i><b>16.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html#outline-12"><i class="fa fa-check"></i>Outline</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html#s3-s4"><i class="fa fa-check"></i><b>16.2</b> S4 vs S3</a></li>
<li class="chapter" data-level="16.3" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html#s3-r6"><i class="fa fa-check"></i><b>16.3</b> R6 vs S3</a><ul>
<li class="chapter" data-level="16.3.1" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html#namespacing"><i class="fa fa-check"></i><b>16.3.1</b> Namespacing</a></li>
<li class="chapter" data-level="16.3.2" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html#threading-state"><i class="fa fa-check"></i><b>16.3.2</b> Threading state</a></li>
<li class="chapter" data-level="16.3.3" data-path="oo-tradeoffs.html"><a href="oo-tradeoffs.html#tradeoffs-pipe"><i class="fa fa-check"></i><b>16.3.3</b> Method chaining</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Metaprogramming</b></span></li>
<li class="chapter" data-level="" data-path="meta.html"><a href="meta.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="16.4" data-path="meta.html"><a href="meta.html#big-ideas"><i class="fa fa-check"></i><b>16.4</b> Big ideas</a><ul>
<li class="chapter" data-level="16.4.1" data-path="meta.html"><a href="meta.html#code-is-data"><i class="fa fa-check"></i><b>16.4.1</b> Code is data</a></li>
<li class="chapter" data-level="16.4.2" data-path="meta.html"><a href="meta.html#code-is-a-tree"><i class="fa fa-check"></i><b>16.4.2</b> Code is a tree</a></li>
<li class="chapter" data-level="16.4.3" data-path="meta.html"><a href="meta.html#code-can-generate-code"><i class="fa fa-check"></i><b>16.4.3</b> Code can generate code</a></li>
<li class="chapter" data-level="16.4.4" data-path="meta.html"><a href="meta.html#evaluation-excutes-an-expression-in-an-environment"><i class="fa fa-check"></i><b>16.4.4</b> Evaluation excutes an expression in an environment</a></li>
<li class="chapter" data-level="16.4.5" data-path="meta.html"><a href="meta.html#you-can-override-functions-to-make-a-dsl"><i class="fa fa-check"></i><b>16.4.5</b> You can override functions to make a DSL</a></li>
<li class="chapter" data-level="16.4.6" data-path="meta.html"><a href="meta.html#data-masks-blur-the-line-between-data-frames-and-environments"><i class="fa fa-check"></i><b>16.4.6</b> Data masks blur the line between data frames and environments</a></li>
<li class="chapter" data-level="16.4.7" data-path="meta.html"><a href="meta.html#quosures-capture-an-expression-with-its-environment"><i class="fa fa-check"></i><b>16.4.7</b> Quosures capture an expression with its environment</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="meta.html"><a href="meta.html#overview-1"><i class="fa fa-check"></i>Overview</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="expressions.html"><a href="expressions.html"><i class="fa fa-check"></i><b>17</b> Expressions</a><ul>
<li class="chapter" data-level="17.1" data-path="expressions.html"><a href="expressions.html#introduction-15"><i class="fa fa-check"></i><b>17.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="expressions.html"><a href="expressions.html#outline-13"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="expressions.html"><a href="expressions.html#prerequisites-9"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="expressions.html"><a href="expressions.html#abstract-syntax-trees"><i class="fa fa-check"></i><b>17.2</b> Abstract syntax trees</a><ul>
<li class="chapter" data-level="17.2.1" data-path="expressions.html"><a href="expressions.html#drawing"><i class="fa fa-check"></i><b>17.2.1</b> Drawing</a></li>
<li class="chapter" data-level="17.2.2" data-path="expressions.html"><a href="expressions.html#non-code-components"><i class="fa fa-check"></i><b>17.2.2</b> Non-code components</a></li>
<li class="chapter" data-level="17.2.3" data-path="expressions.html"><a href="expressions.html#infix-calls"><i class="fa fa-check"></i><b>17.2.3</b> Infix calls</a></li>
<li class="chapter" data-level="17.2.4" data-path="expressions.html"><a href="expressions.html#exercises-50"><i class="fa fa-check"></i><b>17.2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="expressions.html"><a href="expressions.html#expressions-1"><i class="fa fa-check"></i><b>17.3</b> Expressions</a><ul>
<li class="chapter" data-level="17.3.1" data-path="expressions.html"><a href="expressions.html#constants"><i class="fa fa-check"></i><b>17.3.1</b> Constants</a></li>
<li class="chapter" data-level="17.3.2" data-path="expressions.html"><a href="expressions.html#symbols"><i class="fa fa-check"></i><b>17.3.2</b> Symbols</a></li>
<li class="chapter" data-level="17.3.3" data-path="expressions.html"><a href="expressions.html#calls"><i class="fa fa-check"></i><b>17.3.3</b> Calls</a></li>
<li class="chapter" data-level="17.3.4" data-path="expressions.html"><a href="expressions.html#vocabulary"><i class="fa fa-check"></i><b>17.3.4</b> Vocabulary</a></li>
<li class="chapter" data-level="17.3.5" data-path="expressions.html"><a href="expressions.html#exercises-51"><i class="fa fa-check"></i><b>17.3.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="expressions.html"><a href="expressions.html#grammar"><i class="fa fa-check"></i><b>17.4</b> Parsing and grammar</a><ul>
<li class="chapter" data-level="17.4.1" data-path="expressions.html"><a href="expressions.html#operator-precedence"><i class="fa fa-check"></i><b>17.4.1</b> Operator precedence</a></li>
<li class="chapter" data-level="17.4.2" data-path="expressions.html"><a href="expressions.html#associativity"><i class="fa fa-check"></i><b>17.4.2</b> Associativity</a></li>
<li class="chapter" data-level="17.4.3" data-path="expressions.html"><a href="expressions.html#parsing-and-deparsing"><i class="fa fa-check"></i><b>17.4.3</b> Parsing and deparsing</a></li>
<li class="chapter" data-level="17.4.4" data-path="expressions.html"><a href="expressions.html#exercises-52"><i class="fa fa-check"></i><b>17.4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="expressions.html"><a href="expressions.html#ast-funs"><i class="fa fa-check"></i><b>17.5</b> Walking the AST with recursive functions</a><ul>
<li class="chapter" data-level="17.5.1" data-path="expressions.html"><a href="expressions.html#finding-f-and-t"><i class="fa fa-check"></i><b>17.5.1</b> Finding F and T</a></li>
<li class="chapter" data-level="17.5.2" data-path="expressions.html"><a href="expressions.html#finding-all-variables-created-by-assignment"><i class="fa fa-check"></i><b>17.5.2</b> Finding all variables created by assignment</a></li>
<li class="chapter" data-level="17.5.3" data-path="expressions.html"><a href="expressions.html#exercises-53"><i class="fa fa-check"></i><b>17.5.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="17.6" data-path="expressions.html"><a href="expressions.html#specialised-data-structures"><i class="fa fa-check"></i><b>17.6</b> Specialised data structures</a><ul>
<li class="chapter" data-level="17.6.1" data-path="expressions.html"><a href="expressions.html#pairlists"><i class="fa fa-check"></i><b>17.6.1</b> Pairlists</a></li>
<li class="chapter" data-level="17.6.2" data-path="expressions.html"><a href="expressions.html#empty-symbol"><i class="fa fa-check"></i><b>17.6.2</b> Missing arguments</a></li>
<li class="chapter" data-level="17.6.3" data-path="expressions.html"><a href="expressions.html#expression-vectors"><i class="fa fa-check"></i><b>17.6.3</b> Expression vectors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="quasiquotation.html"><a href="quasiquotation.html"><i class="fa fa-check"></i><b>18</b> Quasiquotation</a><ul>
<li class="chapter" data-level="18.1" data-path="quasiquotation.html"><a href="quasiquotation.html#introduction-16"><i class="fa fa-check"></i><b>18.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="quasiquotation.html"><a href="quasiquotation.html#outline-14"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="quasiquotation.html"><a href="quasiquotation.html#prerequisites-10"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="quasiquotation.html"><a href="quasiquotation.html#related-work"><i class="fa fa-check"></i>Related work</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="quasiquotation.html"><a href="quasiquotation.html#quasi-motivation"><i class="fa fa-check"></i><b>18.2</b> Motivation</a><ul>
<li class="chapter" data-level="18.2.1" data-path="quasiquotation.html"><a href="quasiquotation.html#vocabulary-1"><i class="fa fa-check"></i><b>18.2.1</b> Vocabulary</a></li>
<li class="chapter" data-level="18.2.2" data-path="quasiquotation.html"><a href="quasiquotation.html#history"><i class="fa fa-check"></i><b>18.2.2</b> History</a></li>
<li class="chapter" data-level="18.2.3" data-path="quasiquotation.html"><a href="quasiquotation.html#exercises-54"><i class="fa fa-check"></i><b>18.2.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="quasiquotation.html"><a href="quasiquotation.html#quoting"><i class="fa fa-check"></i><b>18.3</b> Quoting</a><ul>
<li class="chapter" data-level="18.3.1" data-path="quasiquotation.html"><a href="quasiquotation.html#capturing-expressions"><i class="fa fa-check"></i><b>18.3.1</b> Capturing expressions</a></li>
<li class="chapter" data-level="18.3.2" data-path="quasiquotation.html"><a href="quasiquotation.html#capturing-symbols"><i class="fa fa-check"></i><b>18.3.2</b> Capturing symbols</a></li>
<li class="chapter" data-level="18.3.3" data-path="quasiquotation.html"><a href="quasiquotation.html#with-base-r"><i class="fa fa-check"></i><b>18.3.3</b> With base R</a></li>
<li class="chapter" data-level="18.3.4" data-path="quasiquotation.html"><a href="quasiquotation.html#summary"><i class="fa fa-check"></i><b>18.3.4</b> Summary</a></li>
<li class="chapter" data-level="18.3.5" data-path="quasiquotation.html"><a href="quasiquotation.html#exercises-55"><i class="fa fa-check"></i><b>18.3.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="quasiquotation.html"><a href="quasiquotation.html#unquoting"><i class="fa fa-check"></i><b>18.4</b> Unquoting</a><ul>
<li class="chapter" data-level="18.4.1" data-path="quasiquotation.html"><a href="quasiquotation.html#unquoting-one-argument"><i class="fa fa-check"></i><b>18.4.1</b> Unquoting one argument</a></li>
<li class="chapter" data-level="18.4.2" data-path="quasiquotation.html"><a href="quasiquotation.html#unquoting-a-function"><i class="fa fa-check"></i><b>18.4.2</b> Unquoting a function</a></li>
<li class="chapter" data-level="18.4.3" data-path="quasiquotation.html"><a href="quasiquotation.html#unquote-missing"><i class="fa fa-check"></i><b>18.4.3</b> Unquoting a missing argument</a></li>
<li class="chapter" data-level="18.4.4" data-path="quasiquotation.html"><a href="quasiquotation.html#unquoting-in-special-forms"><i class="fa fa-check"></i><b>18.4.4</b> Unquoting in special forms</a></li>
<li class="chapter" data-level="18.4.5" data-path="quasiquotation.html"><a href="quasiquotation.html#unquoting-many-arguments"><i class="fa fa-check"></i><b>18.4.5</b> Unquoting many arguments</a></li>
<li class="chapter" data-level="18.4.6" data-path="quasiquotation.html"><a href="quasiquotation.html#the-polite-fiction-of"><i class="fa fa-check"></i><b>18.4.6</b> The polite fiction of <code>!!</code></a></li>
<li class="chapter" data-level="18.4.7" data-path="quasiquotation.html"><a href="quasiquotation.html#non-standard-ast"><i class="fa fa-check"></i><b>18.4.7</b> Non-standard ASTs</a></li>
<li class="chapter" data-level="18.4.8" data-path="quasiquotation.html"><a href="quasiquotation.html#exercises-56"><i class="fa fa-check"></i><b>18.4.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="quasiquotation.html"><a href="quasiquotation.html#base-nonquote"><i class="fa fa-check"></i><b>18.5</b> Non-quoting in base R</a></li>
<li class="chapter" data-level="18.6" data-path="quasiquotation.html"><a href="quasiquotation.html#tidy-dots"><i class="fa fa-check"></i><b>18.6</b> Dot-dot-dot (<code>...</code>)</a><ul>
<li class="chapter" data-level="18.6.1" data-path="quasiquotation.html"><a href="quasiquotation.html#examples"><i class="fa fa-check"></i><b>18.6.1</b> Examples</a></li>
<li class="chapter" data-level="18.6.2" data-path="quasiquotation.html"><a href="quasiquotation.html#exec"><i class="fa fa-check"></i><b>18.6.2</b> <code>exec()</code></a></li>
<li class="chapter" data-level="18.6.3" data-path="quasiquotation.html"><a href="quasiquotation.html#dots_list"><i class="fa fa-check"></i><b>18.6.3</b> <code>dots_list()</code></a></li>
<li class="chapter" data-level="18.6.4" data-path="quasiquotation.html"><a href="quasiquotation.html#do-call"><i class="fa fa-check"></i><b>18.6.4</b> With base R</a></li>
<li class="chapter" data-level="18.6.5" data-path="quasiquotation.html"><a href="quasiquotation.html#exercises-57"><i class="fa fa-check"></i><b>18.6.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="18.7" data-path="quasiquotation.html"><a href="quasiquotation.html#expr-case-studies"><i class="fa fa-check"></i><b>18.7</b> Case studies</a><ul>
<li class="chapter" data-level="18.7.1" data-path="quasiquotation.html"><a href="quasiquotation.html#lobstrast"><i class="fa fa-check"></i><b>18.7.1</b> <code>lobstr::ast()</code></a></li>
<li class="chapter" data-level="18.7.2" data-path="quasiquotation.html"><a href="quasiquotation.html#map-reduce-to-generate-code"><i class="fa fa-check"></i><b>18.7.2</b> Map-reduce to generate code</a></li>
<li class="chapter" data-level="18.7.3" data-path="quasiquotation.html"><a href="quasiquotation.html#slicing-an-array"><i class="fa fa-check"></i><b>18.7.3</b> Slicing an array</a></li>
<li class="chapter" data-level="18.7.4" data-path="quasiquotation.html"><a href="quasiquotation.html#new-function"><i class="fa fa-check"></i><b>18.7.4</b> Creating functions</a></li>
<li class="chapter" data-level="18.7.5" data-path="quasiquotation.html"><a href="quasiquotation.html#exercises-58"><i class="fa fa-check"></i><b>18.7.5</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="evaluation.html"><a href="evaluation.html"><i class="fa fa-check"></i><b>19</b> Evaluation</a><ul>
<li class="chapter" data-level="19.1" data-path="evaluation.html"><a href="evaluation.html#introduction-17"><i class="fa fa-check"></i><b>19.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="evaluation.html"><a href="evaluation.html#outline-15"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="evaluation.html"><a href="evaluation.html#prerequisites-11"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="19.2" data-path="evaluation.html"><a href="evaluation.html#eval"><i class="fa fa-check"></i><b>19.2</b> Evaluation basics</a><ul>
<li class="chapter" data-level="19.2.1" data-path="evaluation.html"><a href="evaluation.html#application-local"><i class="fa fa-check"></i><b>19.2.1</b> Application: <code>local()</code></a></li>
<li class="chapter" data-level="19.2.2" data-path="evaluation.html"><a href="evaluation.html#application-source"><i class="fa fa-check"></i><b>19.2.2</b> Application: <code>source()</code></a></li>
<li class="chapter" data-level="19.2.3" data-path="evaluation.html"><a href="evaluation.html#gotcha-function"><i class="fa fa-check"></i><b>19.2.3</b> Gotcha: <code>function()</code></a></li>
<li class="chapter" data-level="19.2.4" data-path="evaluation.html"><a href="evaluation.html#evaluation-vs.unquotation"><i class="fa fa-check"></i><b>19.2.4</b> Evaluation vs. unquotation</a></li>
<li class="chapter" data-level="19.2.5" data-path="evaluation.html"><a href="evaluation.html#base-r"><i class="fa fa-check"></i><b>19.2.5</b> Base R</a></li>
<li class="chapter" data-level="19.2.6" data-path="evaluation.html"><a href="evaluation.html#exercises-59"><i class="fa fa-check"></i><b>19.2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="evaluation.html"><a href="evaluation.html#quosures"><i class="fa fa-check"></i><b>19.3</b> Quosures</a><ul>
<li class="chapter" data-level="19.3.1" data-path="evaluation.html"><a href="evaluation.html#creating"><i class="fa fa-check"></i><b>19.3.1</b> Creating</a></li>
<li class="chapter" data-level="19.3.2" data-path="evaluation.html"><a href="evaluation.html#evaluating"><i class="fa fa-check"></i><b>19.3.2</b> Evaluating</a></li>
<li class="chapter" data-level="19.3.3" data-path="evaluation.html"><a href="evaluation.html#dots"><i class="fa fa-check"></i><b>19.3.3</b> Dots</a></li>
<li class="chapter" data-level="19.3.4" data-path="evaluation.html"><a href="evaluation.html#quosure-impl"><i class="fa fa-check"></i><b>19.3.4</b> Under the hood</a></li>
<li class="chapter" data-level="19.3.5" data-path="evaluation.html"><a href="evaluation.html#exercises-60"><i class="fa fa-check"></i><b>19.3.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="evaluation.html"><a href="evaluation.html#data-masks"><i class="fa fa-check"></i><b>19.4</b> Data masks</a><ul>
<li class="chapter" data-level="19.4.1" data-path="evaluation.html"><a href="evaluation.html#basics-4"><i class="fa fa-check"></i><b>19.4.1</b> Basics</a></li>
<li class="chapter" data-level="19.4.2" data-path="evaluation.html"><a href="evaluation.html#pronouns"><i class="fa fa-check"></i><b>19.4.2</b> Pronouns</a></li>
<li class="chapter" data-level="19.4.3" data-path="evaluation.html"><a href="evaluation.html#subset"><i class="fa fa-check"></i><b>19.4.3</b> Application: <code>subset()</code></a></li>
<li class="chapter" data-level="19.4.4" data-path="evaluation.html"><a href="evaluation.html#application-transform"><i class="fa fa-check"></i><b>19.4.4</b> Application: transform</a></li>
<li class="chapter" data-level="19.4.5" data-path="evaluation.html"><a href="evaluation.html#application-select"><i class="fa fa-check"></i><b>19.4.5</b> Application: <code>select()</code></a></li>
<li class="chapter" data-level="19.4.6" data-path="evaluation.html"><a href="evaluation.html#exercises-61"><i class="fa fa-check"></i><b>19.4.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="evaluation.html"><a href="evaluation.html#using-tidy-evaluation"><i class="fa fa-check"></i><b>19.5</b> Using tidy evaluation</a><ul>
<li class="chapter" data-level="19.5.1" data-path="evaluation.html"><a href="evaluation.html#quoting-and-unquoting"><i class="fa fa-check"></i><b>19.5.1</b> Quoting and unquoting</a></li>
<li class="chapter" data-level="19.5.2" data-path="evaluation.html"><a href="evaluation.html#pronouns"><i class="fa fa-check"></i><b>19.5.2</b> Handling ambiguity</a></li>
<li class="chapter" data-level="19.5.3" data-path="evaluation.html"><a href="evaluation.html#quoting-and-ambiguity"><i class="fa fa-check"></i><b>19.5.3</b> Quoting and ambiguity</a></li>
<li class="chapter" data-level="19.5.4" data-path="evaluation.html"><a href="evaluation.html#exercises-62"><i class="fa fa-check"></i><b>19.5.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="evaluation.html"><a href="evaluation.html#base-evaluation"><i class="fa fa-check"></i><b>19.6</b> Base evaluation</a><ul>
<li class="chapter" data-level="19.6.1" data-path="evaluation.html"><a href="evaluation.html#substitute"><i class="fa fa-check"></i><b>19.6.1</b> <code>substitute()</code></a></li>
<li class="chapter" data-level="19.6.2" data-path="evaluation.html"><a href="evaluation.html#drawbacks"><i class="fa fa-check"></i><b>19.6.2</b> Drawbacks</a></li>
<li class="chapter" data-level="19.6.3" data-path="evaluation.html"><a href="evaluation.html#base-unquote"><i class="fa fa-check"></i><b>19.6.3</b> Wrapping <code>subset()</code> with tidy eval</a></li>
<li class="chapter" data-level="19.6.4" data-path="evaluation.html"><a href="evaluation.html#match.call"><i class="fa fa-check"></i><b>19.6.4</b> <code>match.call()</code></a></li>
<li class="chapter" data-level="19.6.5" data-path="evaluation.html"><a href="evaluation.html#wrapping-modelling-functions"><i class="fa fa-check"></i><b>19.6.5</b> Wrapping modelling functions</a></li>
<li class="chapter" data-level="19.6.6" data-path="evaluation.html"><a href="evaluation.html#the-evaluation-environment"><i class="fa fa-check"></i><b>19.6.6</b> The evaluation environment</a></li>
<li class="chapter" data-level="19.6.7" data-path="evaluation.html"><a href="evaluation.html#quoted-arguments"><i class="fa fa-check"></i><b>19.6.7</b> Quoted arguments</a></li>
<li class="chapter" data-level="19.6.8" data-path="evaluation.html"><a href="evaluation.html#making-formulas"><i class="fa fa-check"></i><b>19.6.8</b> Making formulas</a></li>
<li class="chapter" data-level="19.6.9" data-path="evaluation.html"><a href="evaluation.html#exercises-63"><i class="fa fa-check"></i><b>19.6.9</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="translation.html"><a href="translation.html"><i class="fa fa-check"></i><b>20</b> Translating R code</a><ul>
<li class="chapter" data-level="20.1" data-path="translation.html"><a href="translation.html#introduction-18"><i class="fa fa-check"></i><b>20.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="translation.html"><a href="translation.html#outline-16"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="translation.html"><a href="translation.html#prequisites"><i class="fa fa-check"></i>Prequisites</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="translation.html"><a href="translation.html#html"><i class="fa fa-check"></i><b>20.2</b> HTML</a><ul>
<li class="chapter" data-level="20.2.1" data-path="translation.html"><a href="translation.html#goal"><i class="fa fa-check"></i><b>20.2.1</b> Goal</a></li>
<li class="chapter" data-level="20.2.2" data-path="translation.html"><a href="translation.html#escaping"><i class="fa fa-check"></i><b>20.2.2</b> Escaping</a></li>
<li class="chapter" data-level="20.2.3" data-path="translation.html"><a href="translation.html#basic-tag-functions"><i class="fa fa-check"></i><b>20.2.3</b> Basic tag functions</a></li>
<li class="chapter" data-level="20.2.4" data-path="translation.html"><a href="translation.html#tag-functions"><i class="fa fa-check"></i><b>20.2.4</b> Tag functions</a></li>
<li class="chapter" data-level="20.2.5" data-path="translation.html"><a href="translation.html#processing-all-tags"><i class="fa fa-check"></i><b>20.2.5</b> Processing all tags</a></li>
<li class="chapter" data-level="20.2.6" data-path="translation.html"><a href="translation.html#exercises-64"><i class="fa fa-check"></i><b>20.2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="translation.html"><a href="translation.html#latex"><i class="fa fa-check"></i><b>20.3</b> LaTeX</a><ul>
<li class="chapter" data-level="20.3.1" data-path="translation.html"><a href="translation.html#latex-mathematics"><i class="fa fa-check"></i><b>20.3.1</b> LaTeX mathematics</a></li>
<li class="chapter" data-level="20.3.2" data-path="translation.html"><a href="translation.html#goal-1"><i class="fa fa-check"></i><b>20.3.2</b> Goal</a></li>
<li class="chapter" data-level="20.3.3" data-path="translation.html"><a href="translation.html#to_math"><i class="fa fa-check"></i><b>20.3.3</b> <code>to_math</code></a></li>
<li class="chapter" data-level="20.3.4" data-path="translation.html"><a href="translation.html#known-symbols"><i class="fa fa-check"></i><b>20.3.4</b> Known symbols</a></li>
<li class="chapter" data-level="20.3.5" data-path="translation.html"><a href="translation.html#unknown-symbols"><i class="fa fa-check"></i><b>20.3.5</b> Unknown symbols</a></li>
<li class="chapter" data-level="20.3.6" data-path="translation.html"><a href="translation.html#known-functions"><i class="fa fa-check"></i><b>20.3.6</b> Known functions</a></li>
<li class="chapter" data-level="20.3.7" data-path="translation.html"><a href="translation.html#unknown-functions"><i class="fa fa-check"></i><b>20.3.7</b> Unknown functions</a></li>
<li class="chapter" data-level="20.3.8" data-path="translation.html"><a href="translation.html#exercises-65"><i class="fa fa-check"></i><b>20.3.8</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>V Techniques</b></span></li>
<li class="chapter" data-level="21" data-path="debugging.html"><a href="debugging.html"><i class="fa fa-check"></i><b>21</b> Debugging</a><ul>
<li class="chapter" data-level="21.1" data-path="debugging.html"><a href="debugging.html#introduction-19"><i class="fa fa-check"></i><b>21.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="debugging.html"><a href="debugging.html#outline-17"><i class="fa fa-check"></i>Outline</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="debugging.html"><a href="debugging.html#debugging-techniques"><i class="fa fa-check"></i><b>21.2</b> Techniques</a></li>
<li class="chapter" data-level="21.3" data-path="debugging.html"><a href="debugging.html#debugging-tools"><i class="fa fa-check"></i><b>21.3</b> Tools</a><ul>
<li class="chapter" data-level="21.3.1" data-path="debugging.html"><a href="debugging.html#determining-the-sequence-of-calls"><i class="fa fa-check"></i><b>21.3.1</b> Determining the sequence of calls</a></li>
<li class="chapter" data-level="21.3.2" data-path="debugging.html"><a href="debugging.html#browsing-on-error"><i class="fa fa-check"></i><b>21.3.2</b> Browsing on error</a></li>
<li class="chapter" data-level="21.3.3" data-path="debugging.html"><a href="debugging.html#browsing-arbitrary-code"><i class="fa fa-check"></i><b>21.3.3</b> Browsing arbitrary code</a></li>
<li class="chapter" data-level="21.3.4" data-path="debugging.html"><a href="debugging.html#the-call-stack-traceback-where-and-recover"><i class="fa fa-check"></i><b>21.3.4</b> The call stack: <code>traceback()</code>, <code>where</code>, and <code>recover()</code></a></li>
<li class="chapter" data-level="21.3.5" data-path="debugging.html"><a href="debugging.html#other-types-of-failure"><i class="fa fa-check"></i><b>21.3.5</b> Other types of failure</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="performance.html"><a href="performance.html"><i class="fa fa-check"></i><b>22</b> Performance</a><ul>
<li class="chapter" data-level="22.1" data-path="performance.html"><a href="performance.html#why-is-r-slow"><i class="fa fa-check"></i><b>22.1</b> Why is R slow?</a></li>
<li class="chapter" data-level="22.2" data-path="performance.html"><a href="performance.html#microbenchmarking"><i class="fa fa-check"></i><b>22.2</b> Microbenchmarking</a><ul>
<li class="chapter" data-level="22.2.1" data-path="performance.html"><a href="performance.html#exercises-66"><i class="fa fa-check"></i><b>22.2.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="22.3" data-path="performance.html"><a href="performance.html#language-performance"><i class="fa fa-check"></i><b>22.3</b> Language performance</a><ul>
<li class="chapter" data-level="22.3.1" data-path="performance.html"><a href="performance.html#extreme-dynamism"><i class="fa fa-check"></i><b>22.3.1</b> Extreme dynamism</a></li>
<li class="chapter" data-level="22.3.2" data-path="performance.html"><a href="performance.html#name-lookup-with-mutable-environments"><i class="fa fa-check"></i><b>22.3.2</b> Name lookup with mutable environments</a></li>
<li class="chapter" data-level="22.3.3" data-path="performance.html"><a href="performance.html#lazy-evaluation-overhead"><i class="fa fa-check"></i><b>22.3.3</b> Lazy evaluation overhead</a></li>
<li class="chapter" data-level="22.3.4" data-path="performance.html"><a href="performance.html#exercises-67"><i class="fa fa-check"></i><b>22.3.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="performance.html"><a href="performance.html#implementation-performance"><i class="fa fa-check"></i><b>22.4</b> Implementation performance</a><ul>
<li class="chapter" data-level="22.4.1" data-path="performance.html"><a href="performance.html#extracting-a-single-value-from-a-data-frame"><i class="fa fa-check"></i><b>22.4.1</b> Extracting a single value from a data frame</a></li>
<li class="chapter" data-level="22.4.2" data-path="performance.html"><a href="performance.html#ifelse-pmin-and-pmax"><i class="fa fa-check"></i><b>22.4.2</b> <code>ifelse()</code>, <code>pmin()</code>, and <code>pmax()</code></a></li>
<li class="chapter" data-level="22.4.3" data-path="performance.html"><a href="performance.html#exercises-68"><i class="fa fa-check"></i><b>22.4.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="performance.html"><a href="performance.html#faster-r"><i class="fa fa-check"></i><b>22.5</b> Alternative R implementations</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="profiling.html"><a href="profiling.html"><i class="fa fa-check"></i><b>23</b> Optimising code</a><ul>
<li class="chapter" data-level="23.1" data-path="profiling.html"><a href="profiling.html#introduction-20"><i class="fa fa-check"></i><b>23.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="profiling.html"><a href="profiling.html#outline-18"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="profiling.html"><a href="profiling.html#prerequisites-12"><i class="fa fa-check"></i>Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="23.2" data-path="profiling.html"><a href="profiling.html#measure-perf"><i class="fa fa-check"></i><b>23.2</b> Measuring performance</a><ul>
<li class="chapter" data-level="23.2.1" data-path="profiling.html"><a href="profiling.html#limitations"><i class="fa fa-check"></i><b>23.2.1</b> Limitations</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="profiling.html"><a href="profiling.html#memory-profiling"><i class="fa fa-check"></i><b>23.3</b> Memory profiling with lineprof</a><ul>
<li class="chapter" data-level="23.3.1" data-path="profiling.html"><a href="profiling.html#exercises-69"><i class="fa fa-check"></i><b>23.3.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="profiling.html"><a href="profiling.html#improve-perf"><i class="fa fa-check"></i><b>23.4</b> Improving performance</a></li>
<li class="chapter" data-level="23.5" data-path="profiling.html"><a href="profiling.html#code-organisation"><i class="fa fa-check"></i><b>23.5</b> Code organisation</a></li>
<li class="chapter" data-level="23.6" data-path="profiling.html"><a href="profiling.html#already-solved"><i class="fa fa-check"></i><b>23.6</b> Has someone already solved the problem?</a><ul>
<li class="chapter" data-level="23.6.1" data-path="profiling.html"><a href="profiling.html#exercises-70"><i class="fa fa-check"></i><b>23.6.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="23.7" data-path="profiling.html"><a href="profiling.html#be-lazy"><i class="fa fa-check"></i><b>23.7</b> Do as little as possible</a><ul>
<li class="chapter" data-level="23.7.1" data-path="profiling.html"><a href="profiling.html#exercises-71"><i class="fa fa-check"></i><b>23.7.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="23.8" data-path="profiling.html"><a href="profiling.html#vectorise"><i class="fa fa-check"></i><b>23.8</b> Vectorise</a><ul>
<li class="chapter" data-level="23.8.1" data-path="profiling.html"><a href="profiling.html#exercises-72"><i class="fa fa-check"></i><b>23.8.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="23.9" data-path="profiling.html"><a href="profiling.html#avoid-copies"><i class="fa fa-check"></i><b>23.9</b> Avoid copies</a></li>
<li class="chapter" data-level="23.10" data-path="profiling.html"><a href="profiling.html#byte-code"><i class="fa fa-check"></i><b>23.10</b> Byte code compilation</a></li>
<li class="chapter" data-level="23.11" data-path="profiling.html"><a href="profiling.html#t-test"><i class="fa fa-check"></i><b>23.11</b> Case study: t-test</a></li>
<li class="chapter" data-level="23.12" data-path="profiling.html"><a href="profiling.html#parallelise"><i class="fa fa-check"></i><b>23.12</b> Parallelise</a></li>
<li class="chapter" data-level="23.13" data-path="profiling.html"><a href="profiling.html#more-techniques"><i class="fa fa-check"></i><b>23.13</b> Other techniques</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="rcpp.html"><a href="rcpp.html"><i class="fa fa-check"></i><b>24</b> Rewriting R code in C++</a><ul>
<li class="chapter" data-level="24.1" data-path="rcpp.html"><a href="rcpp.html#introduction-21"><i class="fa fa-check"></i><b>24.1</b> Introduction</a><ul>
<li class="chapter" data-level="" data-path="rcpp.html"><a href="rcpp.html#outline-19"><i class="fa fa-check"></i>Outline</a></li>
<li class="chapter" data-level="" data-path="rcpp.html"><a href="rcpp.html#prerequistes"><i class="fa fa-check"></i>Prerequistes</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="rcpp.html"><a href="rcpp.html#rcpp-intro"><i class="fa fa-check"></i><b>24.2</b> Getting started with C++</a><ul>
<li class="chapter" data-level="24.2.1" data-path="rcpp.html"><a href="rcpp.html#no-inputs-scalar-output"><i class="fa fa-check"></i><b>24.2.1</b> No inputs, scalar output</a></li>
<li class="chapter" data-level="24.2.2" data-path="rcpp.html"><a href="rcpp.html#scalar-input-scalar-output"><i class="fa fa-check"></i><b>24.2.2</b> Scalar input, scalar output</a></li>
<li class="chapter" data-level="24.2.3" data-path="rcpp.html"><a href="rcpp.html#vector-input-scalar-output"><i class="fa fa-check"></i><b>24.2.3</b> Vector input, scalar output</a></li>
<li class="chapter" data-level="24.2.4" data-path="rcpp.html"><a href="rcpp.html#vector-input-vector-output"><i class="fa fa-check"></i><b>24.2.4</b> Vector input, vector output</a></li>
<li class="chapter" data-level="24.2.5" data-path="rcpp.html"><a href="rcpp.html#matrix-input-vector-output"><i class="fa fa-check"></i><b>24.2.5</b> Matrix input, vector output</a></li>
<li class="chapter" data-level="24.2.6" data-path="rcpp.html"><a href="rcpp.html#sourceCpp"><i class="fa fa-check"></i><b>24.2.6</b> Using sourceCpp</a></li>
<li class="chapter" data-level="24.2.7" data-path="rcpp.html"><a href="rcpp.html#exercises-73"><i class="fa fa-check"></i><b>24.2.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="24.3" data-path="rcpp.html"><a href="rcpp.html#rcpp-classes"><i class="fa fa-check"></i><b>24.3</b> Attributes and other classes</a><ul>
<li class="chapter" data-level="24.3.1" data-path="rcpp.html"><a href="rcpp.html#lists-and-data-frames"><i class="fa fa-check"></i><b>24.3.1</b> Lists and data frames</a></li>
<li class="chapter" data-level="24.3.2" data-path="rcpp.html"><a href="rcpp.html#functions-rcpp"><i class="fa fa-check"></i><b>24.3.2</b> Functions</a></li>
<li class="chapter" data-level="24.3.3" data-path="rcpp.html"><a href="rcpp.html#other-types"><i class="fa fa-check"></i><b>24.3.3</b> Other types</a></li>
</ul></li>
<li class="chapter" data-level="24.4" data-path="rcpp.html"><a href="rcpp.html#rcpp-na"><i class="fa fa-check"></i><b>24.4</b> Missing values</a><ul>
<li class="chapter" data-level="24.4.1" data-path="rcpp.html"><a href="rcpp.html#scalars-1"><i class="fa fa-check"></i><b>24.4.1</b> Scalars</a></li>
<li class="chapter" data-level="24.4.2" data-path="rcpp.html"><a href="rcpp.html#strings"><i class="fa fa-check"></i><b>24.4.2</b> Strings</a></li>
<li class="chapter" data-level="24.4.3" data-path="rcpp.html"><a href="rcpp.html#boolean"><i class="fa fa-check"></i><b>24.4.3</b> Boolean</a></li>
<li class="chapter" data-level="24.4.4" data-path="rcpp.html"><a href="rcpp.html#vectors-rcpp"><i class="fa fa-check"></i><b>24.4.4</b> Vectors</a></li>
<li class="chapter" data-level="24.4.5" data-path="rcpp.html"><a href="rcpp.html#exercises-74"><i class="fa fa-check"></i><b>24.4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="24.5" data-path="rcpp.html"><a href="rcpp.html#rcpp-sugar"><i class="fa fa-check"></i><b>24.5</b> Rcpp sugar</a><ul>
<li class="chapter" data-level="24.5.1" data-path="rcpp.html"><a href="rcpp.html#arithmetic-and-logical-operators"><i class="fa fa-check"></i><b>24.5.1</b> Arithmetic and logical operators</a></li>
<li class="chapter" data-level="24.5.2" data-path="rcpp.html"><a href="rcpp.html#logical-summary-functions"><i class="fa fa-check"></i><b>24.5.2</b> Logical summary functions</a></li>
<li class="chapter" data-level="24.5.3" data-path="rcpp.html"><a href="rcpp.html#vector-views"><i class="fa fa-check"></i><b>24.5.3</b> Vector views</a></li>
<li class="chapter" data-level="24.5.4" data-path="rcpp.html"><a href="rcpp.html#other-useful-functions"><i class="fa fa-check"></i><b>24.5.4</b> Other useful functions</a></li>
</ul></li>
<li class="chapter" data-level="24.6" data-path="rcpp.html"><a href="rcpp.html#stl"><i class="fa fa-check"></i><b>24.6</b> The STL</a><ul>
<li class="chapter" data-level="24.6.1" data-path="rcpp.html"><a href="rcpp.html#using-iterators"><i class="fa fa-check"></i><b>24.6.1</b> Using iterators</a></li>
<li class="chapter" data-level="24.6.2" data-path="rcpp.html"><a href="rcpp.html#algorithms"><i class="fa fa-check"></i><b>24.6.2</b> Algorithms</a></li>
<li class="chapter" data-level="24.6.3" data-path="rcpp.html"><a href="rcpp.html#data-structures-rcpp"><i class="fa fa-check"></i><b>24.6.3</b> Data structures</a></li>
<li class="chapter" data-level="24.6.4" data-path="rcpp.html"><a href="rcpp.html#vectors-stl"><i class="fa fa-check"></i><b>24.6.4</b> Vectors</a></li>
<li class="chapter" data-level="24.6.5" data-path="rcpp.html"><a href="rcpp.html#sets"><i class="fa fa-check"></i><b>24.6.5</b> Sets</a></li>
<li class="chapter" data-level="24.6.6" data-path="rcpp.html"><a href="rcpp.html#map-1"><i class="fa fa-check"></i><b>24.6.6</b> Map</a></li>
<li class="chapter" data-level="24.6.7" data-path="rcpp.html"><a href="rcpp.html#exercises-75"><i class="fa fa-check"></i><b>24.6.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="24.7" data-path="rcpp.html"><a href="rcpp.html#rcpp-case-studies"><i class="fa fa-check"></i><b>24.7</b> Case studies</a><ul>
<li class="chapter" data-level="24.7.1" data-path="rcpp.html"><a href="rcpp.html#gibbs-sampler"><i class="fa fa-check"></i><b>24.7.1</b> Gibbs sampler</a></li>
<li class="chapter" data-level="24.7.2" data-path="rcpp.html"><a href="rcpp.html#r-vectorisation-vs.c-vectorisation"><i class="fa fa-check"></i><b>24.7.2</b> R vectorisation vs. C++ vectorisation</a></li>
</ul></li>
<li class="chapter" data-level="24.8" data-path="rcpp.html"><a href="rcpp.html#rcpp-package"><i class="fa fa-check"></i><b>24.8</b> Using Rcpp in a package</a></li>
<li class="chapter" data-level="24.9" data-path="rcpp.html"><a href="rcpp.html#rcpp-more"><i class="fa fa-check"></i><b>24.9</b> Learning more</a></li>
<li class="chapter" data-level="24.10" data-path="rcpp.html"><a href="rcpp.html#acknowledgments"><i class="fa fa-check"></i><b>24.10</b> Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown">
Proudly published with bookdown</a></li>
<li><a href="https://github.com/hadley/adv-r">Forked from Hadley</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Advanced R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="performance" class="section level1">
<h1><span class="header-section-number">22</span> Performance</h1>
<p>R is not a fast language. This is not an accident. R was purposely designed to make data analysis and statistics easier for you to do. It was not designed to make life easier for your computer. While R is slow compared to other programming languages, for most purposes, it’s fast enough. </p>
<p>The goal of this part of the book is to give you a deeper understanding of R’s performance characteristics. In this chapter, you’ll learn about some of the trade-offs that R has made, valuing flexibility over performance. The following four chapters will give you the skills to improve the speed of your code when you need to:</p>
<ul>
<li><p>In <a href="profiling.html#profiling">Profiling</a>, you’ll learn how to systematically make your
code faster. First you figure what’s slow, and then you apply some general
techniques to make the slow parts faster.</p></li>
<li><p>For really high-performance code, you can move outside of R and use
another programming language. <a href="rcpp.html#rcpp">Rcpp</a> will teach you the absolute
minimum you need to know about C++ so you can write fast code using the
Rcpp package.</p></li>
<li><p>To really understand the performance of built-in base functions,
you’ll need to learn a little bit about R’s C API. In <a href="#c-api">R’s C
interface</a>, you’ll learn a little about R’s C internals.</p></li>
</ul>
<p>Let’s get started by learning more about why R is slow.</p>
<div id="why-is-r-slow" class="section level2">
<h2><span class="header-section-number">22.1</span> Why is R slow?</h2>
<p>To understand R’s performance, it helps to think about R as both a language and as an implementation of that language. The R-language is abstract: it defines what R code means and how it should work. The implementation is concrete: it reads R code and computes a result. The most popular implementation is the one from <a href="http://r-project.org">r-project.org</a>. I’ll call that implementation GNU-R to distinguish it from R-language, and from the other implementations I’ll discuss later in the chapter. </p>
<p>The distinction between R-language and GNU-R is a bit murky because the R-language is not formally defined. While there is the <a href="http://cran.r-project.org/doc/manuals/R-lang.html">R language definition</a>, it is informal and incomplete. The R-language is mostly defined in terms of how GNU-R works. This is in contrast to other languages, like <a href="http://isocpp.org/std/the-standard">C++</a> and <a href="http://www.ecma-international.org/publications/standards/Ecma-262.htm">JavaScript</a>, that make a clear distinction between language and implementation by laying out formal specifications that describe in minute detail how every aspect of the language should work. Nevertheless, the distinction between R-language and GNU-R is still useful: poor performance due to the language is hard to fix without breaking existing code; fixing poor performance due to the implementation is easier.</p>
<p>In <a href="performance.html#language-performance">Language performance</a>, I discuss some of the ways in which the design of the R-language imposes fundamental constraints on R’s speed. In <a href="performance.html#implementation-performance">Implementation performance</a>, I discuss why GNU-R is currently far from the theoretical maximum, and why improvements in performance happen so slowly. While it’s hard to know exactly how much faster a better implementation could be, a &gt;10x improvement in speed seems achievable. In <a href="performance.html#faster-r">alternative implementations</a>, I discuss some of the promising new implementations of R, and describe one important technique they use to make R code run faster.</p>
<p>Beyond performance limitations due to design and implementation, it has to be said that a lot of R code is slow simply because it’s poorly written. Few R users have any formal training in programming or software development. Fewer still write R code for a living. Most people use R to understand data: it’s more important to get an answer quickly than to develop a system that will work in a wide variety of situations. This means that it’s relatively easy to make most R code much faster, as we’ll see in the following chapters.</p>
<p>Before we examine some of the slower parts of the R-language and GNU-R, we need to learn a little about benchmarking so that we can give our intuitions about performance a concrete foundation.</p>
</div>
<div id="microbenchmarking" class="section level2">
<h2><span class="header-section-number">22.2</span> Microbenchmarking</h2>
<p>A microbenchmark is a measurement of the performance of a very small piece of code, something that might take microseconds (µs) or nanoseconds (ns) to run. I’m going to use microbenchmarks to demonstrate the performance of very low-level pieces of R code, which help develop your intuition for how R works. This intuition, by-and-large, is not useful for increasing the speed of real code. The observed differences in microbenchmarks will typically be dominated by higher-order effects in real code; a deep understanding of subatomic physics is not very helpful when baking. Don’t change the way you code because of these microbenchmarks. Instead wait until you’ve read the practical advice in the following chapters. </p>
<p>The best tool for microbenchmarking in R is the <a href="http://cran.r-project.org/web/packages/microbenchmark/">microbenchmark</a> package. It provides very precise timings, making it possible to compare operations that only take a tiny amount of time. For example, the following code compares the speed of two ways of computing a square root.</p>
<div class="sourceCode" id="cb938"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb938-1" data-line-number="1"><span class="kw">library</span>(microbenchmark)</a>
<a class="sourceLine" id="cb938-2" data-line-number="2"></a>
<a class="sourceLine" id="cb938-3" data-line-number="3">x &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb938-4" data-line-number="4"><span class="kw">microbenchmark</span>(</a>
<a class="sourceLine" id="cb938-5" data-line-number="5">  <span class="kw">sqrt</span>(x),</a>
<a class="sourceLine" id="cb938-6" data-line-number="6">  x <span class="op">^</span><span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb938-7" data-line-number="7">)</a>
<a class="sourceLine" id="cb938-8" data-line-number="8"><span class="co">#&gt; Unit: nanoseconds</span></a>
<a class="sourceLine" id="cb938-9" data-line-number="9"><span class="co">#&gt;     expr    min     lq  mean median     uq    max neval</span></a>
<a class="sourceLine" id="cb938-10" data-line-number="10"><span class="co">#&gt;  sqrt(x)  1,950  2,580  2764  2,730  2,940  6,260   100</span></a>
<a class="sourceLine" id="cb938-11" data-line-number="11"><span class="co">#&gt;    x^0.5 13,600 14,300 14885 14,600 14,800 48,700   100</span></a></code></pre></div>
<p>By default, <code>microbenchmark()</code> runs each expression 100 times (controlled by the <code>times</code> parameter). In the process, it also randomises the order of the expressions. It summarises the results with a minimum (<code>min</code>), lower quartile (<code>lq</code>), median, upper quartile (<code>uq</code>), and maximum (<code>max</code>). Focus on the median, and use the upper and lower quartiles (<code>lq</code> and <code>uq</code>) to get a feel for the variability. In this example, you can see that using the special purpose <code>sqrt()</code> function is faster than the general exponentiation operator.</p>
<p>As with all microbenchmarks, pay careful attention to the units: here, each computation takes about 1,000 ns, 1,000 billionths of a second. To help calibrate the impact of a microbenchmark on run time, it’s useful to think about how many times a function needs to run before it takes a second. If a microbenchmark takes:</p>
<ul>
<li>1 ms, then one thousand calls takes a second</li>
<li>1 µs, then one million calls takes a second</li>
<li>1 ns, then one billion calls takes a second</li>
</ul>
<p>The <code>sqrt()</code> function takes about 1,000 ns, or 1 µs, to compute the square root of 100 numbers. That means if you repeated the operation a million times, it would take 1 s. So changing the way you compute the square root is unlikely to significantly affect real code.</p>
<div id="exercises-66" class="section level3">
<h3><span class="header-section-number">22.2.1</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li><p>Instead of using <code>microbenchmark()</code>, you could use the built-in function
<code>system.time()</code>. But <code>system.time()</code> is much less precise, so you’ll
need to repeat each operation many times with a loop, and then divide
to find the average time of each operation, as in the code below.</p>
<div class="sourceCode" id="cb939"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb939-1" data-line-number="1">n &lt;-<span class="st"> </span><span class="fl">1e6</span></a>
<a class="sourceLine" id="cb939-2" data-line-number="2"><span class="kw">system.time</span>(<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) <span class="kw">sqrt</span>(x)) <span class="op">/</span><span class="st"> </span>n</a>
<a class="sourceLine" id="cb939-3" data-line-number="3"><span class="kw">system.time</span>(<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) x <span class="op">^</span><span class="st"> </span><span class="fl">0.5</span>) <span class="op">/</span><span class="st"> </span>n</a></code></pre></div>
<p>How do the estimates from <code>system.time()</code> compare to those from
<code>microbenchmark()</code>? Why are they different?</p></li>
<li><p>Here are two other ways to compute the square root of a vector. Which
do you think will be fastest? Which will be slowest? Use microbenchmarking
to test your answers.</p>
<div class="sourceCode" id="cb940"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb940-1" data-line-number="1">x <span class="op">^</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb940-2" data-line-number="2"><span class="kw">exp</span>(<span class="kw">log</span>(x) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>)</a></code></pre></div></li>
<li><p>Use microbenchmarking to rank the basic arithmetic operators (<code>+</code>, <code>-</code>,
<code>*</code>, <code>/</code>, and <code>^</code>) in terms of their speed. Visualise the results. Compare
the speed of arithmetic on integers vs. doubles.</p></li>
<li><p>You can change the units in which the microbenchmark results are
expressed with the <code>unit</code> parameter. Use <code>unit = &quot;eps&quot;</code> to show
the number of evaluations needed to take 1 second. Repeat the benchmarks
above with the eps unit. How does this change your intuition for performance?</p></li>
</ol>
</div>
</div>
<div id="language-performance" class="section level2">
<h2><span class="header-section-number">22.3</span> Language performance</h2>
<p>In this section, I’ll explore three trade-offs that limit the performance of the R-language: extreme dynamism, name lookup with mutable environments, and lazy evaluation of function arguments. I’ll illustrate each trade-off with a microbenchmark, showing how it slows GNU-R down. I benchmark GNU-R because you can’t benchmark the R-language (it can’t run code). This means that the results are only suggestive of the cost of these design decisions, but are nevertheless useful. I’ve picked these three examples to illustrate some of the trade-offs that are key to language design: the designer must balance speed, flexibility, and ease of implementation.</p>
<p>If you’d like to learn more about the performance characteristics of the R-language and how they affect real code, I highly recommend <a href="http://r.cs.purdue.edu/pub/ecoop12.pdf">“Evaluating the Design of the R Language”</a> by Floreal Morandat, Brandon Hill, Leo Osvald, and Jan Vitek. It uses a powerful methodology that combines a modified R interpreter and a wide set of code found in the wild.</p>
<div id="extreme-dynamism" class="section level3">
<h3><span class="header-section-number">22.3.1</span> Extreme dynamism</h3>
<p>R is an extremely dynamic programming language. Almost anything can be modified after it is created. To give just a few examples, you can:</p>
<ul>
<li>Change the body, arguments, and environment of functions.</li>
<li>Change the S4 methods for a generic.</li>
<li>Add new fields to an S3 object, or even change its class.</li>
<li>Modify objects outside of the local environment with <code>&lt;&lt;-</code>.</li>
</ul>
<p>Pretty much the only things you can’t change are objects in sealed namespaces, which are created when you load a package.</p>
<p>The advantage of dynamism is that you need minimal upfront planning. You can change your mind at any time, iterating your way to a solution without having to start afresh. The disadvantage of dynamism is that it’s difficult to predict exactly what will happen with a given function call. This is a problem because the easier it is to predict what’s going to happen, the easier it is for an interpreter or compiler to make an optimisation. (If you’d like more details, Charles Nutter expands on this idea at <a href="http://blog.headius.com/2013/05/on-languages-vms-optimization-and-way.html">On Languages, VMs, Optimization, and the Way of the World</a>.) If an interpreter can’t predict what’s going to happen, it has to consider many options before it finds the right one. For example, the following loop is slow in R, because R doesn’t know that <code>x</code> is always an integer. That means R has to look for the right <code>+</code> method (i.e., is it adding doubles, or integers?) in every iteration of the loop.</p>
<div class="sourceCode" id="cb941"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb941-1" data-line-number="1">x &lt;-<span class="st"> </span>0L</a>
<a class="sourceLine" id="cb941-2" data-line-number="2"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="fl">1e6</span>) {</a>
<a class="sourceLine" id="cb941-3" data-line-number="3">  x &lt;-<span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb941-4" data-line-number="4">}</a></code></pre></div>
<p>The cost of finding the right method is higher for non-primitive functions. The following microbenchmark illustrates the cost of method dispatch for S3, S4, and RC. I create a generic and a method for each OO system, then call the generic and see how long it takes to find and call the method. I also time how long it takes to call the bare function for comparison. </p>
<div class="sourceCode" id="cb942"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb942-1" data-line-number="1">f &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="ot">NULL</span></a>
<a class="sourceLine" id="cb942-2" data-line-number="2"></a>
<a class="sourceLine" id="cb942-3" data-line-number="3">s3 &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">UseMethod</span>(<span class="st">&quot;s3&quot;</span>)</a>
<a class="sourceLine" id="cb942-4" data-line-number="4">s3.integer &lt;-<span class="st"> </span>f</a>
<a class="sourceLine" id="cb942-5" data-line-number="5"></a>
<a class="sourceLine" id="cb942-6" data-line-number="6">A &lt;-<span class="st"> </span><span class="kw">setClass</span>(<span class="st">&quot;A&quot;</span>, <span class="kw">representation</span>(<span class="dt">a =</span> <span class="st">&quot;list&quot;</span>))</a>
<a class="sourceLine" id="cb942-7" data-line-number="7"><span class="kw">setGeneric</span>(<span class="st">&quot;s4&quot;</span>, <span class="cf">function</span>(x) <span class="kw">standardGeneric</span>(<span class="st">&quot;s4&quot;</span>))</a>
<a class="sourceLine" id="cb942-8" data-line-number="8"><span class="kw">setMethod</span>(s4, <span class="st">&quot;A&quot;</span>, f)</a>
<a class="sourceLine" id="cb942-9" data-line-number="9"></a>
<a class="sourceLine" id="cb942-10" data-line-number="10">B &lt;-<span class="st"> </span><span class="kw">setRefClass</span>(<span class="st">&quot;B&quot;</span>, <span class="dt">methods =</span> <span class="kw">list</span>(<span class="dt">rc =</span> f))</a>
<a class="sourceLine" id="cb942-11" data-line-number="11"></a>
<a class="sourceLine" id="cb942-12" data-line-number="12">a &lt;-<span class="st"> </span><span class="kw">A</span>()</a>
<a class="sourceLine" id="cb942-13" data-line-number="13">b &lt;-<span class="st"> </span>B<span class="op">$</span><span class="kw">new</span>()</a></code></pre></div>
<div class="sourceCode" id="cb943"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb943-1" data-line-number="1"><span class="kw">microbenchmark</span>(</a>
<a class="sourceLine" id="cb943-2" data-line-number="2">  <span class="dt">fun =</span> <span class="kw">f</span>(),</a>
<a class="sourceLine" id="cb943-3" data-line-number="3">  <span class="dt">S3 =</span> <span class="kw">s3</span>(1L),</a>
<a class="sourceLine" id="cb943-4" data-line-number="4">  <span class="dt">S4 =</span> <span class="kw">s4</span>(a),</a>
<a class="sourceLine" id="cb943-5" data-line-number="5">  <span class="dt">RC =</span> b<span class="op">$</span><span class="kw">rc</span>()</a>
<a class="sourceLine" id="cb943-6" data-line-number="6">)</a>
<a class="sourceLine" id="cb943-7" data-line-number="7"><span class="co">#&gt; Unit: nanoseconds</span></a>
<a class="sourceLine" id="cb943-8" data-line-number="8"><span class="co">#&gt;  expr    min     lq  mean median     uq       max neval</span></a>
<a class="sourceLine" id="cb943-9" data-line-number="9"><span class="co">#&gt;   fun    415    752  1396  1,200  1,420    25,800   100</span></a>
<a class="sourceLine" id="cb943-10" data-line-number="10"><span class="co">#&gt;    S3  1,840  2,690 18097  3,660  5,020 1,390,000   100</span></a>
<a class="sourceLine" id="cb943-11" data-line-number="11"><span class="co">#&gt;    S4 18,400 21,500 51225 34,200 40,900 1,410,000   100</span></a>
<a class="sourceLine" id="cb943-12" data-line-number="12"><span class="co">#&gt;    RC 11,000 13,900 60115 19,300 24,300 4,090,000   100</span></a></code></pre></div>
<p>The bare function takes about 1,000 ns. S3 method dispatch takes an additional 3,000 ns; S4 dispatch, 30,000 ns; and RC dispatch, 20,000 ns. S3 and S4 method dispatch are expensive because R must search for the right method every time the generic is called; it might have changed between this call and the last. R could do better by caching methods between calls, but caching is hard to do correctly and a notorious source of bugs.</p>
</div>
<div id="name-lookup-with-mutable-environments" class="section level3">
<h3><span class="header-section-number">22.3.2</span> Name lookup with mutable environments</h3>
<p>It’s surprisingly difficult to find the value associated with a name in the R-language. This is due to combination of lexical scoping and extreme dynamism. Take the following example. Each time we print <code>a</code> it comes from a different environment: </p>
<div class="sourceCode" id="cb944"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb944-1" data-line-number="1">a &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb944-2" data-line-number="2">f &lt;-<span class="st"> </span><span class="cf">function</span>() {</a>
<a class="sourceLine" id="cb944-3" data-line-number="3">  g &lt;-<span class="st"> </span><span class="cf">function</span>() {</a>
<a class="sourceLine" id="cb944-4" data-line-number="4">    <span class="kw">print</span>(a)</a>
<a class="sourceLine" id="cb944-5" data-line-number="5">    <span class="kw">assign</span>(<span class="st">&quot;a&quot;</span>, <span class="dv">2</span>, <span class="dt">envir =</span> <span class="kw">parent.frame</span>())</a>
<a class="sourceLine" id="cb944-6" data-line-number="6">    <span class="kw">print</span>(a)</a>
<a class="sourceLine" id="cb944-7" data-line-number="7">    a &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb944-8" data-line-number="8">    <span class="kw">print</span>(a)</a>
<a class="sourceLine" id="cb944-9" data-line-number="9">  }</a>
<a class="sourceLine" id="cb944-10" data-line-number="10">  <span class="kw">g</span>()</a>
<a class="sourceLine" id="cb944-11" data-line-number="11">}</a>
<a class="sourceLine" id="cb944-12" data-line-number="12"><span class="kw">f</span>()</a>
<a class="sourceLine" id="cb944-13" data-line-number="13"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb944-14" data-line-number="14"><span class="co">#&gt; [1] 2</span></a>
<a class="sourceLine" id="cb944-15" data-line-number="15"><span class="co">#&gt; [1] 3</span></a></code></pre></div>
<p>This means that you can’t do name lookup just once: you have to start from scratch each time. This problem is exacerbated by the fact that almost every operation is a lexically scoped function call. You might think the following simple function calls two functions: <code>+</code> and <code>^</code>. In fact, it calls four because <code>{</code> and <code>(</code> are regular functions in R.</p>
<div class="sourceCode" id="cb945"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb945-1" data-line-number="1">f &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb945-2" data-line-number="2">  (x <span class="op">+</span><span class="st"> </span>y) <span class="op">^</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb945-3" data-line-number="3">}</a></code></pre></div>
<p>Since these functions are in the global environment, R has to look through every environment in the search path, which could easily be 10 or 20 environments. The following microbenchmark hints at the performance costs. We create four versions of <code>f()</code>, each with one more environment (containing 26 bindings) between the environment of <code>f()</code> and the base environment where <code>+</code>, <code>^</code>, <code>(</code>, and <code>{</code> are defined.</p>
<div class="sourceCode" id="cb946"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb946-1" data-line-number="1">random_env &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">parent =</span> <span class="kw">globalenv</span>()) {</a>
<a class="sourceLine" id="cb946-2" data-line-number="2">  letter_list &lt;-<span class="st"> </span><span class="kw">setNames</span>(<span class="kw">as.list</span>(<span class="kw">runif</span>(<span class="dv">26</span>)), LETTERS)</a>
<a class="sourceLine" id="cb946-3" data-line-number="3">  <span class="kw">list2env</span>(letter_list, <span class="dt">envir =</span> <span class="kw">new.env</span>(<span class="dt">parent =</span> parent))</a>
<a class="sourceLine" id="cb946-4" data-line-number="4">}</a>
<a class="sourceLine" id="cb946-5" data-line-number="5">set_env &lt;-<span class="st"> </span><span class="cf">function</span>(f, e) {</a>
<a class="sourceLine" id="cb946-6" data-line-number="6">  <span class="kw">environment</span>(f) &lt;-<span class="st"> </span>e</a>
<a class="sourceLine" id="cb946-7" data-line-number="7">  f</a>
<a class="sourceLine" id="cb946-8" data-line-number="8">}</a>
<a class="sourceLine" id="cb946-9" data-line-number="9">f2 &lt;-<span class="st"> </span><span class="kw">set_env</span>(f, <span class="kw">random_env</span>())</a>
<a class="sourceLine" id="cb946-10" data-line-number="10">f3 &lt;-<span class="st"> </span><span class="kw">set_env</span>(f, <span class="kw">random_env</span>(<span class="kw">environment</span>(f2)))</a>
<a class="sourceLine" id="cb946-11" data-line-number="11">f4 &lt;-<span class="st"> </span><span class="kw">set_env</span>(f, <span class="kw">random_env</span>(<span class="kw">environment</span>(f3)))</a>
<a class="sourceLine" id="cb946-12" data-line-number="12"></a>
<a class="sourceLine" id="cb946-13" data-line-number="13"><span class="kw">microbenchmark</span>(</a>
<a class="sourceLine" id="cb946-14" data-line-number="14">  <span class="kw">f</span>(<span class="dv">1</span>, <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb946-15" data-line-number="15">  <span class="kw">f2</span>(<span class="dv">1</span>, <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb946-16" data-line-number="16">  <span class="kw">f3</span>(<span class="dv">1</span>, <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb946-17" data-line-number="17">  <span class="kw">f4</span>(<span class="dv">1</span>, <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb946-18" data-line-number="18">  <span class="dt">times =</span> <span class="dv">10000</span></a>
<a class="sourceLine" id="cb946-19" data-line-number="19">)</a>
<a class="sourceLine" id="cb946-20" data-line-number="20"><span class="co">#&gt; Unit: nanoseconds</span></a>
<a class="sourceLine" id="cb946-21" data-line-number="21"><span class="co">#&gt;      expr min    lq mean median    uq       max neval</span></a>
<a class="sourceLine" id="cb946-22" data-line-number="22"><span class="co">#&gt;   f(1, 2) 522   592  999    622   693 2,700,000 10000</span></a>
<a class="sourceLine" id="cb946-23" data-line-number="23"><span class="co">#&gt;  f2(1, 2) 912   983 1469  1,010 1,120 2,970,000 10000</span></a>
<a class="sourceLine" id="cb946-24" data-line-number="24"><span class="co">#&gt;  f3(1, 2) 933 1,010 1202  1,040 1,150    11,700 10000</span></a>
<a class="sourceLine" id="cb946-25" data-line-number="25"><span class="co">#&gt;  f4(1, 2) 982 1,050 1257  1,080 1,190   131,000 10000</span></a></code></pre></div>
<p>Each additional environment between <code>f()</code> and the base environment makes the function slower by about 30 ns.</p>
<p>It might be possible to implement a caching system so that R only needs to look up the value of each name once. This is hard because there are so many ways to change the value associated with a name: <code>&lt;&lt;-</code>, <code>assign()</code>, <code>eval()</code>, and so on. Any caching system would have to know about these functions to make sure the cache was correctly invalidated and you didn’t get an out-of-date value. </p>
<p>Another simple fix would be to add more built-in constants that you can’t override. This, for example, would mean that R always knew exactly what <code>+</code>, <code>-</code>, <code>{</code>, and <code>(</code> meant, and you wouldn’t have to repeatedly look up their definitions. That would make the interpreter more complicated (because there are more special cases) and hence harder to maintain, and the language less flexible. This would change the R-language, but it would be unlikely to affect much existing code because it’s such a bad idea to override functions like <code>{</code> and <code>(</code>.</p>
</div>
<div id="lazy-evaluation-overhead" class="section level3">
<h3><span class="header-section-number">22.3.3</span> Lazy evaluation overhead</h3>
<p>In R, function arguments are evaluated lazily (as discussed in <a href="functions.html#lazy-evaluation">lazy evaluation</a> and <a href="quasiquotation.html#capturing-expressions">capturing expressions</a>). To implement lazy evaluation, R uses a promise object that contains the expression needed to compute the result and the environment in which to perform the computation. Creating these objects has some overhead, so each additional argument to a function decreases its speed a little. </p>
<p>The following microbenchmark compares the runtime of a very simple function. Each version of the function has one additional argument. This suggests that adding an additional argument slows the function down by ~20 ns.</p>
<div class="sourceCode" id="cb947"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb947-1" data-line-number="1">f0 &lt;-<span class="st"> </span><span class="cf">function</span>() <span class="ot">NULL</span></a>
<a class="sourceLine" id="cb947-2" data-line-number="2">f1 &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">a =</span> <span class="dv">1</span>) <span class="ot">NULL</span></a>
<a class="sourceLine" id="cb947-3" data-line-number="3">f2 &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">a =</span> <span class="dv">1</span>, <span class="dt">b =</span> <span class="dv">1</span>) <span class="ot">NULL</span></a>
<a class="sourceLine" id="cb947-4" data-line-number="4">f3 &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">a =</span> <span class="dv">1</span>, <span class="dt">b =</span> <span class="dv">2</span>, <span class="dt">c =</span> <span class="dv">3</span>) <span class="ot">NULL</span></a>
<a class="sourceLine" id="cb947-5" data-line-number="5">f4 &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">a =</span> <span class="dv">1</span>, <span class="dt">b =</span> <span class="dv">2</span>, <span class="dt">c =</span> <span class="dv">4</span>, <span class="dt">d =</span> <span class="dv">4</span>) <span class="ot">NULL</span></a>
<a class="sourceLine" id="cb947-6" data-line-number="6">f5 &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">a =</span> <span class="dv">1</span>, <span class="dt">b =</span> <span class="dv">2</span>, <span class="dt">c =</span> <span class="dv">4</span>, <span class="dt">d =</span> <span class="dv">4</span>, <span class="dt">e =</span> <span class="dv">5</span>) <span class="ot">NULL</span></a>
<a class="sourceLine" id="cb947-7" data-line-number="7"><span class="kw">microbenchmark</span>(<span class="kw">f0</span>(), <span class="kw">f1</span>(), <span class="kw">f2</span>(), <span class="kw">f3</span>(), <span class="kw">f4</span>(), <span class="kw">f5</span>(), <span class="dt">times =</span> <span class="dv">10000</span>)</a>
<a class="sourceLine" id="cb947-8" data-line-number="8"><span class="co">#&gt; Unit: nanoseconds</span></a>
<a class="sourceLine" id="cb947-9" data-line-number="9"><span class="co">#&gt;  expr min  lq mean median  uq       max neval</span></a>
<a class="sourceLine" id="cb947-10" data-line-number="10"><span class="co">#&gt;  f0() 201 241  337    242 252   567,000 10000</span></a>
<a class="sourceLine" id="cb947-11" data-line-number="11"><span class="co">#&gt;  f1() 241 271  411    281 291   609,000 10000</span></a>
<a class="sourceLine" id="cb947-12" data-line-number="12"><span class="co">#&gt;  f2() 271 301  479    311 322   741,000 10000</span></a>
<a class="sourceLine" id="cb947-13" data-line-number="13"><span class="co">#&gt;  f3() 291 341  595    351 372 1,180,000 10000</span></a>
<a class="sourceLine" id="cb947-14" data-line-number="14"><span class="co">#&gt;  f4() 311 351  605    362 402   701,000 10000</span></a>
<a class="sourceLine" id="cb947-15" data-line-number="15"><span class="co">#&gt;  f5() 351 391  650    402 471   694,000 10000</span></a></code></pre></div>
<p>In most other programming languages there is little overhead for adding extra arguments. Many compiled languages will even warn you if arguments are never used (like in the above example), and automatically remove them from the function.</p>
</div>
<div id="exercises-67" class="section level3">
<h3><span class="header-section-number">22.3.4</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li><p><code>scan()</code> has the most arguments (21) of any base function. About how
much time does it take to make 21 promises each time scan is called?
Given a simple input (e.g., <code>scan(text = &quot;1 2 3&quot;, quiet = TRUE)</code>) what
proportion of the total run time is due to creating those promises?</p></li>
<li><p>Read <a href="http://r.cs.purdue.edu/pub/ecoop12.pdf">“Evaluating the Design of the R Language”</a>. What other aspects of the R-language slow it
down? Construct microbenchmarks to illustrate.</p></li>
<li><p>How does the performance of S3 method dispatch change with the length
of the class vector? How does performance of S4 method dispatch change
with number of superclasses? How about RC?</p></li>
<li><p>What is the cost of multiple inheritance and multiple dispatch on
S4 method dispatch?</p></li>
<li><p>Why is the cost of name lookup less for functions in the base package?</p></li>
</ol>
</div>
</div>
<div id="implementation-performance" class="section level2">
<h2><span class="header-section-number">22.4</span> Implementation performance</h2>
<p>The design of the R language limits its maximum theoretical performance, but GNU-R is currently nowhere near that maximum. There are many things that can (and will) be done to improve performance. This section discusses some aspects of GNU-R that are slow not because of their definition, but because of their implementation.</p>
<p>R is over 20 years old. It contains nearly 800,000 lines of code (about 45% C, 19% R, and 17% Fortran). Changes to base R can only be made by members of the R Core Team (or R-core for short). Currently R-core has <a href="http://www.r-project.org/contributors.html">twenty members</a>, but only six are active in day-to-day development. No one on R-core works full time on R. Most are statistics professors who can only spend a relatively small amount of their time on R. Because of the care that must be taken to avoid breaking existing code, R-core tends to be very conservative about accepting new code. It can be frustrating to see R-core reject proposals that would improve performance. However, the overriding concern for R-core is not to make R fast, but to build a stable platform for data analysis and statistics. </p>
<p>Below, I’ll show two small, but illustrative, examples of parts of R that are currently slow but could, with some effort, be made faster. They are not critical parts of base R, but they have been sources of frustration for me in the past. As with all microbenchmarks, these won’t affect the performance of most code, but can be important for special cases.</p>
<div id="extracting-a-single-value-from-a-data-frame" class="section level3">
<h3><span class="header-section-number">22.4.1</span> Extracting a single value from a data frame</h3>
<p>The following microbenchmark shows five ways to access a single value (the number in the bottom-right corner) from the built-in <code>mtcars</code> dataset. The variation in performance is startling: the slowest method takes 30x longer than the fastest. There’s no reason that there has to be such a huge difference in performance. It’s simply that no one has had the time to fix it.  </p>
<div class="sourceCode" id="cb948"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb948-1" data-line-number="1"><span class="kw">microbenchmark</span>(</a>
<a class="sourceLine" id="cb948-2" data-line-number="2">  <span class="st">&quot;[32, 11]&quot;</span>      =<span class="st"> </span>mtcars[<span class="dv">32</span>, <span class="dv">11</span>],</a>
<a class="sourceLine" id="cb948-3" data-line-number="3">  <span class="st">&quot;$carb[32]&quot;</span>     =<span class="st"> </span>mtcars<span class="op">$</span>carb[<span class="dv">32</span>],</a>
<a class="sourceLine" id="cb948-4" data-line-number="4">  <span class="st">&quot;[[c(11, 32)]]&quot;</span> =<span class="st"> </span>mtcars[[<span class="kw">c</span>(<span class="dv">11</span>, <span class="dv">32</span>)]],</a>
<a class="sourceLine" id="cb948-5" data-line-number="5">  <span class="st">&quot;[[11]][32]&quot;</span>    =<span class="st"> </span>mtcars[[<span class="dv">11</span>]][<span class="dv">32</span>],</a>
<a class="sourceLine" id="cb948-6" data-line-number="6">  <span class="st">&quot;.subset2&quot;</span>      =<span class="st"> </span><span class="kw">.subset2</span>(mtcars, <span class="dv">11</span>)[<span class="dv">32</span>]</a>
<a class="sourceLine" id="cb948-7" data-line-number="7">)</a>
<a class="sourceLine" id="cb948-8" data-line-number="8"><span class="co">#&gt; Unit: nanoseconds</span></a>
<a class="sourceLine" id="cb948-9" data-line-number="9"><span class="co">#&gt;           expr    min     lq  mean median     uq     max neval</span></a>
<a class="sourceLine" id="cb948-10" data-line-number="10"><span class="co">#&gt;       [32, 11] 12,800 15,300 16804 16,100 17,100  71,000   100</span></a>
<a class="sourceLine" id="cb948-11" data-line-number="11"><span class="co">#&gt;      $carb[32]  7,100  8,400  9165  8,900  9,350  21,600   100</span></a>
<a class="sourceLine" id="cb948-12" data-line-number="12"><span class="co">#&gt;  [[c(11, 32)]]  6,250  7,150 14084  7,660  8,180 648,000   100</span></a>
<a class="sourceLine" id="cb948-13" data-line-number="13"><span class="co">#&gt;     [[11]][32]  5,670  6,560  7091  7,050  7,630   9,670   100</span></a>
<a class="sourceLine" id="cb948-14" data-line-number="14"><span class="co">#&gt;       .subset2    381    522   789    592    738  13,100   100</span></a></code></pre></div>
</div>
<div id="ifelse-pmin-and-pmax" class="section level3">
<h3><span class="header-section-number">22.4.2</span> <code>ifelse()</code>, <code>pmin()</code>, and <code>pmax()</code></h3>
<p>Some base functions are known to be slow. For example, take the following three implementations of <code>squish()</code>, a function that ensures that the smallest value in a vector is at least <code>a</code> and its largest value is at most <code>b</code>. The first implementation, <code>squish_ife()</code>, uses <code>ifelse()</code>. <code>ifelse()</code> is known to be slow because it is relatively general and must evaluate all arguments fully. The second implementation, <code>squish_p()</code>, uses <code>pmin()</code> and <code>pmax()</code>. Because these two functions are so specialised, one might expect that they would be fast. However, they’re actually rather slow. This is because they can take any number of arguments and they have to do some relatively complicated checks to determine which method to use. The final implementation uses basic subassignment.   </p>
<div class="sourceCode" id="cb949"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb949-1" data-line-number="1">squish_ife &lt;-<span class="st"> </span><span class="cf">function</span>(x, a, b) {</a>
<a class="sourceLine" id="cb949-2" data-line-number="2">  <span class="kw">ifelse</span>(x <span class="op">&lt;=</span><span class="st"> </span>a, a, <span class="kw">ifelse</span>(x <span class="op">&gt;=</span><span class="st"> </span>b, b, x))</a>
<a class="sourceLine" id="cb949-3" data-line-number="3">}</a>
<a class="sourceLine" id="cb949-4" data-line-number="4">squish_p &lt;-<span class="st"> </span><span class="cf">function</span>(x, a, b) {</a>
<a class="sourceLine" id="cb949-5" data-line-number="5">  <span class="kw">pmax</span>(<span class="kw">pmin</span>(x, b), a)</a>
<a class="sourceLine" id="cb949-6" data-line-number="6">}</a>
<a class="sourceLine" id="cb949-7" data-line-number="7">squish_in_place &lt;-<span class="st"> </span><span class="cf">function</span>(x, a, b) {</a>
<a class="sourceLine" id="cb949-8" data-line-number="8">  x[x <span class="op">&lt;=</span><span class="st"> </span>a] &lt;-<span class="st"> </span>a</a>
<a class="sourceLine" id="cb949-9" data-line-number="9">  x[x <span class="op">&gt;=</span><span class="st"> </span>b] &lt;-<span class="st"> </span>b</a>
<a class="sourceLine" id="cb949-10" data-line-number="10">  x</a>
<a class="sourceLine" id="cb949-11" data-line-number="11">}</a>
<a class="sourceLine" id="cb949-12" data-line-number="12"></a>
<a class="sourceLine" id="cb949-13" data-line-number="13">x &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">100</span>, <span class="fl">-1.5</span>, <span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb949-14" data-line-number="14"><span class="kw">microbenchmark</span>(</a>
<a class="sourceLine" id="cb949-15" data-line-number="15">  <span class="dt">squish_ife      =</span> <span class="kw">squish_ife</span>(x, <span class="dv">-1</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb949-16" data-line-number="16">  <span class="dt">squish_p        =</span> <span class="kw">squish_p</span>(x, <span class="dv">-1</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb949-17" data-line-number="17">  <span class="dt">squish_in_place =</span> <span class="kw">squish_in_place</span>(x, <span class="dv">-1</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb949-18" data-line-number="18">  <span class="dt">unit =</span> <span class="st">&quot;us&quot;</span></a>
<a class="sourceLine" id="cb949-19" data-line-number="19">)</a>
<a class="sourceLine" id="cb949-20" data-line-number="20"><span class="co">#&gt; Unit: microseconds</span></a>
<a class="sourceLine" id="cb949-21" data-line-number="21"><span class="co">#&gt;             expr   min   lq  mean median   uq   max neval</span></a>
<a class="sourceLine" id="cb949-22" data-line-number="22"><span class="co">#&gt;       squish_ife 59.60 64.0 120.4   67.3 77.9 5,010   100</span></a>
<a class="sourceLine" id="cb949-23" data-line-number="23"><span class="co">#&gt;         squish_p 33.30 37.7  82.2   40.6 42.4 3,280   100</span></a>
<a class="sourceLine" id="cb949-24" data-line-number="24"><span class="co">#&gt;  squish_in_place  8.03  9.7  66.6   10.3 11.3 5,590   100</span></a></code></pre></div>
<p>Using <code>pmin()</code> and <code>pmax()</code> is about 2x faster than <code>ifelse()</code>, and using subsetting directly is about 4x as fast again. We can often do even better by using C++. The following example compares the best R implementation to a relatively simple, if verbose, implementation in C++. Even if you’ve never used C++, you should still be able to follow the basic strategy: loop over every element in the vector and perform a different action depending on whether or not the value is less than <code>a</code> and/or greater than <code>b</code>.</p>
<div class="sourceCode" id="cb950"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb950-1" data-line-number="1"><span class="pp">#include </span><span class="im">&lt;Rcpp.h&gt;</span></a>
<a class="sourceLine" id="cb950-2" data-line-number="2"><span class="kw">using</span> <span class="kw">namespace</span> Rcpp;</a>
<a class="sourceLine" id="cb950-3" data-line-number="3"></a>
<a class="sourceLine" id="cb950-4" data-line-number="4"><span class="co">// [[Rcpp::export]]</span></a>
<a class="sourceLine" id="cb950-5" data-line-number="5">NumericVector squish_cpp(NumericVector x, <span class="dt">double</span> a, <span class="dt">double</span> b) {</a>
<a class="sourceLine" id="cb950-6" data-line-number="6">  <span class="dt">int</span> n = x.length();</a>
<a class="sourceLine" id="cb950-7" data-line-number="7">  NumericVector out(n);</a>
<a class="sourceLine" id="cb950-8" data-line-number="8"></a>
<a class="sourceLine" id="cb950-9" data-line-number="9">  <span class="cf">for</span> (<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; n; ++i) {</a>
<a class="sourceLine" id="cb950-10" data-line-number="10">    <span class="dt">double</span> xi = x[i];</a>
<a class="sourceLine" id="cb950-11" data-line-number="11">    <span class="cf">if</span> (xi &lt; a) {</a>
<a class="sourceLine" id="cb950-12" data-line-number="12">      out[i] = a;</a>
<a class="sourceLine" id="cb950-13" data-line-number="13">    } <span class="cf">else</span> <span class="cf">if</span> (xi &gt; b) {</a>
<a class="sourceLine" id="cb950-14" data-line-number="14">      out[i] = b;</a>
<a class="sourceLine" id="cb950-15" data-line-number="15">    } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb950-16" data-line-number="16">      out[i] = xi;</a>
<a class="sourceLine" id="cb950-17" data-line-number="17">    }</a>
<a class="sourceLine" id="cb950-18" data-line-number="18">  }</a>
<a class="sourceLine" id="cb950-19" data-line-number="19"></a>
<a class="sourceLine" id="cb950-20" data-line-number="20">  <span class="cf">return</span> out;</a>
<a class="sourceLine" id="cb950-21" data-line-number="21">}</a></code></pre></div>
<p>(You’ll learn how to access this C++ code from R in <a href="rcpp.html#rcpp">Rcpp</a>.)</p>
<div class="sourceCode" id="cb951"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb951-1" data-line-number="1"><span class="kw">microbenchmark</span>(</a>
<a class="sourceLine" id="cb951-2" data-line-number="2">  <span class="dt">squish_in_place =</span> <span class="kw">squish_in_place</span>(x, <span class="dv">-1</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb951-3" data-line-number="3">  <span class="dt">squish_cpp      =</span> <span class="kw">squish_cpp</span>(x, <span class="dv">-1</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb951-4" data-line-number="4">  <span class="dt">unit =</span> <span class="st">&quot;us&quot;</span></a>
<a class="sourceLine" id="cb951-5" data-line-number="5">)</a>
<a class="sourceLine" id="cb951-6" data-line-number="6"><span class="co">#&gt; Unit: microseconds</span></a>
<a class="sourceLine" id="cb951-7" data-line-number="7"><span class="co">#&gt;             expr  min   lq  mean median   uq   max neval</span></a>
<a class="sourceLine" id="cb951-8" data-line-number="8"><span class="co">#&gt;  squish_in_place 5.15 6.21  7.89   6.58 7.81    40   100</span></a>
<a class="sourceLine" id="cb951-9" data-line-number="9"><span class="co">#&gt;       squish_cpp 3.86 4.34 24.42   4.62 5.58 1,890   100</span></a></code></pre></div>
<p>The C++ implementation is around 1x faster than the best pure R implementation.</p>
</div>
<div id="exercises-68" class="section level3">
<h3><span class="header-section-number">22.4.3</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li><p>The performance characteristics of <code>squish_ife()</code>, <code>squish_p()</code>, and
<code>squish_in_place()</code> vary considerably with the size of <code>x</code>. Explore the
differences. Which sizes lead to the biggest and smallest differences?</p></li>
<li><p>Compare the performance costs of extracting an element from a list, a
column from a matrix, and a column from a data frame. Do the same for rows.</p></li>
</ol>
</div>
</div>
<div id="faster-r" class="section level2">
<h2><span class="header-section-number">22.5</span> Alternative R implementations</h2>
<p>There are some exciting new implementations of R. While they all try to stick as closely as possible to the existing language definition, they improve speed by using ideas from modern interpreter design. The four most mature open-source projects are:
</p>
<ul>
<li><p><a href="http://www.pqr-project.org/">pqR</a> (pretty quick R) by Radford Neal. Built
on top of R 2.15.0, it fixes many obvious performance issues, and provides
better memory management and some support for automatic multithreading.
</p></li>
<li><p><a href="http://www.renjin.org/">Renjin</a> by BeDataDriven. Renjin uses the
Java virtual machine, and has an extensive
<a href="http://packages.renjin.org/">test suite</a>. </p></li>
<li><p><a href="https://github.com/allr/fastr">FastR</a> by a team from Purdue. FastR
is similar to Renjin, but it makes more ambitious optimisations and
is somewhat less mature. </p></li>
<li><p><a href="https://github.com/jtalbot/riposte">Riposte</a> by Justin Talbot and
Zachary DeVito. Riposte is experimental and ambitious. For the parts of R it
implements, it is extremely fast. Riposte is described in more detail in
<a href="http://www.justintalbot.com/wp-content/uploads/2012/10/pact080talbot.pdf">Riposte: A Trace-Driven Compiler and Parallel VM for Vector Code in
R</a>.
</p></li>
</ul>
<p>These are roughly ordered from most practical to most ambitious. Another project, <a href="http://www.cs.kent.ac.uk/projects/cxxr/">CXXR</a> by Andrew Runnalls, does not provide any performance improvements. Instead, it aims to refactor R’s internal C code in order to build a stronger foundation for future development, to keep behaviour identical to GNU-R, and to create better, more extensible documentation of its internals. </p>
<p>R is a huge language and it’s not clear whether any of these approaches will ever become mainstream. It’s a hard task to make an alternative implementation run all R code in the same way as GNU-R. Can you imagine having to reimplement every function in base R to be not only faster, but also to have exactly the same documented bugs? However, even if these implementations never make a dent in the use of GNU-R, they still provide benefits:</p>
<ul>
<li><p>Simpler implementations make it easy to validate new approaches before
porting to GNU-R.</p></li>
<li><p>Knowing which aspects of the language can be changed with minimal
impact on existing code and maximal impact on performance can help to guide
us to where we should direct our attention.</p></li>
<li><p>Alternative implementations put pressure on the R-core to incorporate
performance improvements.</p></li>
</ul>
<p>One of the most important approaches that pqR, Renjin, FastR, and Riposte are exploring is the idea of deferred evaluation. As Justin Talbot, the author of Riposte, points out: “for long vectors, R’s execution is completely memory bound. It spends almost all of its time reading and writing vector intermediates to memory”. If we could eliminate these intermediate vectors, we could improve performance and reduce memory usage. </p>
<p>The following example shows a very simple example of how deferred evaluation can help. We have three vectors, <code>x</code>, <code>y</code>, <code>z</code>, each containing 1 million elements, and we want to find the sum of <code>x</code> + <code>y</code> where <code>z</code> is TRUE. (This represents a simplification of a pretty common sort of data analysis question.)</p>
<div class="sourceCode" id="cb952"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb952-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="fl">1e6</span>)</a>
<a class="sourceLine" id="cb952-2" data-line-number="2">y &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="fl">1e6</span>)</a>
<a class="sourceLine" id="cb952-3" data-line-number="3">z &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(T, F), <span class="fl">1e6</span>, <span class="dt">rep =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb952-4" data-line-number="4"></a>
<a class="sourceLine" id="cb952-5" data-line-number="5"><span class="kw">sum</span>((x <span class="op">+</span><span class="st"> </span>y)[z])</a></code></pre></div>
<p>In R, this creates two big temporary vectors: <code>x + y</code>, 1 million elements long, and <code>(x + y)[z]</code>, about 500,000 elements long. This means you need to have extra memory available for the intermediate calculation, and you have to shuttle the data back and forth between the CPU and memory. This slows computation down because the CPU can’t work at maximum efficiency if it’s always waiting for more data to come in.</p>
<p>However, if we rewrote the function using a loop in a language like C++, we only need one intermediate value: the sum of all the values we’ve seen:</p>
<div class="sourceCode" id="cb953"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb953-1" data-line-number="1"><span class="pp">#include </span><span class="im">&lt;Rcpp.h&gt;</span></a>
<a class="sourceLine" id="cb953-2" data-line-number="2"><span class="kw">using</span> <span class="kw">namespace</span> Rcpp;</a>
<a class="sourceLine" id="cb953-3" data-line-number="3"></a>
<a class="sourceLine" id="cb953-4" data-line-number="4"><span class="co">// [[Rcpp::export]]</span></a>
<a class="sourceLine" id="cb953-5" data-line-number="5"><span class="dt">double</span> cond_sum_cpp(NumericVector x, NumericVector y, </a>
<a class="sourceLine" id="cb953-6" data-line-number="6">                    LogicalVector z) {</a>
<a class="sourceLine" id="cb953-7" data-line-number="7">  <span class="dt">double</span> sum = <span class="dv">0</span>;</a>
<a class="sourceLine" id="cb953-8" data-line-number="8">  <span class="dt">int</span> n = x.length();</a>
<a class="sourceLine" id="cb953-9" data-line-number="9"></a>
<a class="sourceLine" id="cb953-10" data-line-number="10">  <span class="cf">for</span>(<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; n; i++) {</a>
<a class="sourceLine" id="cb953-11" data-line-number="11">    <span class="cf">if</span> (!z[i]) <span class="cf">continue</span>;</a>
<a class="sourceLine" id="cb953-12" data-line-number="12">    sum += x[i] + y[i];</a>
<a class="sourceLine" id="cb953-13" data-line-number="13">  }</a>
<a class="sourceLine" id="cb953-14" data-line-number="14"></a>
<a class="sourceLine" id="cb953-15" data-line-number="15">  <span class="cf">return</span> sum;</a>
<a class="sourceLine" id="cb953-16" data-line-number="16">}</a></code></pre></div>
<div class="sourceCode" id="cb954"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb954-1" data-line-number="1">cond_sum_r &lt;-<span class="st"> </span><span class="cf">function</span>(x, y, z) {</a>
<a class="sourceLine" id="cb954-2" data-line-number="2">  <span class="kw">sum</span>((x <span class="op">+</span><span class="st"> </span>y)[z])</a>
<a class="sourceLine" id="cb954-3" data-line-number="3">}</a>
<a class="sourceLine" id="cb954-4" data-line-number="4"></a>
<a class="sourceLine" id="cb954-5" data-line-number="5"><span class="kw">microbenchmark</span>(</a>
<a class="sourceLine" id="cb954-6" data-line-number="6">  <span class="dt">cond_sum_cpp =</span> <span class="kw">cond_sum_cpp</span>(x, y, z),</a>
<a class="sourceLine" id="cb954-7" data-line-number="7">  <span class="dt">cond_sum_r =</span> <span class="kw">cond_sum_r</span>(x, y, z),</a>
<a class="sourceLine" id="cb954-8" data-line-number="8">  <span class="dt">unit =</span> <span class="st">&quot;ms&quot;</span></a>
<a class="sourceLine" id="cb954-9" data-line-number="9">)</a>
<a class="sourceLine" id="cb954-10" data-line-number="10"><span class="co">#&gt; Unit: milliseconds</span></a>
<a class="sourceLine" id="cb954-11" data-line-number="11"><span class="co">#&gt;          expr   min    lq  mean median    uq    max neval</span></a>
<a class="sourceLine" id="cb954-12" data-line-number="12"><span class="co">#&gt;  cond_sum_cpp  4.63  4.68  5.02   4.72  5.17   8.44   100</span></a>
<a class="sourceLine" id="cb954-13" data-line-number="13"><span class="co">#&gt;    cond_sum_r 11.90 12.90 15.30  13.40 13.80 177.00   100</span></a></code></pre></div>
<p>On my computer, this approach is about 3x faster than the vectorised R equivalent, which is already pretty fast.</p>
<p>The goal of deferred evaluation is to perform this transformation automatically, so you can write concise R code and have it automatically translated into efficient machine code. Sophisticated translators can also figure out how to make the most of multiple cores. In the above example, if you have four cores, you could split <code>x</code>, <code>y</code>, and <code>z</code> into four pieces performing the conditional sum on each core, then adding together the four individual results. Deferred evaluation can also work with for loops, automatically discovering operations that can be vectorised.</p>
<p>This chapter has discussed some of the fundamental reasons that R is slow. The following chapters will give you the tools to do something about it when it impacts your code.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="debugging.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="profiling.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/hadley/adv-r/edit/master/Performance.Rmd",
"text": "Edit"
},
"download": ["adv-r.pdf", "adv-r.epub"],
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
